<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="FundInfo">
    <!-- 基金基本信息 -->
	<resultMap id="FundInfoResult2" type="com.ppmg.ei.model.FundInfoModel" extends="FundInfoResult">
		<result column="PLAN_AMOUNT_DISPLAY" property="planAmountDisplay" jdbcType="VARCHAR" />
		<result column="CURRENT_AMOUNT_DISPLAY" property="currentAmountDisplay" jdbcType="VARCHAR" />
		<result column="RAISE_AMOUNT_DISPLAY" property="raiseAmountDisplay" jdbcType="VARCHAR" />
		<result column="RAISE_CURRENT" property="raiseCurrent" jdbcType="VARCHAR" />
		<result column="PROJ_NUM" property="projNum" jdbcType="VARCHAR" />
		<result column="INVEST_AMOUNT" property="investAmount" jdbcType="VARCHAR" />
		<result column="RECORD_CODE" property="recordCode" jdbcType="VARCHAR" />
		<result column="RECORD_DATE" property="recordDate" jdbcType="TIMESTAMP" />
		<result column="ADDRESS_DETAILS" property="addressDetails" jdbcType="TIMESTAMP" />
		<result column="ACTUAL_AMOUNT" property="actualAmount" jdbcType="VARCHAR" />
        <result column="bjjPer" property="bjjPer" jdbcType="VARCHAR" />
		<result column="PROJ_ID" property="projctId" jdbcType="VARCHAR" />
		<result column="PER_RAISE_CURRENT" property="perRaiseCurrent" jdbcType="VARCHAR" />
		<result column="START_DATE" property="startDate" jdbcType="VARCHAR" />
        <result column="CREDIT_CODE" property="creditCode" jdbcType="VARCHAR" />
        <association property="projInfo" javaType="com.ppmg.ei.model.ProjInfoModel">
            <result column="PROJ_ID" property="projId" jdbcType="VARCHAR" />
            <result column="INVE_NAME" property="inveName" jdbcType="VARCHAR" />
            <result column="PROJ_SRC" property="projSrc" jdbcType="VARCHAR" />
			<result column="PROJ_STATUS" property="projStatus" jdbcType="VARCHAR" />
			<result column="PROJ_NO" property="projNo" jdbcType="VARCHAR" />
			<result column="PROJ_NAME" property="projName" jdbcType="VARCHAR" />
			<result column="updateDtStr" property="updateDt" jdbcType="VARCHAR" />
        </association>
        <association property="fundInveDescModel" resultMap="FundInveDesc.FundInveDescResult" column="FUND_ID"></association>
        <collection property="fundMemberList" resultMap="FundMember.FundMemberResult" column="FUND_ID"></collection>
	</resultMap>


	<!--  -->
   <resultMap id="FundInfoResult11" type="com.ppmg.ei.model.FundInfoModel" extends="FundInfoResult">
		<association property="fundShareInfoModel" javaType="com.ppmg.ei.model.FundShareInfoModel" column="FUND_ID">
			<result column="INVE_AMOUNT" property="inveAmount" jdbcType="VARCHAR" />
			<result column="AMOUNT" property="raiseAmount" jdbcType="VARCHAR" />
		</association>
	<association property="fundMcInfoModel" javaType="com.ppmg.ei.model.FundMcInfoModel" column="ENT_ID">
		<result column="MC_NAME" property="mcName" jdbcType="VARCHAR" />
		<result column="REGISTER_NO" property="registerNo" jdbcType="VARCHAR" />
	</association>
	<association property="fundInveDescModel" javaType="com.ppmg.ei.model.FundInveDescModel" column="ENT_ID">
		<result column="DURATION_PERIOD" property="durationPeriod" jdbcType="VARCHAR" />
		<result column="INVE_PERIOD" property="invePeriod" jdbcType="VARCHAR" />
		<result column="INVE_START_DATE" property="inveStartDate" jdbcType="TIMESTAMP" />
		<result column="INVE_END_DATE" property="inveEndDate" jdbcType="TIMESTAMP" />
	</association>
	</resultMap>
	<!-- 基金投资信息 -->
	<resultMap id="FundInfoResult3" type="com.ppmg.ei.model.FundInfoModel" extends="FundInfoResult">
		<result column="TOTAL_INVEST_COUNT" property="totalInvestCount" jdbcType="VARCHAR" />
		<result column="TOTAL_INVEST_AMOUNT" property="totalInvestAmount" jdbcType="VARCHAR" />
		<result column="THISYEAR_INVEST_COUNT" property="thisYearInvestCount" jdbcType="VARCHAR" />
		<result column="THISYEAR_INVEST_AMOUNT" property="thisYearInvestAmount" jdbcType="VARCHAR" />
		<result column="INVESTING_COUNT" property="investingCount" jdbcType="VARCHAR" />
	</resultMap>


	<resultMap id="FundInfoResult15" type="com.ppmg.ei.model.FundInfoModel" extends="FundInfoResult">
	<association property="fundShareItemModel" javaType="com.ppmg.ei.model.FundShareItemModel" column="FUND_ID">
	</association>
		<association property="fundMcInfoModel" javaType="com.ppmg.ei.model.FundMcInfoModel" column="MC_ID">
			<result column="REGISTER_DT" property="registerDt" jdbcType="VARCHAR" />
		</association>
		<association property="fundInveDescModel" javaType="com.ppmg.ei.model.FundInveDescModel" column="MC_ID">
			<result column="INVE_START_DATE" property="inveStartDate" jdbcType="TIMESTAMP" />
			<result column="INVE_END_DATE" property="inveEndDate" jdbcType="TIMESTAMP" />
		</association>
<!--		<association property="fundShareInfoModel" javaType="com.ppmg.ei.model.FundShareInfoModel" column="MC_ID">
			<result column="INVE_AMOUNT" property="inveAmount" jdbcType="NUMERIC" />
			<result column="INVE_END_DATE" property="inveEndDate" jdbcType="TIMESTAMP" />
		</association>-->

	</resultMap>
	<!-- start autocreate -->

	<resultMap id="FundInfoResult" type="com.ppmg.ei.model.FundInfoModel">
		<result column="FUND_ID" property="fundId" jdbcType="VARCHAR" />
		<result column="FUND_CODE" property="fundCode" jdbcType="VARCHAR" />
		<result column="FUND_NAME" property="fundName" jdbcType="VARCHAR" />
		<result column="REG_NAME" property="regName" jdbcType="VARCHAR" />
		<result column="MC_ID" property="mcId" jdbcType="VARCHAR" />
		<result column="MC_NAME" property="mcName" jdbcType="VARCHAR" />
		<result column="GP" property="gp" jdbcType="VARCHAR" />
		<result column="CONTACT" property="contact" jdbcType="VARCHAR" />
		<result column="PHONE_NO" property="phoneNo" jdbcType="VARCHAR" />
		<result column="CONTACT_EMAIL" property="contactEmail" jdbcType="VARCHAR" />
		<result column="PLAN_AMOUNT" property="planAmount" jdbcType="NUMERIC" />
		<result column="PLAN_CURR" property="planCurr" jdbcType="VARCHAR" />
		<result column="RAISE_AMOUNT" property="raiseAmount" jdbcType="NUMERIC" />
		<result column="RAISE_CURRENCY" property="raiseCurrency" jdbcType="VARCHAR" />
		<result column="FUND_STRUCT" property="fundStruct" jdbcType="VARCHAR" />
		<result column="PLAT_PROP" property="platProp" jdbcType="VARCHAR" />
		<result column="SUB_PLAT_PROP" property="subPlatProp" jdbcType="VARCHAR" />
		<result column="SETUP_DT" property="setupDt" jdbcType="TIMESTAMP" />
		<result column="CLOSE_DT" property="closeDt" jdbcType="TIMESTAMP" />
		<result column="REG_ADD" property="regAdd" jdbcType="VARCHAR" />
		<result column="ORGN_CODE" property="orgnCode" jdbcType="VARCHAR" />
		<result column="LEGAL_PERSON" property="legalPerson" jdbcType="VARCHAR" />
		<result column="CUSTODIAN_BANK" property="custodianBank" jdbcType="VARCHAR" />
		<result column="REG_CAPITAL" property="regCapital" jdbcType="NUMERIC" />
		<result column="REG_CURRENCY" property="regCurrency" jdbcType="VARCHAR" />
		<result column="CAPITAL_ACCOUNT" property="capitalAccount" jdbcType="VARCHAR" />
		<result column="RETURN_ACCOUNT" property="returnAccount" jdbcType="VARCHAR" />
		<result column="FUND_STS" property="fundSts" jdbcType="VARCHAR" />
		<result column="DESC_FILE" property="descFile" jdbcType="VARCHAR" />
		<result column="FUND_SRC" property="fundSrc" jdbcType="VARCHAR" />
		<result column="CREATE_BY" property="createBy" jdbcType="VARCHAR" />
		<result column="CREATE_DT" property="createDt" jdbcType="TIMESTAMP" />
		<result column="UPDATE_BY" property="updateBy" jdbcType="VARCHAR" />
		<result column="UPDATE_DT" property="updateDt" jdbcType="TIMESTAMP" />
		<result column="FUND_GENRE" property="fundGenre" jdbcType="VARCHAR" />
		<result column="CUSTODIAN_BANKACCOUNT" property="custodianBankaccount" jdbcType="VARCHAR" />
		<result column="CAPITAL_BANK" property="capitalBank" jdbcType="VARCHAR" />
		<result column="RETURN_BANK" property="returnBank" jdbcType="VARCHAR" />
		<result column="PARTNERS" property="partners" jdbcType="VARCHAR" />
		<result column="GROUP_ID" property="groupId" jdbcType="NUMERIC" />
		<result column="GP_ID" property="gpId" jdbcType="VARCHAR" />
		<result column="RMB_RAISE_AMOUNT" property="rmbRaiseAmount" jdbcType="NUMERIC" />
		<result column="CURRENT_AMOUNT" property="currentAmount" jdbcType="NUMERIC" />
		<result column="CURRENT_CURRENCY" property="currentCurrency" jdbcType="VARCHAR" />
		<result column="RMB_CURRENT_AMOUNT" property="rmbCurrentAmount" jdbcType="NUMERIC" />
		<result column="MAINTENANCE_ID" property="maintenanceId" jdbcType="VARCHAR" />
		<result column="MAINTENANCE" property="maintenance" jdbcType="VARCHAR" />
		<result column="SOCIAL_CODE" property="socialCode" jdbcType="VARCHAR" />
		<result column="KEY_PERSON_LOCK" property="keyPersonLock" jdbcType="VARCHAR" />
		<result column="RATIO_IN_GP" property="ratioInGp" jdbcType="NUMERIC" />
		<result column="RMB_PLAN_AMOUNT" property="rmbPlanAmount" jdbcType="NUMERIC" />
		<result column="FUND_SCOPE" property="fundScope" jdbcType="VARCHAR" />
		<result column="YH_RATIO_AS_LP" property="yhRatioAsLp" jdbcType="NUMERIC" />
		<result column="YH_RATIO_IN_GP" property="yhRatioInGp" jdbcType="NUMERIC" />
		<result column="YH_RATIO_IN_MC" property="yhRatioInMc" jdbcType="NUMERIC" />
		<result column="EMAIL" property="email" jdbcType="VARCHAR" />
		<result column="ENTE_ID" property="enteId" jdbcType="VARCHAR" />
        <result column="PERCENT" property="perCent" jdbcType="VARCHAR" />
		<result column="EMAIL_PASSWORD" property="emailPassword" jdbcType="VARCHAR" />
		<result column="FINANCE_ID" property="financeId" jdbcType="VARCHAR" />
		<result column="FINANCE_NAME" property="financeName" jdbcType="VARCHAR" />
		<result column="EXECUTIVE_PARTNER_ID" property="executivePartnerId" jdbcType="VARCHAR" />
		<result column="EXECUTIVE_PARTNER_NAME" property="executivePartnerName" jdbcType="VARCHAR" />
		<result column="IS_FIT" property="isFit" jdbcType="VARCHAR" />
		<result column="CUSTODIAN_OPEN_BANK" property="custodianOpenBank" jdbcType="VARCHAR" />
		<result column="CUSTODIAN_BANK_NUM" property="custodianBankNum" jdbcType="VARCHAR" />
		<result column="IS_RECORD" property="isRecord" jdbcType="VARCHAR" />
		<result column="RECORD_CODE" property="recordCode" jdbcType="VARCHAR" />
		<result column="RECORD_DATE" property="recordDate" jdbcType="TIMESTAMP" />
		<result column="RECORD_ATTA" property="recordAtta" jdbcType="VARCHAR" />
		<result column="IS_CUSTODIAN" property="isCustodian" jdbcType="VARCHAR" />
		<result column="CUSTODIAN_ATTA" property="custodianAtta" jdbcType="VARCHAR" />
		<result column="IS_AUTH" property="isAuth" jdbcType="VARCHAR" />
		<result column="AUTH_ATTA" property="authAtta" jdbcType="VARCHAR" />
		<result column="PROMISE_AMOUNT" property="promiseAmount" jdbcType="NUMERIC" />
		<result column="PROFIT_AMOUNT" property="profitAmount" jdbcType="NUMERIC" />
		<result column="STATUS" property="status" jdbcType="VARCHAR" />
		<result column="INVE_CURRENT_AMOUNT" property="inveCurrentAmount" jdbcType="NUMERIC" />
		<result column="SPV_TYPE" property="spvType" jdbcType="VARCHAR" />
		<result column="REGISTER_CODE" property="registerCode" jdbcType="VARCHAR" />
		<result column="RECORD_CODE" property="recordCode" jdbcType="VARCHAR" />
		<result column="RECORD_DATE" property="recordDate" jdbcType="TIMESTAMP" />
		<result column="ADDRESS_DETAILS" property="addressDetails" jdbcType="VARCHAR" />
		<result column="IS_EXCEPT" property="isExcept" jdbcType="VARCHAR" />
		<result column="INVE_RAISE_AMOUNT" property="inveRaiseAmount" jdbcType="NUMERIC" />
		<result column="IS_LEAD" property="isLead" jdbcType="VARCHAR" />
		<result column="IS_EXIT" property="isExit" jdbcType="VARCHAR" />
		<result column="FINANCE_AMOUNT" property="financeAmount" jdbcType="NUMERIC" />
		<result column="INVE_TYPE" property="inveType" jdbcType="VARCHAR" />
		<result column="APP_DEP" property="appDep" jdbcType="VARCHAR" />
		<result column="GOV_FUND_SRC" property="govFundSrc" jdbcType="VARCHAR" />
		<result column="BASIS" property="basis" jdbcType="VARCHAR" />
		<result column="INVE_LIMIT" property="inveLimit" jdbcType="VARCHAR" />
		<result column="MAN_DEP" property="manDep" jdbcType="VARCHAR" />
		<result column="SHORT_NAME" property="shortName" jdbcType="VARCHAR" />
		<result column="FUNDS_TYPE" property="fundsType" jdbcType="VARCHAR" />
		<result column="PARENT_ID" property="parentId" jdbcType="VARCHAR" />
		<result column="FUNDCATEGORY" property="fundCategory" jdbcType="VARCHAR" />
		<result column="OLD_SUB_PLAT_PROP" property="oldSubPlatProp" jdbcType="VARCHAR" />
		<result column="ISDIRECT" property="isDirect" jdbcType="VARCHAR" />
		<result column="IS_DESIGNATE" property="isDesignate" jdbcType="VARCHAR" />
		<result column="FUND_CODE_SIGN" property="fundCodeSign" jdbcType="VARCHAR" />
		<result column="CREDIT_CODE" property="creditCode" jdbcType="VARCHAR" />
		<result column="REGISTER_STATUS" property="registerStatus" jdbcType="VARCHAR" />
		<result column="OLD_FUND_GENRE" property="oldFundGenre" jdbcType="VARCHAR" />
		<result column="FUND_CODE_TYPE" property="fundCodeType" jdbcType="VARCHAR" />
		<result column="FUND_LEAD" property="fundLead" jdbcType="VARCHAR" />
		<result column="FUND_LEAD_ID" property="fundLeadId" jdbcType="VARCHAR" />
		<result column="MOTHER_FUND_NAME" property="motherFundName" jdbcType="VARCHAR" />
		<result column="MOTHER_FUND_ID" property="motherFundId" jdbcType="VARCHAR" />
		<result column="REP_ID" property="repId" jdbcType="VARCHAR" />
		<result column="REP_NAME" property="repName" jdbcType="VARCHAR" />
		<result column="ORGAN_STRUCT" property="organStruct" jdbcType="VARCHAR" />
		<result column="OTHER_FILE" property="otherFile" jdbcType="VARCHAR" />
		<result column="START_DATE" property="startDate" jdbcType="TIMESTAMP" />
		<result column="mc_user_id" property="mcUserId" jdbcType="VARCHAR" />

		<association property="bdTFundCostInfoModel" javaType="com.ppmg.ei.model.BdTFundCostInfoModel" column="fund_id">
			<result column="YEAR" property="year" jdbcType="VARCHAR" />
			<result column="QUARTER" property="quarter" jdbcType="VARCHAR" />
			<result column="TOTAL_ASSETS" property="totalAssets" jdbcType="NUMERIC" />
			<result column="TOTAL_MANAGE" property="totalManage" jdbcType="NUMERIC" />
			<result column="TOTAL_DEPOSIT" property="totalDeposit" jdbcType="NUMERIC" />
			<result column="TOTAL_CONSULT" property="totalConsult" jdbcType="NUMERIC" />
			<result column="TOTAL_AUDIT" property="totalAudit" jdbcType="NUMERIC" />
			<result column="TOTAL_LAWYER" property="totalLawyer" jdbcType="NUMERIC" />
			<result column="TOTAL_OTHER" property="totalOther" jdbcType="NUMERIC" />
		</association>
	</resultMap>
	<resultMap id="FundInfoResult1" type="com.ppmg.ei.model.FundInfoModel" extends="FundInfoResult">
		<association property="projAppInfo" javaType="com.ppmg.ei.model.ProjAppInfoModel" column="PROJ_ID">
			<result column="inveCamount" property="inveCurrentAmount" jdbcType="NUMERIC" />
			<result column="inveRamount" property="inveRaiseAmount" jdbcType="NUMERIC" />
			<result column="IS_DECISION_PASS" property="isDecisionPass" jdbcType="VARCHAR" />
			<result column="DECISION_DATE" property="decisionDate" jdbcType="TIMESTAMP" />
		</association>
		<association property="projInfo" javaType="com.ppmg.ei.model.ProjInfoModel" >
			<result column="proj_id" property="projId" jdbcType="VARCHAR" />
			<result column="PROJ_STATUS" property="projStatus" jdbcType="VARCHAR" />
			<result column="inve_name" property="inveName" jdbcType="VARCHAR" />
			<result column="amount" property="amount" jdbcType="NUMERIC" />
			<result column="IS_JS" property="isJs" jdbcType="VARCHAR" />
			<result column="inve_id" property="inveId" jdbcType="VARCHAR" />
			<result column="IS_CORR" property="isCorr" jdbcType="VARCHAR" />
			<result column="isSpv" property="isSpv" jdbcType="VARCHAR" />
			<result column="spvT" property="spvType" jdbcType="VARCHAR" />
			<result column="CREDIT_CODE" property="creditCode" jdbcType="VARCHAR" />
		</association>
	</resultMap>

	<resultMap id="FundFofInfoResult1" type="com.ppmg.ei.model.FundFofInfoModel" >
		<result column="FUND_ID" property="fundId" jdbcType="VARCHAR" />
		<result column="FUND_CODE" property="fundCode" jdbcType="VARCHAR" />
		<result column="FUND_NAME" property="fundName" jdbcType="VARCHAR" />
		<result column="REG_NAME" property="regName" jdbcType="VARCHAR" />
		<result column="MC_ID" property="mcId" jdbcType="VARCHAR" />
		<result column="MC_NAME" property="mcName" jdbcType="VARCHAR" />
		<result column="RAISE_AMOUNT" property="raiseAmount" jdbcType="NUMERIC" />
		<result column="INVE_PERIOD" property="invePeriod" jdbcType="VARCHAR" />
		<result column="FUND_STS" property="fundSts" jdbcType="VARCHAR" />
		<result column="SETUP_DT" property="setupDt" jdbcType="TIMESTAMP" />
		<result column="START_DATE" property="startDate" jdbcType="TIMESTAMP" />
		<result column="projGs" property="projGs" jdbcType="VARCHAR" />
		<result column="fundGs" property="fundGs" jdbcType="VARCHAR" />
		<result column="FUND_STRUCT" property="fundStruct" jdbcType="VARCHAR" />
		<result column="CURRENT_AMOUNT" property="currentAmount" jdbcType="NUMERIC" />
		<result column="FUND_STRUCT" property="fundStruct" jdbcType="VARCHAR" />
		<result column="REP_NAME" property="repName" jdbcType="VARCHAR" />
		<result column="PERCENT" property="percent" jdbcType="VARCHAR" />
		<result column="IS_RECORD" property="isRecord" jdbcType="VARCHAR" />
		<result column="OLD_SUB_PLAT_PROP" property="oldSubPlatProp" jdbcType="VARCHAR" />
		<result column="UPDATE_DT" property="updateDt" jdbcType="TIMESTAMP" />
		<result column="upDt" property="upDt" jdbcType="TIMESTAMP" />
		<result column="IS_LEAD" property="isLead" jdbcType="VARCHAR" />
		<association property="projInfo" javaType="com.ppmg.ei.model.ProjInfoModel">
			<result column="PROJ_ID" property="projId" jdbcType="VARCHAR" />
			<result column="INVE_NAME" property="inveName" jdbcType="VARCHAR" />
			<result column="INVE_ID" property="inveId" jdbcType="VARCHAR" />
			<result column="PROJ_STATUS" property="projStatus" jdbcType="VARCHAR" />
			<result column="PROJ_NO" property="projNo" jdbcType="VARCHAR" />
			<result column="PROJ_NAME" property="projName" jdbcType="VARCHAR" />
		</association>

	</resultMap>
    <resultMap id="FundInfoResultStr" type="com.ppmg.ei.model.FundInfoResult">
        <result column="FUND_ID" property="fundId" jdbcType="VARCHAR" />
        <result column="FUND_CODE" property="fundCode" jdbcType="VARCHAR" />
        <result column="FUND_NAME" property="fundName" jdbcType="VARCHAR" />
        <result column="REG_NAME" property="regName" jdbcType="VARCHAR" />
        <result column="MC_ID" property="mcId" jdbcType="VARCHAR" />
        <result column="MC_NAME" property="mcName" jdbcType="VARCHAR" />
        <result column="GP" property="gp" jdbcType="VARCHAR" />
        <result column="CONTACT" property="contact" jdbcType="VARCHAR" />
        <result column="PHONE_NO" property="phoneNo" jdbcType="VARCHAR" />
        <result column="CONTACT_EMAIL" property="contactEmail" jdbcType="VARCHAR" />
        <result column="PLAN_AMOUNT" property="planAmount" jdbcType="NUMERIC" />
        <result column="PLAN_CURR" property="planCurr" jdbcType="VARCHAR" />
        <result column="RAISE_AMOUNT" property="raiseAmount" jdbcType="NUMERIC" />
        <result column="RAISE_CURRENCY" property="raiseCurrency" jdbcType="VARCHAR" />
        <result column="FUND_STRUCT" property="fundStruct" jdbcType="VARCHAR" />
        <result column="PLAT_PROP" property="platProp" jdbcType="VARCHAR" />
        <result column="SUB_PLAT_PROP" property="subPlatProp" jdbcType="VARCHAR" />
        <result column="SETUP_DT" property="setupDt" jdbcType="TIMESTAMP" />
        <result column="CLOSE_DT" property="closeDt" jdbcType="TIMESTAMP" />
        <result column="REG_ADD" property="regAdd" jdbcType="VARCHAR" />
        <result column="ORGN_CODE" property="orgnCode" jdbcType="VARCHAR" />
        <result column="LEGAL_PERSON" property="legalPerson" jdbcType="VARCHAR" />
        <result column="CUSTODIAN_BANK" property="custodianBank" jdbcType="VARCHAR" />
        <result column="REG_CAPITAL" property="regCapital" jdbcType="NUMERIC" />
        <result column="REG_CURRENCY" property="regCurrency" jdbcType="VARCHAR" />
        <result column="CAPITAL_ACCOUNT" property="capitalAccount" jdbcType="VARCHAR" />
        <result column="RETURN_ACCOUNT" property="returnAccount" jdbcType="VARCHAR" />
        <result column="FUND_STS" property="fundSts" jdbcType="VARCHAR" />
        <result column="DESC_FILE" property="descFile" jdbcType="VARCHAR" />
        <result column="FUND_SRC" property="fundSrc" jdbcType="VARCHAR" />
        <result column="CREATE_BY" property="createBy" jdbcType="VARCHAR" />
        <result column="CREATE_DT" property="createDt" jdbcType="TIMESTAMP" />
        <result column="UPDATE_BY" property="updateBy" jdbcType="VARCHAR" />
        <result column="UPDATE_DT" property="updateDt" jdbcType="TIMESTAMP" />
        <result column="FUND_GENRE" property="fundGenre" jdbcType="VARCHAR" />
        <result column="CUSTODIAN_BANKACCOUNT" property="custodianBankaccount" jdbcType="VARCHAR" />
        <result column="CAPITAL_BANK" property="capitalBank" jdbcType="VARCHAR" />
        <result column="RETURN_BANK" property="returnBank" jdbcType="VARCHAR" />
        <result column="PARTNERS" property="partners" jdbcType="VARCHAR" />
        <result column="GROUP_ID" property="groupId" jdbcType="NUMERIC" />
        <result column="GP_ID" property="gpId" jdbcType="VARCHAR" />
        <result column="RMB_RAISE_AMOUNT" property="rmbRaiseAmount" jdbcType="NUMERIC" />
        <result column="CURRENT_AMOUNT" property="currentAmount" jdbcType="NUMERIC" />
        <result column="CURRENT_CURRENCY" property="currentCurrency" jdbcType="VARCHAR" />
        <result column="RMB_CURRENT_AMOUNT" property="rmbCurrentAmount" jdbcType="NUMERIC" />
        <result column="MAINTENANCE_ID" property="maintenanceId" jdbcType="VARCHAR" />
        <result column="MAINTENANCE" property="maintenance" jdbcType="VARCHAR" />
        <result column="SOCIAL_CODE" property="socialCode" jdbcType="VARCHAR" />
        <result column="KEY_PERSON_LOCK" property="keyPersonLock" jdbcType="VARCHAR" />
        <result column="RATIO_IN_GP" property="ratioInGp" jdbcType="NUMERIC" />
        <result column="RMB_PLAN_AMOUNT" property="rmbPlanAmount" jdbcType="NUMERIC" />
        <result column="FUND_SCOPE" property="fundScope" jdbcType="VARCHAR" />
        <result column="YH_RATIO_AS_LP" property="yhRatioAsLp" jdbcType="NUMERIC" />
        <result column="YH_RATIO_IN_GP" property="yhRatioInGp" jdbcType="NUMERIC" />
        <result column="YH_RATIO_IN_MC" property="yhRatioInMc" jdbcType="NUMERIC" />
        <result column="EMAIL" property="email" jdbcType="VARCHAR" />
        <result column="ENTE_ID" property="enteId" jdbcType="VARCHAR" />
        <result column="PERCENT" property="perCent" jdbcType="VARCHAR" />
        <result column="EMAIL_PASSWORD" property="emailPassword" jdbcType="VARCHAR" />
        <result column="FINANCE_ID" property="financeId" jdbcType="VARCHAR" />
        <result column="FINANCE_NAME" property="financeName" jdbcType="VARCHAR" />
        <result column="EXECUTIVE_PARTNER_ID" property="executivePartnerId" jdbcType="VARCHAR" />
        <result column="EXECUTIVE_PARTNER_NAME" property="executivePartnerName" jdbcType="VARCHAR" />
        <result column="IS_FIT" property="isFit" jdbcType="VARCHAR" />
        <result column="CUSTODIAN_OPEN_BANK" property="custodianOpenBank" jdbcType="VARCHAR" />
        <result column="CUSTODIAN_BANK_NUM" property="custodianBankNum" jdbcType="VARCHAR" />
        <result column="IS_RECORD" property="isRecord" jdbcType="VARCHAR" />
        <result column="RECORD_CODE" property="recordCode" jdbcType="VARCHAR" />
        <result column="RECORD_DATE" property="recordDate" jdbcType="TIMESTAMP" />
        <result column="RECORD_ATTA" property="recordAtta" jdbcType="VARCHAR" />
        <result column="IS_CUSTODIAN" property="isCustodian" jdbcType="VARCHAR" />
        <result column="CUSTODIAN_ATTA" property="custodianAtta" jdbcType="VARCHAR" />
        <result column="IS_AUTH" property="isAuth" jdbcType="VARCHAR" />
        <result column="AUTH_ATTA" property="authAtta" jdbcType="VARCHAR" />
        <result column="PROMISE_AMOUNT" property="promiseAmount" jdbcType="NUMERIC" />
        <result column="PROFIT_AMOUNT" property="profitAmount" jdbcType="NUMERIC" />
        <result column="STATUS" property="status" jdbcType="VARCHAR" />
        <result column="INVE_CURRENT_AMOUNT" property="inveCurrentAmount" jdbcType="NUMERIC" />
        <result column="SPV_TYPE" property="spvType" jdbcType="VARCHAR" />
        <result column="REGISTER_CODE" property="registerCode" jdbcType="VARCHAR" />
        <result column="RECORD_CODE" property="recordCode" jdbcType="VARCHAR" />
        <result column="RECORD_DATE" property="recordDate" jdbcType="TIMESTAMP" />
        <result column="ADDRESS_DETAILS" property="addressDetails" jdbcType="VARCHAR" />
        <result column="IS_EXCEPT" property="isExcept" jdbcType="VARCHAR" />
        <result column="INVE_RAISE_AMOUNT" property="inveRaiseAmount" jdbcType="NUMERIC" />
        <result column="IS_LEAD" property="isLead" jdbcType="VARCHAR" />
        <result column="IS_EXIT" property="isExit" jdbcType="VARCHAR" />
        <result column="FINANCE_AMOUNT" property="financeAmount" jdbcType="NUMERIC" />
        <result column="INVE_TYPE" property="inveType" jdbcType="VARCHAR" />
        <result column="APP_DEP" property="appDep" jdbcType="VARCHAR" />
        <result column="GOV_FUND_SRC" property="govFundSrc" jdbcType="VARCHAR" />
        <result column="BASIS" property="basis" jdbcType="VARCHAR" />
        <result column="INVE_LIMIT" property="inveLimit" jdbcType="VARCHAR" />
        <result column="MAN_DEP" property="manDep" jdbcType="VARCHAR" />
        <result column="SHORT_NAME" property="shortName" jdbcType="VARCHAR" />
        <result column="FUNDS_TYPE" property="fundsType" jdbcType="VARCHAR" />
        <result column="PARENT_ID" property="parentId" jdbcType="VARCHAR" />
        <result column="FUNDCATEGORY" property="fundCategory" jdbcType="VARCHAR" />
        <result column="OLD_SUB_PLAT_PROP" property="oldSubPlatProp" jdbcType="VARCHAR" />
        <result column="ISDIRECT" property="isDirect" jdbcType="VARCHAR" />
        <result column="IS_DESIGNATE" property="isDesignate" jdbcType="VARCHAR" />
        <result column="FUND_CODE_SIGN" property="fundCodeSign" jdbcType="VARCHAR" />
        <result column="CREDIT_CODE" property="creditCode" jdbcType="VARCHAR" />
        <result column="REGISTER_STATUS" property="registerStatus" jdbcType="VARCHAR" />
        <result column="OLD_FUND_GENRE" property="oldFundGenre" jdbcType="VARCHAR" />
        <result column="FUND_CODE_TYPE" property="fundCodeType" jdbcType="VARCHAR" />
        <result column="PROJ_NAME" property="projName" jdbcType="VARCHAR" />
        <result column="PROJ_ID" property="projId" jdbcType="VARCHAR" />
        <result column="INVE_NAME" property="inveName" jdbcType="VARCHAR" />
		<result column="MOTHER_FUND_NAME" property="motherFundName" jdbcType="VARCHAR" />
		<result column="upDt" property="upDt" jdbcType="TIMESTAMP" />
		<result column="ORGAN_STRUCT" property="organStruct" jdbcType="VARCHAR" />
    </resultMap>


	<resultMap id="FundExportResult" type="com.ppmg.ei.model.FundInfoExportModel" >
		<result column="FUND_ID" property="fundId" jdbcType="VARCHAR" />
		<result column="REG_NAME" property="regName" jdbcType="VARCHAR" />
		<result column="MC_NAME" property="mcName" jdbcType="VARCHAR" />
		<result column="SETUP_DT" property="setupDt" jdbcType="TIMESTAMP" />
		<result column="START_DATE" property="startDate" jdbcType="TIMESTAMP" />
		<result column="COOPERATION_YEAR" property="cooperationYear" jdbcType="VARCHAR" />
		<result column="INVE_PERIOD" property="invePeriod" jdbcType="VARCHAR" />
		<result column="INVE_START_DATE" property="inveStartDate" jdbcType="TIMESTAMP" />
		<result column="INVE_END_DATE" property="inveEndDate" jdbcType="TIMESTAMP" />
		<result column="CURRENT_AMOUNT" property="currentAmount" jdbcType="NUMERIC" />
		<result column="RAISE_AMOUNT" property="raiseAmount" jdbcType="NUMERIC" />
		<result column="JC_CURRENT_AMOUNT" property="jcCurrentAmount" jdbcType="NUMERIC" />
		<result column="JC_CURRENT_AMOUNT_ONE" property="jcCurrentAmountOne" jdbcType="NUMERIC" />
		<result column="JC_RAISE_AMOUNT" property="jcRaiseAmount" jdbcType="NUMERIC" />
		<result column="JC_RAISE_AMOUNT_ONE" property="jcRaiseAmountOne" jdbcType="NUMERIC" />
		<result column="proj_gs" property="projGs" jdbcType="VARCHAR" />
		<result column="ente_gs" property="enteGs" jdbcType="VARCHAR" />
		<result column="fund_gs" property="fundGs" jdbcType="VARCHAR" />
		<result column="PROVINCE_GS" property="provinceGs" jdbcType="VARCHAR" />
		<result column="PROVINCE_AMOUNT" property="provinceAmount" jdbcType="NUMERIC" />
		<result column="SS_GS" property="ssGs" jdbcType="VARCHAR" />
		<result column="IPO_GS" property="ipoGs" jdbcType="VARCHAR" />
		<result column="NEW_BOARD_GS" property="newBoardGs" jdbcType="VARCHAR" />
		<result column="PROJ_AMOUNT" property="projAmount" jdbcType="VARCHAR" />
		<result column="inve_name" property="inveName" jdbcType="VARCHAR" />
		<result column="OLD_SUB_PLAT_PROP" property="oldSubPlatProp" jdbcType="VARCHAR" />
        <result column="proj_id" property="projId" jdbcType="VARCHAR" />
		<result column="proj_status" property="projStatus" jdbcType="VARCHAR" />
		<result column="proj_status_name" property="projStatusName" jdbcType="VARCHAR" />
		<association property="quitInveInfoModel" javaType="com.ppmg.ei.model.FundQuitInveInfoModel" column="PROJ_ID">
			<result column="FQI_ID" property="fqiId" jdbcType="VARCHAR" />
			<result column="FUND_ID" property="fundId" jdbcType="VARCHAR" />
			<result column="PROJ_ID" property="projId" jdbcType="VARCHAR" />
			<result column="INVE_PROJ_NUM" property="inveProjNum" jdbcType="NUMERIC" />
			<result column="INVE_ENT_NUM" property="inveEntNum" jdbcType="NUMERIC" />
			<result column="INVE_AMT" property="inveAmt" jdbcType="NUMERIC" />
			<result column="INVE_PROVINCE_NUM" property="inveProvinceNum" jdbcType="NUMERIC" />
			<result column="INVE_PROVINCE_AMT" property="inveProvinceAmt" jdbcType="NUMERIC" />
			<result column="INVE_LISTED_NUM" property="inveListedNum" jdbcType="NUMERIC" />
			<result column="INVE_IPO_NUM" property="inveIpoNum" jdbcType="NUMERIC" />
			<result column="INVE_NEW_THIRD_NUM" property="inveNewThirdNum" jdbcType="NUMERIC" />
			<result column="IS_DELETE" property="isDelete" jdbcType="CHAR" />
		</association>
	</resultMap>


	<resultMap id="projExportResult" type="com.ppmg.ei.model.ProjInfoExportModel" >
		<result column="INVE_ID" property="inveId" jdbcType="VARCHAR" />
		<result column="PROJ_NAME" property="projName" jdbcType="VARCHAR" />
		<result column="PROJ_ID" property="projId" jdbcType="VARCHAR" />
		<result column="proj_object" property="projObject" jdbcType="VARCHAR" />
		<result column="inve_name" property="inveName" jdbcType="VARCHAR" />
		<result column="enteName" property="enteName" jdbcType="VARCHAR" />
		<result column="SETUP_DT" property="setupDt" jdbcType="VARCHAR" />
		<result column="START_DATE" property="startDate" jdbcType="TIMESTAMP" />
		<result column="ADDRESS_DETAILS" property="addressDetails" jdbcType="VARCHAR" />
		<result column="REG_ADD" property="regAdd" jdbcType="VARCHAR" />
		<result column="REGIST_CAPI" property="registCapi" jdbcType="VARCHAR" />
		<result column="REGIST_CAPI" property="registCapi" jdbcType="VARCHAR" />
		<result column="REG_AMOUNT" property="regAmount" jdbcType="NUMERIC" />
		<result column="REG_AMOUNT_CURRENCY" property="regAmountCurrency" jdbcType="VARCHAR" />
		<result column="INTENDED_AMOUNT" property="intendedAmount" jdbcType="NUMERIC" />
		<result column="RMB_INTENDED_AMOUNT" property="rmbIntendedAmount" jdbcType="NUMERIC" />
		<result column="PER_SHARE" property="perShare" jdbcType="NUMERIC" />
		<result column="PERCENT" property="percent" jdbcType="VARCHAR" />
		<result column="INVE_ROUNDS" property="inveRounds" jdbcType="VARCHAR" />
		<result column="FINA_ROUNDS" property="finaRounds" jdbcType="VARCHAR" />
		<result column="FINA_TIMES" property="finaTimes" jdbcType="VARCHAR" />
		<result column="OCCUR_DT" property="occurDt" jdbcType="TIMESTAMP" />
		<result column="inve_type" property="inveType" jdbcType="VARCHAR" />
		<result column="INDUSTRY_NAME" property="industryName" jdbcType="VARCHAR" />
		<result column="PROVINCE_AMOUNT" property="provinceAmount" jdbcType="NUMERIC" />
		<result column="is_private" property="isPrivate" jdbcType="VARCHAR" />
		<result column="is_technology" property="isTechnology" jdbcType="VARCHAR" />
		<result column="is_strategy" property="isStrategy" jdbcType="VARCHAR" />
		<result column="IS_DIRECTOR_CNT" property="isDirectorCnt" jdbcType="VARCHAR" />
		<result column="IS_SUPERVISOR_CNT" property="isSupervisorCnt" jdbcType="VARCHAR" />
		<result column="POST_MONEY" property="postMoney" jdbcType="VARCHAR" />
		<result column="ENTE_POST_VALUE" property="entePostValue" jdbcType="VARCHAR" />
		<result column="INVE_NEW_VALUE" property="inveNewValue" jdbcType="VARCHAR" />
		<result column="HOLD_SHARE" property="holdShare" jdbcType="VARCHAR" />
		<result column="IS_PUBLIC_COMP" property="isPublicComp" jdbcType="NUMERIC" />
		<result column="IS_PROVINCE" property="isProvince" jdbcType="NUMERIC" />
		<result column="phase" property="phase" jdbcType="VARCHAR" />
		<result column="HLIGHTS_REMARK" property="hlightsRemark" jdbcType="VARCHAR" />
		<result column="QUIT_RMB_INVE_AMOUNT" property="quitRmbInveAmount" jdbcType="VARCHAR" />
		<result column="QUIT_SY" property="quitSy" jdbcType="VARCHAR" />
		<result column="QUIT_DT" property="quitDt" jdbcType="TIMESTAMP" />
		<result column="EXIT_TYPE" property="exitType" jdbcType="VARCHAR" />
		<result column="yearStr" property="yearStr" jdbcType="VARCHAR" />
		<collection property="listM" ofType="com.ppmg.ei.model.FundEnteModel">
			<result column="inveStr" property="inveStr" jdbcType="VARCHAR" />
			<result column="YEAR" property="year" jdbcType="VARCHAR" />
			<result column="STAFF_NUM" property="staffNum" jdbcType="NUMERIC" />
			<result column="RD_STAFF_NUM" property="rdStaffNum" jdbcType="NUMERIC" />
			<result column="TOTAL_ASSETS" property="totalAssets" jdbcType="NUMERIC" />
			<result column="TOTAL_LIABILITIES" property="totalLiabilities" jdbcType="NUMERIC" />
			<result column="OWNER_EQUITY" property="ownerEquity" jdbcType="NUMERIC" />
			<result column="TOTAL_INCOME" property="totalIncome" jdbcType="NUMERIC" />
			<result column="TOTAL_PROFIT" property="totalProfit" jdbcType="NUMERIC" />
			<result column="NET_PROFIT" property="netProfit" jdbcType="NUMERIC" />
			<result column="RD_FEE" property="rdFee" jdbcType="NUMERIC" />
			<result column="PAY_FEE" property="payFee" jdbcType="NUMERIC" />
		</collection>
	<!--	<collection property="listM"
					column="{proj_object=proj_object, yearStr=yearStr}"
					ofType="com.ppmg.ei.model.FundEnteModel"
					javaType="ArrayList"
					select="getGfInfo" />-->
	</resultMap>

	<select id="getGfInfo"   resultMap="FundEnte.FundEnteResult" parameterType="map">
        select * from EI.GF_T_FUND_ENTE kkk where
		kkk.ENTE_ID=#{proj_object}
	and (kkk.YEAR=(to_char(to_date(#{yearStr},'yyyy'),'yyyy')) or  kkk.YEAR=to_char(add_months(to_date(#{yearStr},'yyyy'),-12),'yyyy'))
	</select>

	<resultMap id="projExportResult1" type="com.ppmg.ei.model.ProjInfoExportModel" >
		<result column="INVE_ID" property="inveId" jdbcType="VARCHAR" />
		<result column="PROJ_NAME" property="projName" jdbcType="VARCHAR" />
		<result column="PROJ_ID" property="projId" jdbcType="VARCHAR" />
		<result column="proj_object" property="projObject" jdbcType="VARCHAR" />
		<result column="inve_name" property="inveName" jdbcType="VARCHAR" />
		<result column="enteName" property="enteName" jdbcType="VARCHAR" />
		<result column="SETUP_DT" property="setupDt" jdbcType="VARCHAR" />
		<result column="START_DATE" property="startDate" jdbcType="TIMESTAMP" />
		<result column="ADDRESS_DETAILS" property="addressDetails" jdbcType="VARCHAR" />
		<result column="REG_ADD" property="regAdd" jdbcType="VARCHAR" />
		<result column="REGIST_CAPI" property="registCapi" jdbcType="VARCHAR" />
		<result column="INTENDED_AMOUNT" property="intendedAmount" jdbcType="NUMERIC" />
		<result column="RMB_INTENDED_AMOUNT" property="rmbIntendedAmount" jdbcType="NUMERIC" />
		<result column="PER_SHARE" property="perShare" jdbcType="NUMERIC" />
		<result column="PERCENT" property="percent" jdbcType="VARCHAR" />
		<result column="INVE_ROUNDS" property="inveRounds" jdbcType="NUMERIC" />
		<result column="OCCUR_DT" property="occurDt" jdbcType="TIMESTAMP" />
		<result column="inve_type" property="inveType" jdbcType="VARCHAR" />
		<result column="INDUSTRY_NAME" property="industryName" jdbcType="VARCHAR" />
		<result column="PROVINCE_AMOUNT" property="provinceAmount" jdbcType="NUMERIC" />
		<result column="is_private" property="isPrivate" jdbcType="VARCHAR" />
		<result column="is_technology" property="isTechnology" jdbcType="VARCHAR" />
		<result column="is_strategy" property="isStrategy" jdbcType="VARCHAR" />
		<result column="IS_DIRECTOR_CNT" property="isDirectorCnt" jdbcType="VARCHAR" />
		<result column="IS_SUPERVISOR_CNT" property="isSupervisorCnt" jdbcType="VARCHAR" />
		<result column="POST_MONEY" property="postMoney" jdbcType="VARCHAR" />
		<result column="ENTE_POST_VALUE" property="entePostValue" jdbcType="VARCHAR" />
		<result column="INVE_NEW_VALUE" property="inveNewValue" jdbcType="VARCHAR" />
		<result column="HOLD_SHARE" property="holdShare" jdbcType="VARCHAR" />
		<result column="IS_PUBLIC_COMP" property="isPublicComp" jdbcType="NUMERIC" />
		<result column="IS_PROVINCE" property="isProvince" jdbcType="NUMERIC" />
		<result column="phase" property="phase" jdbcType="VARCHAR" />
		<result column="HLIGHTS_REMARK" property="hlightsRemark" jdbcType="VARCHAR" />
		<result column="QUIT_RMB_INVE_AMOUNT" property="quitRmbInveAmount" jdbcType="VARCHAR" />
		<result column="QUIT_SY" property="quitSy" jdbcType="VARCHAR" />
		<result column="QUIT_DT" property="quitDt" jdbcType="TIMESTAMP" />
		<result column="EXIT_TYPE" property="exitType" jdbcType="VARCHAR" />
		<result column="FINA_ROUNDS" property="finaRounds" jdbcType="VARCHAR" />
		<result column="FINA_TIMES" property="finaTimes" jdbcType="VARCHAR" />
		<result column="REG_AMOUNT" property="regAmount" jdbcType="NUMERIC" />
		<result column="REG_AMOUNT_CURRENCY" property="regAmountCurrency" jdbcType="VARCHAR" />
		<collection property="listM" ofType="com.ppmg.ei.model.FundEnteExport">
			<result column="inveStr" property="inveStr" jdbcType="VARCHAR" />
			<result column="YEAR" property="year" jdbcType="VARCHAR" />
			<result column="STAFF_NUM" property="staffNum" jdbcType="NUMERIC" />
			<result column="RD_STAFF_NUM" property="rdStaffNum" jdbcType="NUMERIC" />
			<result column="TOTAL_ASSETS" property="totalAssets" jdbcType="NUMERIC" />
			<result column="TOTAL_LIABILITIES" property="totalLiabilities" jdbcType="NUMERIC" />
			<result column="OWNER_EQUITY" property="ownerEquity" jdbcType="NUMERIC" />
			<result column="TOTAL_INCOME" property="totalIncome" jdbcType="NUMERIC" />
			<result column="TOTAL_PROFIT" property="totalProfit" jdbcType="NUMERIC" />
			<result column="NET_PROFIT" property="netProfit" jdbcType="NUMERIC" />
			<result column="RD_FEE" property="rdFee" jdbcType="NUMERIC" />
			<result column="PAY_FEE" property="payFee" jdbcType="NUMERIC" />
		</collection>
	</resultMap>

	<resultMap id="projExportResult12" type="com.ppmg.ei.model.ProjInfoAllExportModel" >
		<result column="INVE_ID" property="inveId" jdbcType="VARCHAR" />
		<result column="PROJ_NAME" property="projName" jdbcType="VARCHAR" />
		<result column="PROJ_ID" property="projId" jdbcType="VARCHAR" />
		<result column="proj_object" property="projObject" jdbcType="VARCHAR" />
		<result column="inve_name" property="inveName" jdbcType="VARCHAR" />
		<result column="enteName" property="enteName" jdbcType="VARCHAR" />
		<result column="SETUP_DT" property="setupDt" jdbcType="VARCHAR" />
		<result column="START_DATE" property="startDate" jdbcType="TIMESTAMP" />
		<result column="ADDRESS_DETAILS" property="addressDetails" jdbcType="VARCHAR" />
		<result column="REG_ADD" property="regAdd" jdbcType="VARCHAR" />
		<result column="REGIST_CAPI" property="registCapi" jdbcType="VARCHAR" />
		<result column="INTENDED_AMOUNT" property="intendedAmount" jdbcType="NUMERIC" />
		<result column="RMB_INTENDED_AMOUNT" property="rmbIntendedAmount" jdbcType="NUMERIC" />
		<result column="PER_SHARE" property="perShare" jdbcType="NUMERIC" />
		<result column="PERCENT" property="percent" jdbcType="VARCHAR" />
		<result column="INVE_ROUNDS" property="inveRounds" jdbcType="NUMERIC" />
		<result column="OCCUR_DT" property="occurDt" jdbcType="TIMESTAMP" />
		<result column="inve_type" property="inveType" jdbcType="VARCHAR" />
		<result column="INDUSTRY_NAME" property="industryName" jdbcType="VARCHAR" />
		<result column="PROVINCE_AMOUNT" property="provinceAmount" jdbcType="NUMERIC" />
		<result column="is_private" property="isPrivate" jdbcType="VARCHAR" />
		<result column="is_technology" property="isTechnology" jdbcType="VARCHAR" />
		<result column="is_strategy" property="isStrategy" jdbcType="VARCHAR" />
		<result column="IS_DIRECTOR_CNT" property="isDirectorCnt" jdbcType="VARCHAR" />
		<result column="IS_SUPERVISOR_CNT" property="isSupervisorCnt" jdbcType="VARCHAR" />
		<result column="POST_MONEY" property="postMoney" jdbcType="VARCHAR" />
		<result column="ENTE_POST_VALUE" property="entePostValue" jdbcType="VARCHAR" />
		<result column="INVE_NEW_VALUE" property="inveNewValue" jdbcType="VARCHAR" />
		<result column="HOLD_SHARE" property="holdShare" jdbcType="VARCHAR" />
		<result column="IS_PUBLIC_COMP" property="isPublicComp" jdbcType="NUMERIC" />
		<result column="IS_PROVINCE" property="isProvince" jdbcType="NUMERIC" />
		<result column="phase" property="phase" jdbcType="VARCHAR" />
		<result column="HLIGHTS_REMARK" property="hlightsRemark" jdbcType="VARCHAR" />
		<result column="QUIT_RMB_INVE_AMOUNT" property="quitRmbInveAmount" jdbcType="VARCHAR" />
		<result column="QUIT_SY" property="quitSy" jdbcType="VARCHAR" />
		<result column="QUIT_DT" property="quitDt" jdbcType="TIMESTAMP" />
		<result column="EXIT_TYPE" property="exitType" jdbcType="VARCHAR" />
		<result column="FINA_ROUNDS" property="finaRounds" jdbcType="VARCHAR" />
		<result column="FINA_TIMES" property="finaTimes" jdbcType="VARCHAR" />
		<result column="REG_AMOUNT" property="regAmount" jdbcType="NUMERIC" />
		<result column="REG_AMOUNT_CURRENCY" property="regAmountCurrency" jdbcType="VARCHAR" />
		<collection property="listM" ofType="com.ppmg.ei.model.FundEnteExport">
			<result column="inveStr" property="inveStr" jdbcType="VARCHAR" />
			<result column="YEAR" property="year" jdbcType="VARCHAR" />
			<result column="STAFF_NUM" property="staffNum" jdbcType="VARCHAR" />
			<result column="RD_STAFF_NUM" property="rdStaffNum" jdbcType="VARCHAR" />
			<result column="TOTAL_ASSETS" property="totalAssets" jdbcType="VARCHAR" />
			<result column="TOTAL_LIABILITIES" property="totalLiabilities" jdbcType="VARCHAR" />
			<result column="OWNER_EQUITY" property="ownerEquity" jdbcType="VARCHAR" />
			<result column="TOTAL_INCOME" property="totalIncome" jdbcType="VARCHAR" />
			<result column="TOTAL_PROFIT" property="totalProfit" jdbcType="VARCHAR" />
			<result column="NET_PROFIT" property="netProfit" jdbcType="VARCHAR" />
			<result column="RD_FEE" property="rdFee" jdbcType="VARCHAR" />
			<result column="PAY_FEE" property="payFee" jdbcType="VARCHAR" />
		</collection>
	</resultMap>

    <resultMap id="ledgeResult" type="com.ppmg.ei.model.LedgeMagExportModel" >
        <result column="REG_NAME" property="regName" jdbcType="VARCHAR" />
        <result column="CURRENT_AMOUNT" property="currentAmount" jdbcType="NUMERIC" />
        <result column="RMB_CURRENT_AMOUNT" property="rmbCurrentAmount" jdbcType="NUMERIC" />
        <result column="RAISE_AMOUNT" property="raiseAmount" jdbcType="NUMERIC" />
        <result column="RMB_RAISE_AMOUNT" property="rmbRaiseAmount" jdbcType="NUMERIC" />
        <result column="JC_RMB_INVE_AMOUNT" property="jcRmbInveAmount" jdbcType="VARCHAR" />
		<result column="JC_RMB_INVE_AMOUNT_ONE" property="jcRmbInveAmountoOne" jdbcType="VARCHAR" />
        <result column="JC_RMB_RAISE_AMOUNT" property="jcRmbRaiseAmount" jdbcType="VARCHAR" />
        <result column="SUM_RAISE_AMOUNT" property="sumRaiseAmount" jdbcType="VARCHAR" />
        <result column="INVE_NAME" property="inveName" jdbcType="VARCHAR" />
        <result column="SUM_BACK_AMOUNT" property="sumBackAmount" jdbcType="VARCHAR" />
        <result column="NEW_ACCOUNT_BALANCE" property="newAccountBalance" jdbcType="VARCHAR" />
		<result column="SURPLUS_AMOUNT" property="surplusAmount" jdbcType="VARCHAR" />
        <result column="PERCENT" property="percent" jdbcType="VARCHAR" />
        <result column="PROFIT_AMOUNT" property="profitAmount" jdbcType="VARCHAR" />
		<result column="OLD_SUB_PLAT_PROP" property="oldSubPlatProp" jdbcType="VARCHAR" />
        <result column="proj_id" property="projId" jdbcType="VARCHAR" />
		<result column="sum_DIS_JC_AMOUNT_STR" property="sumDisJcAmountStr" jdbcType="VARCHAR" />
		<collection property="listInveInfo" ofType="com.ppmg.ei.model.InveExportInfo">
			<result column="OCCUR_AMOUNT" property="occurAmount" jdbcType="NUMERIC" />
			<result column="OCCUR_DT" property="occurDt" jdbcType="TIMESTAMP" />
			<result column="RMB_INVE_AMOUNT" property="rmbInveAmount" jdbcType="NUMERIC" />
		</collection>
        <collection property="listFundAccountDetail" ofType="com.ppmg.ei.model.FundAccountDetailModel">
            <result column="FUND_AMOUNT" property="fundAmount" jdbcType="NUMERIC" />
			<result column="FUND_AMOUNT_STR" property="fundAmountStr" jdbcType="VARCHAR" />
            <result column="DIS_DATA" property="disData" jdbcType="TIMESTAMP" />
            <result column="DIS_JC_AMOUNT" property="disJcAmount" jdbcType="NUMERIC" />
			<result column="DIS_JC_AMOUNT_STR" property="disJcAmountStr" jdbcType="VARCHAR" />
        </collection>
    </resultMap>

	<resultMap id="DataQuarterResult" type="com.ppmg.ei.model.DataQuarterModel" >
		<result column="USER_BIZ_VALUE" property="userBizValue" jdbcType="VARCHAR" />
		<collection property="listItem" ofType="com.ppmg.ei.model.DataQuarterItemModel">
			<result column="BIZ_KEY" property="bizKey" jdbcType="VARCHAR" />
			<result column="BIZ_KEY_VALUE" property="bizKeyValue" jdbcType="VARCHAR" />
			<result column="DATA_TYPE" property="dataType" jdbcType="VARCHAR" />
			<result column="BIZ_TABLE" property="bizTable" jdbcType="VARCHAR" />
			<result column="BIZ_KEY" property="bizKey" jdbcType="VARCHAR" />
			<result column="TASK_TITLE" property="taskTitle" jdbcType="VARCHAR" />
			<result column="DATA_TYPE" property="dataType" jdbcType="VARCHAR" />
		</collection>
	</resultMap>

    <resultMap id="DataQuarterResult11" type="com.ppmg.ei.model.DataQuarterModel" >
        <result column="loginName" property="loginName" jdbcType="VARCHAR" />
        <result column="PHONE_NO" property="phoneNo" jdbcType="VARCHAR" />
        <result column="userBizValue" property="userBizValue" jdbcType="VARCHAR" />
    </resultMap>


	<insert id="insert" parameterType="com.ppmg.ei.model.FundInfoModel">
		INSERT INTO BD_T_FUND_INFO (FUND_ID,FUND_CODE,FUND_NAME,REG_NAME,MC_ID,MC_NAME,GP,CONTACT,PHONE_NO,CONTACT_EMAIL,PLAN_AMOUNT,PLAN_CURR,RAISE_AMOUNT,RAISE_CURRENCY,FUND_STRUCT,PLAT_PROP,SUB_PLAT_PROP,SETUP_DT,CLOSE_DT,REG_ADD,ORGN_CODE,LEGAL_PERSON,CUSTODIAN_BANK,REG_CAPITAL,REG_CURRENCY,CAPITAL_ACCOUNT,RETURN_ACCOUNT,FUND_STS,DESC_FILE,FUND_SRC,CREATE_BY,CREATE_DT,UPDATE_BY,UPDATE_DT,FUND_GENRE,CUSTODIAN_BANKACCOUNT,CAPITAL_BANK,RETURN_BANK,PARTNERS,GROUP_ID,GP_ID,RMB_RAISE_AMOUNT,CURRENT_AMOUNT,CURRENT_CURRENCY,RMB_CURRENT_AMOUNT,MAINTENANCE_ID,MAINTENANCE,SOCIAL_CODE,KEY_PERSON_LOCK,RATIO_IN_GP,RMB_PLAN_AMOUNT,FUND_SCOPE,YH_RATIO_AS_LP,YH_RATIO_IN_GP,YH_RATIO_IN_MC,EMAIL,ENTE_ID,EMAIL_PASSWORD,FINANCE_ID,FINANCE_NAME,EXECUTIVE_PARTNER_ID,EXECUTIVE_PARTNER_NAME,IS_FIT,CUSTODIAN_OPEN_BANK,CUSTODIAN_BANK_NUM,IS_RECORD,RECORD_CODE,RECORD_DATE,RECORD_ATTA,IS_CUSTODIAN,CUSTODIAN_ATTA,IS_AUTH,AUTH_ATTA,PROMISE_AMOUNT,PROFIT_AMOUNT,STATUS,INVE_CURRENT_AMOUNT,SPV_TYPE,IS_EXCEPT,INVE_RAISE_AMOUNT,OLD_SUB_PLAT_PROP,ISDIRECT,IS_DESIGNATE,FUND_CODE_SIGN,REGISTER_STATUS,SHORT_NAME,MAN_DEP,APP_DEP,IS_EXIT,FINANCE_AMOUNT,GOV_FUND_SRC,INVE_TYPE,IS_LEAD,INVE_LIMIT,BASIS,OLD_FUND_GENRE,FUND_LEAD,FUND_LEAD_ID,REP_ID,REP_NAME,ORGAN_STRUCT,OTHER_FILE) values(#{fundId,jdbcType=VARCHAR},#{fundCode,jdbcType=VARCHAR},#{fundName,jdbcType=VARCHAR},#{regName,jdbcType=VARCHAR},#{mcId,jdbcType=VARCHAR},#{mcName,jdbcType=VARCHAR},#{gp,jdbcType=VARCHAR},#{contact,jdbcType=VARCHAR},#{phoneNo,jdbcType=VARCHAR},#{contactEmail,jdbcType=VARCHAR},#{planAmount,jdbcType=NUMERIC},#{planCurr,jdbcType=VARCHAR},#{raiseAmount,jdbcType=NUMERIC},#{raiseCurrency,jdbcType=VARCHAR},#{fundStruct,jdbcType=VARCHAR},#{platProp,jdbcType=VARCHAR},#{subPlatProp,jdbcType=VARCHAR},#{setupDt,jdbcType=TIMESTAMP},#{closeDt,jdbcType=TIMESTAMP},#{regAdd,jdbcType=VARCHAR},#{orgnCode,jdbcType=VARCHAR},#{legalPerson,jdbcType=VARCHAR},#{custodianBank,jdbcType=VARCHAR},#{regCapital,jdbcType=NUMERIC},#{regCurrency,jdbcType=VARCHAR},#{capitalAccount,jdbcType=VARCHAR},#{returnAccount,jdbcType=VARCHAR},#{fundSts,jdbcType=VARCHAR},#{descFile,jdbcType=VARCHAR},#{fundSrc,jdbcType=VARCHAR},#{createBy,jdbcType=VARCHAR},#{createDt,jdbcType=TIMESTAMP},#{updateBy,jdbcType=VARCHAR},#{updateDt,jdbcType=TIMESTAMP},#{fundGenre,jdbcType=VARCHAR},#{custodianBankaccount,jdbcType=VARCHAR},#{capitalBank,jdbcType=VARCHAR},#{returnBank,jdbcType=VARCHAR},#{partners,jdbcType=VARCHAR},#{groupId,jdbcType=NUMERIC},#{gpId,jdbcType=VARCHAR},#{rmbRaiseAmount,jdbcType=NUMERIC},#{currentAmount,jdbcType=NUMERIC},#{currentCurrency,jdbcType=VARCHAR},#{rmbCurrentAmount,jdbcType=NUMERIC},#{maintenanceId,jdbcType=VARCHAR},#{maintenance,jdbcType=VARCHAR},#{socialCode,jdbcType=VARCHAR},#{keyPersonLock,jdbcType=VARCHAR},#{ratioInGp,jdbcType=NUMERIC},#{rmbPlanAmount,jdbcType=NUMERIC},#{fundScope,jdbcType=VARCHAR},#{yhRatioAsLp,jdbcType=NUMERIC},#{yhRatioInGp,jdbcType=NUMERIC},#{yhRatioInMc,jdbcType=NUMERIC},#{email,jdbcType=VARCHAR},#{enteId,jdbcType=VARCHAR},#{emailPassword,jdbcType=VARCHAR},#{financeId,jdbcType=VARCHAR},#{financeName,jdbcType=VARCHAR},#{executivePartnerId,jdbcType=VARCHAR},#{executivePartnerName,jdbcType=VARCHAR},#{isFit,jdbcType=VARCHAR},#{custodianOpenBank,jdbcType=VARCHAR},#{custodianBankNum,jdbcType=VARCHAR},#{isRecord,jdbcType=VARCHAR},#{recordCode,jdbcType=VARCHAR},#{recordDate,jdbcType=TIMESTAMP},#{recordAtta,jdbcType=VARCHAR},#{ isCustodian,jdbcType=VARCHAR},#{custodianAtta,jdbcType=VARCHAR},#{isAuth,jdbcType=VARCHAR},#{authAtta,jdbcType=VARCHAR},#{promiseAmount,jdbcType=NUMERIC},#{profitAmount,jdbcType=NUMERIC},#{status,jdbcType=VARCHAR},#{inveCurrentAmount,jdbcType=NUMERIC},#{spvType,jdbcType=VARCHAR},#{isExcept,jdbcType=VARCHAR},#{inveRaiseAmount,jdbcType=NUMERIC},#{oldSubPlatProp,jdbcType=VARCHAR},#{isDirect,jdbcType=VARCHAR},#{isDesignate,jdbcType=VARCHAR},#{fundCodeSign,jdbcType=VARCHAR},#{registerStatus,jdbcType=VARCHAR},#{shortName,jdbcType=VARCHAR},#{manDep,jdbcType=VARCHAR},#{appDep,jdbcType=VARCHAR},#{isExit,jdbcType=VARCHAR},#{financeAmount,jdbcType=VARCHAR},#{govFundSrc,jdbcType=VARCHAR},#{inveType,jdbcType=VARCHAR},#{isLead,jdbcType=VARCHAR},#{inveLimit,jdbcType=VARCHAR},#{basis,jdbcType=VARCHAR},#{oldFundGenre,jdbcType=VARCHAR},#{fundLead,jdbcType=VARCHAR},#{fundLeadId,jdbcType=VARCHAR},#{repId,jdbcType=VARCHAR},#{repName,jdbcType=VARCHAR},#{organStruct,jdbcType=VARCHAR},#{otherFile,jdbcType=VARCHAR})
	</insert>

	<insert id="insertBatch" parameterType="List">
		INSERT INTO BD_T_FUND_INFO (FUND_ID,FUND_CODE,FUND_NAME,REG_NAME,MC_ID,MC_NAME,GP,CONTACT,PHONE_NO,CONTACT_EMAIL,PLAN_AMOUNT,PLAN_CURR,RAISE_AMOUNT,RAISE_CURRENCY,FUND_STRUCT,PLAT_PROP,SUB_PLAT_PROP,SETUP_DT,CLOSE_DT,REG_ADD,ORGN_CODE,LEGAL_PERSON,CUSTODIAN_BANK,REG_CAPITAL,REG_CURRENCY,CAPITAL_ACCOUNT,RETURN_ACCOUNT,FUND_STS,DESC_FILE,FUND_SRC,CREATE_BY,CREATE_DT,UPDATE_BY,UPDATE_DT,FUND_GENRE,CUSTODIAN_BANKACCOUNT,CAPITAL_BANK,RETURN_BANK,PARTNERS,GROUP_ID,GP_ID,RMB_RAISE_AMOUNT,CURRENT_AMOUNT,CURRENT_CURRENCY,RMB_CURRENT_AMOUNT,MAINTENANCE_ID,MAINTENANCE,SOCIAL_CODE,KEY_PERSON_LOCK,RATIO_IN_GP,RMB_PLAN_AMOUNT,FUND_SCOPE,YH_RATIO_AS_LP,YH_RATIO_IN_GP,YH_RATIO_IN_MC,EMAIL,ENTE_ID,EMAIL_PASSWORD,FINANCE_ID,FINANCE_NAME,EXECUTIVE_PARTNER_ID,EXECUTIVE_PARTNER_NAME,IS_FIT,CUSTODIAN_OPEN_BANK,CUSTODIAN_BANK_NUM,IS_RECORD,RECORD_CODE,RECORD_DATE,RECORD_ATTA,IS_CUSTODIAN,CUSTODIAN_ATTA,IS_AUTH,AUTH_ATTA,PROMISE_AMOUNT,PROFIT_AMOUNT,STATUS,INVE_CURRENT_AMOUNT,SPV_TYPE,IS_EXCEPT,INVE_RAISE_AMOUNT,OLD_SUB_PLAT_PROP)
		<foreach collection="list" item="item" index="index" separator="union all">
			( select
				#{item.fundId,jdbcType=VARCHAR},
				#{item.fundCode,jdbcType=VARCHAR},
				#{item.fundName,jdbcType=VARCHAR},
				#{item.regName,jdbcType=VARCHAR},
				#{item.mcId,jdbcType=VARCHAR},
				#{item.mcName,jdbcType=VARCHAR},
				#{item.gp,jdbcType=VARCHAR},
				#{item.contact,jdbcType=VARCHAR},
				#{item.phoneNo,jdbcType=VARCHAR},
				#{item.contactEmail,jdbcType=VARCHAR},
				#{item.planAmount,jdbcType=NUMERIC},
				#{item.planCurr,jdbcType=VARCHAR},
				#{item.raiseAmount,jdbcType=NUMERIC},
				#{item.raiseCurrency,jdbcType=VARCHAR},
				#{item.fundStruct,jdbcType=VARCHAR},
				#{item.platProp,jdbcType=VARCHAR},
				#{item.subPlatProp,jdbcType=VARCHAR},
				#{item.setupDt,jdbcType=TIMESTAMP},
				#{item.closeDt,jdbcType=TIMESTAMP},
				#{item.regAdd,jdbcType=VARCHAR},
				#{item.orgnCode,jdbcType=VARCHAR},
				#{item.legalPerson,jdbcType=VARCHAR},
				#{item.custodianBank,jdbcType=VARCHAR},
				#{item.regCapital,jdbcType=NUMERIC},
				#{item.regCurrency,jdbcType=VARCHAR},
				#{item.capitalAccount,jdbcType=VARCHAR},
				#{item.returnAccount,jdbcType=VARCHAR},
				#{item.fundSts,jdbcType=VARCHAR},
				#{item.descFile,jdbcType=VARCHAR},
				#{item.fundSrc,jdbcType=VARCHAR},
				#{item.createBy,jdbcType=VARCHAR},
				#{item.createDt,jdbcType=TIMESTAMP},
				#{item.updateBy,jdbcType=VARCHAR},
				#{item.updateDt,jdbcType=TIMESTAMP},
				#{item.fundGenre,jdbcType=VARCHAR},
				#{item.custodianBankaccount,jdbcType=VARCHAR},
				#{item.capitalBank,jdbcType=VARCHAR},
				#{item.returnBank,jdbcType=VARCHAR},
				#{item.partners,jdbcType=VARCHAR},
				#{item.groupId,jdbcType=NUMERIC},
				#{item.gpId,jdbcType=VARCHAR},
				#{item.rmbRaiseAmount,jdbcType=NUMERIC},
				#{item.currentAmount,jdbcType=NUMERIC},
				#{item.currentCurrency,jdbcType=VARCHAR},
				#{item.rmbCurrentAmount,jdbcType=NUMERIC},
				#{item.maintenanceId,jdbcType=VARCHAR},
				#{item.maintenance,jdbcType=VARCHAR},
				#{item.socialCode,jdbcType=VARCHAR},
				#{item.keyPersonLock,jdbcType=VARCHAR},
				#{item.ratioInGp,jdbcType=NUMERIC},
				#{item.rmbPlanAmount,jdbcType=NUMERIC},
				#{item.fundScope,jdbcType=VARCHAR},
				#{item.yhRatioAsLp,jdbcType=NUMERIC},
				#{item.yhRatioInGp,jdbcType=NUMERIC},
				#{item.yhRatioInMc,jdbcType=NUMERIC},
				#{item.email,jdbcType=VARCHAR},
				#{item.enteId,jdbcType=VARCHAR},
				#{item.emailPassword,jdbcType=VARCHAR},
				#{item.financeId,jdbcType=VARCHAR},
				#{item.financeName,jdbcType=VARCHAR},
				#{item.executivePartnerId,jdbcType=VARCHAR},
				#{item.executivePartnerName,jdbcType=VARCHAR},
				#{item.isFit,jdbcType=VARCHAR},
				#{item.custodianOpenBank,jdbcType=VARCHAR},
				#{item.custodianBankNum,jdbcType=VARCHAR},
				#{item.isRecord,jdbcType=VARCHAR},
				#{item.recordCode,jdbcType=VARCHAR},
				#{item.recordDate,jdbcType=TIMESTAMP},
				#{item.recordAtta,jdbcType=VARCHAR},
			    #{item.isCustodian,jdbcType=VARCHAR},
			    #{item.custodianAtta,jdbcType=VARCHAR},
			    #{item.isAuth,jdbcType=VARCHAR},
			    #{item.authAtta,jdbcType=VARCHAR},
			    #{item.promiseAmount,jdbcType=NUMERIC},
			    #{item.profitAmount,jdbcType=NUMERIC},
			    #{item.status,jdbcType=VARCHAR},
			    #{item.inveCurrentAmount,jdbcType=NUMERIC},
			    #{item.spvType,jdbcType=VARCHAR},
			    #{item.isExcept,jdbcType=VARCHAR},
			    #{item.inveRaiseAmount,jdbcType=NUMERIC},
			    #{item.isLead,jdbcType=VARCHAR},
			    #{item.isExit,jdbcType=VARCHAR},
			    #{item.financeAmount,jdbcType=NUMERIC},
			    #{item.inveType,jdbcType=VARCHAR},
			    #{item.appDep,jdbcType=VARCHAR},
			    #{item.govFundSrc,jdbcType=VARCHAR},
			    #{item.basis,jdbcType=VARCHAR},
			    #{item.inveLimit,jdbcType=VARCHAR},
			    #{item.manDep,jdbcType=VARCHAR},
			    #{item.shortName,jdbcType=VARCHAR},
			    #{item.fundsType,jdbcType=VARCHAR},
			    #{item.parentId,jdbcType=VARCHAR},
			    #{item.fundCategory,jdbcType=VARCHAR},
			    #{item.oldSubPlatProp,jdbcType=VARCHAR},
			    #{item.isDirect,jdbcType=VARCHAR},
			    #{item.isDesignate,jdbcType=VARCHAR},
			    #{item.fundCodeSign,jdbcType=VARCHAR}
		 	from dual)
		</foreach>
	</insert>

	<delete id="deleteById" parameterType="String">
		DELETE FROM  BD_T_FUND_INFO WHERE FUND_ID = #{fundId,jdbcType=VARCHAR}
	</delete>

	<delete id="deletePK" parameterType="com.ppmg.ei.model.FundInfoModel">
		DELETE FROM BD_T_FUND_INFO
		<where>
			<if test="fundId != null and fundId != ''" >
				FUND_ID = #{fundId,jdbcType=VARCHAR}
			</if>
			<if test="fundCode != null and fundCode != ''" >
				AND FUND_CODE = #{fundCode,jdbcType=VARCHAR}
			</if>
			<if test="fundName != null and fundName != ''" >
				AND FUND_NAME = #{fundName,jdbcType=VARCHAR}
			</if>
			<if test="regName != null and regName != ''" >
				AND REG_NAME = #{regName,jdbcType=VARCHAR}
			</if>
			<if test="mcId != null and mcId != ''" >
				AND MC_ID = #{mcId,jdbcType=VARCHAR}
			</if>
			<if test="mcName != null and mcName != ''" >
				AND MC_NAME = #{mcName,jdbcType=VARCHAR}
			</if>
			<if test="gp != null and gp != ''" >
				AND GP = #{gp,jdbcType=VARCHAR}
			</if>
			<if test="contact != null and contact != ''" >
				AND CONTACT = #{contact,jdbcType=VARCHAR}
			</if>
			<if test="phoneNo != null and phoneNo != ''" >
				AND PHONE_NO = #{phoneNo,jdbcType=VARCHAR}
			</if>
			<if test="contactEmail != null and contactEmail != ''" >
				AND CONTACT_EMAIL = #{contactEmail,jdbcType=VARCHAR}
			</if>
			<if test="planAmount != null and planAmount != ''" >
				AND PLAN_AMOUNT = #{planAmount,jdbcType=NUMERIC}
			</if>
			<if test="planCurr != null and planCurr != ''" >
				AND PLAN_CURR = #{planCurr,jdbcType=VARCHAR}
			</if>
			<if test="raiseAmount != null and raiseAmount != ''" >
				AND RAISE_AMOUNT = #{raiseAmount,jdbcType=NUMERIC}
			</if>
			<if test="raiseCurrency != null and raiseCurrency != ''" >
				AND RAISE_CURRENCY = #{raiseCurrency,jdbcType=VARCHAR}
			</if>
			<if test="fundStruct != null and fundStruct != ''" >
				AND FUND_STRUCT = #{fundStruct,jdbcType=VARCHAR}
			</if>
			<if test="platProp != null and platProp != ''" >
				AND PLAT_PROP = #{platProp,jdbcType=VARCHAR}
			</if>
			<if test="subPlatProp != null and subPlatProp != ''" >
				AND SUB_PLAT_PROP = #{subPlatProp,jdbcType=VARCHAR}
			</if>
			<if test="setupDt != null" >
				AND SETUP_DT = #{setupDt,jdbcType=VARCHAR}
			</if>
			<if test="closeDt != null" >
				AND CLOSE_DT = #{closeDt,jdbcType=VARCHAR}
			</if>
			<if test="regAdd != null and regAdd != ''" >
				AND REG_ADD = #{regAdd,jdbcType=VARCHAR}
			</if>
			<if test="orgnCode != null and orgnCode != ''" >
				AND ORGN_CODE = #{orgnCode,jdbcType=VARCHAR}
			</if>
			<if test="legalPerson != null and legalPerson != ''" >
				AND LEGAL_PERSON = #{legalPerson,jdbcType=VARCHAR}
			</if>
			<if test="custodianBank != null and custodianBank != ''" >
				AND CUSTODIAN_BANK = #{custodianBank,jdbcType=VARCHAR}
			</if>
			<if test="regCapital != null and regCapital != ''" >
				AND REG_CAPITAL = #{regCapital,jdbcType=NUMERIC}
			</if>
			<if test="regCurrency != null and regCurrency != ''" >
				AND REG_CURRENCY = #{regCurrency,jdbcType=VARCHAR}
			</if>
			<if test="capitalAccount != null and capitalAccount != ''" >
				AND CAPITAL_ACCOUNT = #{capitalAccount,jdbcType=VARCHAR}
			</if>
			<if test="returnAccount != null and returnAccount != ''" >
				AND RETURN_ACCOUNT = #{returnAccount,jdbcType=VARCHAR}
			</if>
			<if test="fundSts != null and fundSts != ''" >
				AND FUND_STS = #{fundSts,jdbcType=VARCHAR}
			</if>
			<if test="descFile != null and descFile != ''" >
				AND DESC_FILE = #{descFile,jdbcType=VARCHAR}
			</if>
			<if test="fundSrc != null and fundSrc != ''" >
				AND FUND_SRC = #{fundSrc,jdbcType=VARCHAR}
			</if>
			<if test="createBy != null and createBy != ''" >
				AND CREATE_BY = #{createBy,jdbcType=VARCHAR}
			</if>
			<if test="createDt != null" >
				AND CREATE_DT = #{createDt,jdbcType=VARCHAR}
			</if>
			<if test="updateBy != null and updateBy != ''" >
				AND UPDATE_BY = #{updateBy,jdbcType=VARCHAR}
			</if>
			<if test="updateDt != null" >
				AND UPDATE_DT = #{updateDt,jdbcType=VARCHAR}
			</if>
			<if test="fundGenre != null and fundGenre != ''" >
				AND FUND_GENRE = #{fundGenre,jdbcType=VARCHAR}
			</if>
			<if test="custodianBankaccount != null and custodianBankaccount != ''" >
				AND CUSTODIAN_BANKACCOUNT = #{custodianBankaccount,jdbcType=VARCHAR}
			</if>
			<if test="capitalBank != null and capitalBank != ''" >
				AND CAPITAL_BANK = #{capitalBank,jdbcType=VARCHAR}
			</if>
			<if test="returnBank != null and returnBank != ''" >
				AND RETURN_BANK = #{returnBank,jdbcType=VARCHAR}
			</if>
			<if test="partners != null and partners != ''" >
				AND PARTNERS = #{partners,jdbcType=VARCHAR}
			</if>
			<if test="groupId != null and groupId != ''" >
				AND GROUP_ID = #{groupId,jdbcType=NUMERIC}
			</if>
			<if test="gpId != null and gpId != ''" >
				AND GP_ID = #{gpId,jdbcType=VARCHAR}
			</if>
			<if test="rmbRaiseAmount != null and rmbRaiseAmount != ''" >
				AND RMB_RAISE_AMOUNT = #{rmbRaiseAmount,jdbcType=NUMERIC}
			</if>
			<if test="currentAmount != null and currentAmount != ''" >
				AND CURRENT_AMOUNT = #{currentAmount,jdbcType=NUMERIC}
			</if>
			<if test="currentCurrency != null and currentCurrency != ''" >
				AND CURRENT_CURRENCY = #{currentCurrency,jdbcType=VARCHAR}
			</if>
			<if test="rmbCurrentAmount != null and rmbCurrentAmount != ''" >
				AND RMB_CURRENT_AMOUNT = #{rmbCurrentAmount,jdbcType=NUMERIC}
			</if>
			<if test="maintenanceId != null and maintenanceId != ''" >
				AND MAINTENANCE_ID = #{maintenanceId,jdbcType=VARCHAR}
			</if>
			<if test="maintenance != null and maintenance != ''" >
				AND MAINTENANCE = #{maintenance,jdbcType=VARCHAR}
			</if>
			<if test="socialCode != null and socialCode != ''" >
				AND SOCIAL_CODE = #{socialCode,jdbcType=VARCHAR}
			</if>
			<if test="keyPersonLock != null and keyPersonLock != ''" >
				AND KEY_PERSON_LOCK = #{keyPersonLock,jdbcType=VARCHAR}
			</if>
			<if test="ratioInGp != null and ratioInGp != ''" >
				AND RATIO_IN_GP = #{ratioInGp,jdbcType=NUMERIC}
			</if>
			<if test="rmbPlanAmount != null and rmbPlanAmount != ''" >
				AND RMB_PLAN_AMOUNT = #{rmbPlanAmount,jdbcType=NUMERIC}
			</if>
			<if test="fundScope != null and fundScope != ''" >
				AND FUND_SCOPE = #{fundScope,jdbcType=VARCHAR}
			</if>
			<if test="yhRatioAsLp != null and yhRatioAsLp != ''" >
				AND YH_RATIO_AS_LP = #{yhRatioAsLp,jdbcType=NUMERIC}
			</if>
			<if test="yhRatioInGp != null and yhRatioInGp != ''" >
				AND YH_RATIO_IN_GP = #{yhRatioInGp,jdbcType=NUMERIC}
			</if>
			<if test="yhRatioInMc != null and yhRatioInMc != ''" >
				AND YH_RATIO_IN_MC = #{yhRatioInMc,jdbcType=NUMERIC}
			</if>
			<if test="email != null and email != ''" >
				AND EMAIL = #{email,jdbcType=VARCHAR}
			</if>
			<if test="enteId != null and enteId != ''" >
				AND ENTE_ID = #{enteId,jdbcType=VARCHAR}
			</if>
			<if test="emailPassword != null and emailPassword != ''" >
				AND EMAIL_PASSWORD = #{emailPassword,jdbcType=VARCHAR}
			</if>
			<if test="financeId != null and financeId != ''" >
				AND FINANCE_ID = #{financeId,jdbcType=VARCHAR}
			</if>
			<if test="financeName != null and financeName != ''" >
				AND FINANCE_NAME = #{financeName,jdbcType=VARCHAR}
			</if>
			<if test="executivePartnerId != null and executivePartnerId != ''" >
				AND EXECUTIVE_PARTNER_ID = #{executivePartnerId,jdbcType=VARCHAR}
			</if>
			<if test="executivePartnerName != null and executivePartnerName != ''" >
				AND EXECUTIVE_PARTNER_NAME = #{executivePartnerName,jdbcType=VARCHAR}
			</if>
			<if test="isFit != null and isFit != ''" >
				AND IS_FIT = #{isFit,jdbcType=VARCHAR}
			</if>
			<if test="custodianOpenBank != null and custodianOpenBank != ''" >
				AND CUSTODIAN_OPEN_BANK = #{custodianOpenBank,jdbcType=VARCHAR}
			</if>
			<if test="custodianBankNum != null and custodianBankNum != ''" >
				AND CUSTODIAN_BANK_NUM = #{custodianBankNum,jdbcType=VARCHAR}
			</if>
			<if test="isRecord != null and isRecord != ''" >
				AND IS_RECORD = #{isRecord,jdbcType=VARCHAR}
			</if>
			<if test="recordCode != null and recordCode != ''" >
				AND RECORD_CODE = #{recordCode,jdbcType=VARCHAR}
			</if>
			<if test="recordDate != null" >
				AND RECORD_DATE = #{recordDate,jdbcType=VARCHAR}
			</if>
			<if test="recordAtta != null and recordAtta != ''" >
				AND RECORD_ATTA = #{recordAtta,jdbcType=VARCHAR}
			</if>
			<if test="isCustodian!= null and isCustodian!= ''" >
				AND IS_CUSTODIAN = #{isCustodian,jdbcType=VARCHAR}
			</if>
			<if test="custodianAtta != null and custodianAtta != ''" >
				AND  CUSTODIAN_ATTA = #{custodianAtta,jdbcType=VARCHAR}
			</if>
			<if test="isAuth != null and isAuth != ''" >
				AND  IS_AUTH = #{isAuth,jdbcType=VARCHAR}
			</if>
			<if test="authAtta != null and authAtta != ''" >
				AND  AUTH_ATTA = #{authAtta,jdbcType=VARCHAR}
			</if>
			<if test="promiseAmount != null and promiseAmount != ''" >
				AND  PROMISE_AMOUNT = #{promiseAmount,jdbcType=NUMERIC}
			</if>
			<if test="profitAmount != null and profitAmount != ''" >
				AND  PROFIT_AMOUNT = #{profitAmount,jdbcType=NUMERIC}
			</if>
			<if test="status != null and status != ''" >
				AND  STATUS = #{status,jdbcType=VARCHAR}
			</if>
			<if test="inveCurrentAmount != null" >
				AND  INVE_CURRENT_AMOUNT = #{inveCurrentAmount,jdbcType=NUMERIC}
			</if>
			<if test="spvType != null and spvType != ''" >
				AND  SPV_TYPE = #{spvType,jdbcType=VARCHAR}
			</if>
			<if test="isExcept != null and isExcept != ''" >
				AND  IS_EXCEPT = #{isExcept,jdbcType=VARCHAR}
			</if>
			<if test="inveRaiseAmount != null" >
				AND INVE_RAISE_AMOUNT = #{inveRaiseAmount,jdbcType=NUMERIC}
			</if>
			<if test="isLead != null and isLead != ''" >
				AND  IS_LEAD = #{isLead,jdbcType=VARCHAR}
			</if>
			<if test="isExit != null and isExit != ''" >
				AND  IS_EXIT = #{isExit,jdbcType=VARCHAR}
			</if>
			<if test="financeAmount != null" >
				AND FINANCE_AMOUNT = #{financeAmount,jdbcType=NUMERIC}
			</if>
			<if test="inveType != null and inveType != ''" >
				AND  INVE_TYPE = #{inveType,jdbcType=VARCHAR}
			</if>
			<if test="appDep != null and appDep != ''" >
				AND  APP_DEP = #{appDep,jdbcType=VARCHAR}
			</if>
			<if test="govFundSrc != null and govFundSrc != ''" >
				AND  GOV_FUND_SRC = #{govFundSrc,jdbcType=VARCHAR}
			</if>
			<if test="basis != null and basis != ''" >
				AND  BASIS = #{basis,jdbcType=VARCHAR}
			</if>
			<if test="inveLimit != null and inveLimit != ''" >
				AND  INVE_LIMIT = #{inveLimit,jdbcType=VARCHAR}
			</if>
			<if test="manDep != null and manDep != ''" >
				AND  MAN_DEP = #{manDep,jdbcType=VARCHAR}
			</if>
			<if test="shortName != null and shortName != ''" >
				AND  SHORT_NAME = #{shortName,jdbcType=VARCHAR}
			</if>
			<if test="fundsType != null and fundsType != ''" >
				AND  FUNDS_TYPE = #{fundsType,jdbcType=VARCHAR}
			</if>
			<if test="parentId != null" >
				AND  PARENT_ID = #{parentId,jdbcType=VARCHAR}
			</if>
			<if test="fundCategory != null and fundCategory != ''" >
				AND  FUNDCATEGORY = #{fundCategory,jdbcType=VARCHAR}
			</if>
			<if test="oldSubPlatProp != null and oldSubPlatProp != ''" >
				AND  OLD_SUB_PLAT_PROP = #{oldSubPlatProp,jdbcType=VARCHAR}
			</if>
			<if test="isDirect != null and isDirect != ''" >
				AND  ISDIRECT = #{isDirect,jdbcType=VARCHAR}
			</if>
			<if test="isDesignate != null and isDesignate != ''" >
				AND  IS_DESIGNATE = #{isDesignate,jdbcType=VARCHAR}
			</if>
			<if test="fundCodeSign != null and fundCodeSign != ''" >
				AND  FUND_CODE_SIGN = #{fundCodeSign,jdbcType=VARCHAR}
			</if>

		</where>
	</delete>

	<delete id="deleteBatch" parameterType="List">
		DELETE FROM  BD_T_FUND_INFO WHERE FUND_ID IN
		<foreach collection="array" item="item" open="(" separator="," close=")">
		#{item}
	   </foreach>
	</delete>

	<update id="updatePK" parameterType="com.ppmg.ei.model.FundInfoModel">
		UPDATE BD_T_FUND_INFO 
		<set>
			<if test="fundId != null and fundId != ''" >
				FUND_ID = #{fundId,jdbcType=VARCHAR},
			</if>
			<if test="fundCode != null and fundCode != ''" >
				FUND_CODE = #{fundCode,jdbcType=VARCHAR},
			</if>
			<if test="fundName != null and fundName != ''" >
				FUND_NAME = #{fundName,jdbcType=VARCHAR},
			</if>
			<if test="regName != null and regName != ''" >
				REG_NAME = #{regName,jdbcType=VARCHAR},
			</if>
			<if test="mcId != null and mcId != ''" >
				MC_ID = #{mcId,jdbcType=VARCHAR},
			</if>
			<if test="mcName != null and mcName != ''" >
				MC_NAME = #{mcName,jdbcType=VARCHAR},
			</if>
			<if test="gp != null and gp != ''" >
				GP = #{gp,jdbcType=VARCHAR},
			</if>
			<if test="contact != null and contact != ''" >
				CONTACT = #{contact,jdbcType=VARCHAR},
			</if>
			<if test="phoneNo != null and phoneNo != ''" >
				PHONE_NO = #{phoneNo,jdbcType=VARCHAR},
			</if>
			<if test="contactEmail != null and contactEmail != ''" >
				CONTACT_EMAIL = #{contactEmail,jdbcType=VARCHAR},
			</if>
			<if test="planAmount != null " >
				PLAN_AMOUNT = #{planAmount,jdbcType=NUMERIC},
			</if>
			<if test="planCurr != null and planCurr != ''" >
				PLAN_CURR = #{planCurr,jdbcType=VARCHAR},
			</if>
			<if test="raiseAmount != null " >
				RAISE_AMOUNT = #{raiseAmount,jdbcType=NUMERIC},
			</if>
			<if test="raiseCurrency != null and raiseCurrency != ''" >
				RAISE_CURRENCY = #{raiseCurrency,jdbcType=VARCHAR},
			</if>
			<if test="fundStruct != null and fundStruct != ''" >
				FUND_STRUCT = #{fundStruct,jdbcType=VARCHAR},
			</if>
			<if test="platProp != null and platProp != ''" >
				PLAT_PROP = #{platProp,jdbcType=VARCHAR},
			</if>
			<if test="subPlatProp != null and subPlatProp != ''" >
				SUB_PLAT_PROP = #{subPlatProp,jdbcType=VARCHAR},
			</if>
			<if test="setupDt != null" >
				SETUP_DT = #{setupDt,jdbcType=TIMESTAMP},
			</if>
			<if test="closeDt != null" >
				CLOSE_DT = #{closeDt,jdbcType=TIMESTAMP},
			</if>
			<if test="regAdd != null and regAdd != ''" >
				REG_ADD = #{regAdd,jdbcType=VARCHAR},
			</if>
			<if test="orgnCode != null and orgnCode != ''" >
				ORGN_CODE = #{orgnCode,jdbcType=VARCHAR},
			</if>
			<if test="legalPerson != null and legalPerson != ''" >
				LEGAL_PERSON = #{legalPerson,jdbcType=VARCHAR},
			</if>
			<if test="custodianBank != null and custodianBank != ''" >
				CUSTODIAN_BANK = #{custodianBank,jdbcType=VARCHAR},
			</if>
			<if test="regCapital != null " >
				REG_CAPITAL = #{regCapital,jdbcType=NUMERIC},
			</if>
			<if test="regCurrency != null and regCurrency != ''" >
				REG_CURRENCY = #{regCurrency,jdbcType=VARCHAR},
			</if>
			<if test="capitalAccount != null " >
				CAPITAL_ACCOUNT = #{capitalAccount,jdbcType=VARCHAR},
			</if>
			<if test="returnAccount != null and returnAccount != ''" >
				RETURN_ACCOUNT = #{returnAccount,jdbcType=VARCHAR},
			</if>
			<if test="fundSts != null and fundSts != ''" >
				FUND_STS = #{fundSts,jdbcType=VARCHAR},
			</if>
			<if test="descFile != null and descFile != ''" >
				DESC_FILE = #{descFile,jdbcType=VARCHAR},
			</if>
			<if test="fundSrc != null and fundSrc != ''" >
				FUND_SRC = #{fundSrc,jdbcType=VARCHAR},
			</if>
			<if test="updateBy != null and updateBy != ''" >
				UPDATE_BY = #{updateBy,jdbcType=VARCHAR},
			</if>
			<if test="updateDt != null" >
				UPDATE_DT = #{updateDt,jdbcType=TIMESTAMP},
			</if>
			<if test="fundGenre != null and fundGenre != ''" >
				FUND_GENRE = #{fundGenre,jdbcType=VARCHAR},
			</if>
			<if test="custodianBankaccount != null and custodianBankaccount != ''" >
				CUSTODIAN_BANKACCOUNT = #{custodianBankaccount,jdbcType=VARCHAR},
			</if>
			<if test="capitalBank != null and capitalBank != ''" >
				CAPITAL_BANK = #{capitalBank,jdbcType=VARCHAR},
			</if>
			<if test="returnBank != null and returnBank != ''" >
				RETURN_BANK = #{returnBank,jdbcType=VARCHAR},
			</if>
			<if test="partners != null and partners != ''" >
				PARTNERS = #{partners,jdbcType=VARCHAR},
			</if>
			<if test="groupId != null and groupId != ''" >
				GROUP_ID = #{groupId,jdbcType=NUMERIC},
			</if>
			<if test="gpId != null and gpId != ''" >
				GP_ID = #{gpId,jdbcType=VARCHAR},
			</if>
			<if test="rmbRaiseAmount != null " >
				RMB_RAISE_AMOUNT = #{rmbRaiseAmount,jdbcType=NUMERIC},
			</if>
			<if test="currentAmount != null " >
				CURRENT_AMOUNT = #{currentAmount,jdbcType=NUMERIC},
			</if>
			<if test="currentCurrency != null and currentCurrency != ''" >
				CURRENT_CURRENCY = #{currentCurrency,jdbcType=VARCHAR},
			</if>
			<if test="rmbCurrentAmount != null " >
				RMB_CURRENT_AMOUNT = #{rmbCurrentAmount,jdbcType=NUMERIC},
			</if>
			<if test="maintenanceId != null and maintenanceId != ''" >
				MAINTENANCE_ID = #{maintenanceId,jdbcType=VARCHAR},
			</if>
			<if test="maintenance != null and maintenance != ''" >
				MAINTENANCE = #{maintenance,jdbcType=VARCHAR},
			</if>
			<if test="socialCode != null and socialCode != ''" >
				SOCIAL_CODE = #{socialCode,jdbcType=VARCHAR},
			</if>
			<if test="keyPersonLock != null and keyPersonLock != ''" >
				KEY_PERSON_LOCK = #{keyPersonLock,jdbcType=VARCHAR},
			</if>
			<if test="ratioInGp != null and ratioInGp != ''" >
				RATIO_IN_GP = #{ratioInGp,jdbcType=NUMERIC},
			</if>
			<if test="rmbPlanAmount != null " >
				RMB_PLAN_AMOUNT = #{rmbPlanAmount,jdbcType=NUMERIC},
			</if>
			<if test="fundScope != null and fundScope != ''" >
				FUND_SCOPE = #{fundScope,jdbcType=VARCHAR},
			</if>
			<if test="yhRatioAsLp != null " >
				YH_RATIO_AS_LP = #{yhRatioAsLp,jdbcType=NUMERIC},
			</if>
			<if test="yhRatioInGp != null " >
				YH_RATIO_IN_GP = #{yhRatioInGp,jdbcType=NUMERIC},
			</if>
			<if test="yhRatioInMc != null " >
				YH_RATIO_IN_MC = #{yhRatioInMc,jdbcType=NUMERIC},
			</if>
			<if test="email != null and email != ''" >
				EMAIL = #{email,jdbcType=VARCHAR},
			</if>
			<if test="enteId != null and enteId != ''" >
				ENTE_ID = #{enteId,jdbcType=VARCHAR},
			</if>
			<if test="emailPassword != null and emailPassword != ''" >
				EMAIL_PASSWORD = #{emailPassword,jdbcType=VARCHAR},
			</if>
			<if test="financeId != null and financeId != ''" >
				FINANCE_ID = #{financeId,jdbcType=VARCHAR},
			</if>
			<if test="financeName != null and financeName != ''" >
				FINANCE_NAME = #{financeName,jdbcType=VARCHAR},
			</if>
			<if test="executivePartnerId != null and executivePartnerId != ''" >
				EXECUTIVE_PARTNER_ID = #{executivePartnerId,jdbcType=VARCHAR},
			</if>
			<if test="executivePartnerName != null and executivePartnerName != ''" >
				EXECUTIVE_PARTNER_NAME = #{executivePartnerName,jdbcType=VARCHAR},
			</if>
			<if test="isFit != null and isFit != ''" >
				IS_FIT = #{isFit,jdbcType=VARCHAR},
			</if>
			<if test="custodianOpenBank != null and custodianOpenBank != ''" >
				CUSTODIAN_OPEN_BANK = #{custodianOpenBank,jdbcType=VARCHAR},
			</if>
			<if test="custodianBankNum != null and custodianBankNum != ''" >
				CUSTODIAN_BANK_NUM = #{custodianBankNum,jdbcType=VARCHAR},
			</if>
			<if test="isRecord != null" >
				IS_RECORD = #{isRecord,jdbcType=VARCHAR},
			</if>
			<if test="recordCode != null and recordCode != ''" >
				RECORD_CODE = #{recordCode,jdbcType=VARCHAR},
			</if>
			<if test="recordDate != null" >
				RECORD_DATE = #{recordDate,jdbcType=TIMESTAMP},
			</if>
			<if test="recordAtta != null and recordAtta != ''" >
				RECORD_ATTA = #{recordAtta,jdbcType=VARCHAR},
			</if>
			<if test="isCustodian!= null and isCustodian!= ''" >
				 IS_CUSTODIAN = #{isCustodian,jdbcType=VARCHAR},
			</if>
			<if test="custodianAtta != null and custodianAtta != ''" >
				CUSTODIAN_ATTA = #{custodianAtta,jdbcType=VARCHAR},
			</if>
			<if test="isAuth != null and isAuth != ''" >
				  IS_AUTH = #{isAuth,jdbcType=VARCHAR},
			</if>
			<if test="authAtta != null and authAtta != ''" >
				  AUTH_ATTA = #{authAtta,jdbcType=VARCHAR},
			</if>
			<if test="promiseAmount != null " >
				 PROMISE_AMOUNT = #{promiseAmount,jdbcType=NUMERIC},
			</if>
			<if test="profitAmount != null " >
				  PROFIT_AMOUNT = #{profitAmount,jdbcType=NUMERIC},
			</if>
			<if test="status != null and status != ''" >
				 STATUS = #{status,jdbcType=VARCHAR},
			</if>
			<if test="inveCurrentAmount != null " >
				  INVE_CURRENT_AMOUNT = #{inveCurrentAmount,jdbcType=NUMERIC},
			</if>
			<if test="spvType != null and spvType != ''" >
				  SPV_TYPE = #{spvType,jdbcType=VARCHAR},
			</if>
			<if test="isExcept != null and isExcept != ''" >
				  IS_EXCEPT = #{isExcept,jdbcType=VARCHAR},
			</if>
			<if test="inveRaiseAmount != null" >
				 INVE_RAISE_AMOUNT = #{inveRaiseAmount,jdbcType=NUMERIC},
			</if>
			<if test="isLead != null and isLead != ''" >
				  IS_LEAD = #{isLead,jdbcType=VARCHAR},
			</if>
			<if test="isExit != null and isExit != ''" >
				  IS_EXIT = #{isExit,jdbcType=VARCHAR},
			</if>
			<if test="financeAmount != null" >
				  FINANCE_AMOUNT = #{financeAmount,jdbcType=NUMERIC},
			</if>
			<if test="inveType != null and inveType != ''" >
				  INVE_TYPE = #{inveType,jdbcType=VARCHAR},
			</if>
			<if test="appDep != null and appDep != ''" >
				  APP_DEP = #{appDep,jdbcType=VARCHAR},
			</if>
			<if test="govFundSrc != null and govFundSrc != ''" >
				  GOV_FUND_SRC = #{govFundSrc,jdbcType=VARCHAR},
			</if>
			<if test="basis != null and basis != ''" >
				  BASIS = #{basis,jdbcType=VARCHAR},
			</if>
			<if test="inveLimit != null and inveLimit != ''" >
				  INVE_LIMIT = #{inveLimit,jdbcType=VARCHAR},
			</if>
			<if test="manDep != null and manDep != ''" >
				  MAN_DEP = #{manDep,jdbcType=VARCHAR},
			</if>
			<if test="shortName != null and shortName != ''" >
				  SHORT_NAME = #{shortName,jdbcType=VARCHAR},
			</if>
			<if test="fundsType != null and fundsType != ''" >
				  FUNDS_TYPE = #{fundsType,jdbcType=VARCHAR},
			</if>
			<if test="parentId != null" >
				  PARENT_ID = #{parentId,jdbcType=VARCHAR},
			</if>
			<if test="fundCategory != null and fundCategory != ''" >
				  FUNDCATEGORY = #{fundCategory,jdbcType=VARCHAR},
			</if>
			<if test="oldSubPlatProp != null and oldSubPlatProp != ''" >
				  OLD_SUB_PLAT_PROP = #{oldSubPlatProp,jdbcType=VARCHAR},
			</if>
			<if test="isDirect != null and isDirect != ''" >
				  ISDIRECT = #{isDirect,jdbcType=VARCHAR},
			</if>
			<if test="isDesignate != null and isDesignate != ''" >
				  IS_DESIGNATE = #{isDesignate,jdbcType=VARCHAR},
			</if>
			<if test="fundCodeSign != null and fundCodeSign != ''" >
				  FUND_CODE_SIGN = #{fundCodeSign,jdbcType=VARCHAR},
			</if>
			<if test="registerStatus != null and registerStatus != ''" >
				REGISTER_STATUS = #{registerStatus,jdbcType=VARCHAR},
			</if>
			<if test="oldFundGenre != null and oldFundGenre != ''" >
				OLD_FUND_GENRE = #{oldFundGenre,jdbcType=VARCHAR},
			</if>
			<if test="fundCodeType != null and fundCodeType != ''" >
				FUND_CODE_TYPE = #{fundCodeType,jdbcType=VARCHAR},
			</if>
			<if test="fundLead != null and fundLead != ''" >
				FUND_LEAD = #{fundLead,jdbcType=VARCHAR},
			</if>

			<if test="fundLeadId != null and fundLeadId != ''" >
				FUND_LEAD_ID = #{fundLeadId,jdbcType=VARCHAR},
			</if>

			<if test="motherFundName != null and motherFundName != ''" >
				MOTHER_FUND_NAME = #{motherFundName,jdbcType=VARCHAR},
			</if>

			<if test="motherFundId != null and motherFundId != ''" >
				MOTHER_FUND_ID = #{motherFundId,jdbcType=VARCHAR},
			</if>
			<if test="repId != null and repId != ''" >
				REP_ID = #{repId,jdbcType=VARCHAR},
			</if>

			<if test="repName != null and repName != ''" >
				REP_NAME = #{repName,jdbcType=VARCHAR},
			</if>
			<if test="organStruct != null and organStruct != ''" >
				ORGAN_STRUCT = #{organStruct,jdbcType=VARCHAR},
			</if>
			<if test="otherFile != null and otherFile != ''" >
				OTHER_FILE = #{otherFile,jdbcType=VARCHAR},
			</if>
		</set>
		WHERE FUND_ID = #{fundId,jdbcType=VARCHAR}
	</update>

	<select id="selectById" parameterType="String" resultMap="FundInfoResult2">
		SELECT  F.*,
				CASE WHEN F.RMB_RAISE_AMOUNT != 0 AND F.RMB_CURRENT_AMOUNT != 0
              	THEN   RTrim(to_char(NVL(F.RMB_RAISE_AMOUNT / F.RMB_CURRENT_AMOUNT, 0)*100, 'FM99999999990.99'), '.') || '%'
                ELSE '' END as RAISE_CURRENT,
				RTrim(to_char(NVL(F.RMB_PLAN_AMOUNT, 0) / 100000000, 'FM99999999990.99'), '.') as PLAN_AMOUNT_DISPLAY,
				RTrim(to_char(NVL(F.RMB_CURRENT_AMOUNT, 0) / 100000000, 'FM99999999990.99'), '.') as CURRENT_AMOUNT_DISPLAY,
				RTrim(to_char(NVL(F.RMB_RAISE_AMOUNT, 0) / 100000000, 'FM99999999990.99'), '.')  as RAISE_AMOUNT_DISPLAY
		FROM BD_T_FUND_INFO F WHERE FUND_ID = #{fundId,jdbcType=VARCHAR}
	</select>

	<select id="selectBy" parameterType="com.ppmg.ei.model.FundInfoModel" resultMap="FundInfoResult">
		SELECT * FROM BD_T_FUND_INFO
		<where>
			<if test="fundId != null and fundId != ''" >
				FUND_ID = #{fundId,jdbcType=VARCHAR}
			</if>
			<if test="fundCode != null and fundCode != ''" >
				AND FUND_CODE = #{fundCode,jdbcType=VARCHAR}
			</if>
			<if test="fundName != null and fundName != ''" >
				AND FUND_NAME = #{fundName,jdbcType=VARCHAR}
			</if>
			<if test="regName != null and regName != ''" >
				AND REG_NAME = #{regName,jdbcType=VARCHAR}
			</if>
			<if test="mcId != null and mcId != ''" >
				AND MC_ID = #{mcId,jdbcType=VARCHAR}
			</if>
			<if test="mcName != null and mcName != ''" >
				AND MC_NAME = #{mcName,jdbcType=VARCHAR}
			</if>
			<if test="gp != null and gp != ''" >
				AND GP = #{gp,jdbcType=VARCHAR}
			</if>
			<if test="contact != null and contact != ''" >
				AND CONTACT = #{contact,jdbcType=VARCHAR}
			</if>
			<if test="phoneNo != null and phoneNo != ''" >
				AND PHONE_NO = #{phoneNo,jdbcType=VARCHAR}
			</if>
	  	    <if test="contactEmail != null and contactEmail != ''" >
				AND CONTACT_EMAIL = #{contactEmail,jdbcType=VARCHAR}
			</if>
			<if test="planAmount != null and planAmount != ''" >
				AND PLAN_AMOUNT = #{planAmount,jdbcType=NUMERIC}
			</if>
			<if test="planCurr != null and planCurr != ''" >
				AND PLAN_CURR = #{planCurr,jdbcType=VARCHAR}
			</if>
			<if test="raiseAmount != null and raiseAmount != ''" >
				AND RAISE_AMOUNT = #{raiseAmount,jdbcType=NUMERIC}
			</if>
			<if test="raiseCurrency != null and raiseCurrency != ''" >
				AND RAISE_CURRENCY = #{raiseCurrency,jdbcType=VARCHAR}
			</if>
			<if test="fundStruct != null and fundStruct != ''" >
				AND FUND_STRUCT = #{fundStruct,jdbcType=VARCHAR}
			</if>
			<if test="platProp != null and platProp != ''" >
				AND PLAT_PROP = #{platProp,jdbcType=VARCHAR}
			</if>
			<if test="subPlatProp != null and subPlatProp != ''" >
				AND SUB_PLAT_PROP = #{subPlatProp,jdbcType=VARCHAR}
			</if>
			<if test="setupDt != null" >
				AND SETUP_DT = #{setupDt,jdbcType=VARCHAR}
			</if>
			<if test="closeDt != null" >
				AND CLOSE_DT = #{closeDt,jdbcType=VARCHAR}
			</if>
			<if test="regAdd != null and regAdd != ''" >
				AND REG_ADD = #{regAdd,jdbcType=VARCHAR}
			</if>
			<if test="orgnCode != null and orgnCode != ''" >
				AND ORGN_CODE = #{orgnCode,jdbcType=VARCHAR}
			</if>
			<if test="legalPerson != null and legalPerson != ''" >
				AND LEGAL_PERSON = #{legalPerson,jdbcType=VARCHAR}
			</if>
			<if test="custodianBank != null and custodianBank != ''" >
				AND CUSTODIAN_BANK = #{custodianBank,jdbcType=VARCHAR}
			</if>
			<if test="regCapital != null and regCapital != ''" >
				AND REG_CAPITAL = #{regCapital,jdbcType=NUMERIC}
			</if>
			<if test="regCurrency != null and regCurrency != ''" >
				AND REG_CURRENCY = #{regCurrency,jdbcType=VARCHAR}
			</if>
			<if test="capitalAccount != null and capitalAccount != ''" >
				AND CAPITAL_ACCOUNT = #{capitalAccount,jdbcType=VARCHAR}
			</if>
			<if test="returnAccount != null and returnAccount != ''" >
				AND RETURN_ACCOUNT = #{returnAccount,jdbcType=VARCHAR}
			</if>
			<if test="fundSts != null and fundSts != ''" >
				AND FUND_STS = #{fundSts,jdbcType=VARCHAR}
			</if>
			<if test="descFile != null and descFile != ''" >
				AND DESC_FILE = #{descFile,jdbcType=VARCHAR}
			</if>
			<if test="fundSrc != null and fundSrc != ''" >
				AND FUND_SRC = #{fundSrc,jdbcType=VARCHAR}
			</if>
			<if test="createBy != null and createBy != ''" >
				AND CREATE_BY = #{createBy,jdbcType=VARCHAR}
			</if>
			<if test="createDt != null" >
				AND CREATE_DT = #{createDt,jdbcType=VARCHAR}
			</if>
			<if test="updateBy != null and updateBy != ''" >
				AND UPDATE_BY = #{updateBy,jdbcType=VARCHAR}
			</if>
			<if test="updateDt != null" >
				AND UPDATE_DT = #{updateDt,jdbcType=VARCHAR}
			</if>
			<if test="fundGenre != null and fundGenre != ''" >
				AND FUND_GENRE = #{fundGenre,jdbcType=VARCHAR}
			</if>
			<if test="custodianBankaccount != null and custodianBankaccount != ''" >
				AND CUSTODIAN_BANKACCOUNT = #{custodianBankaccount,jdbcType=VARCHAR}
			</if>
			<if test="capitalBank != null and capitalBank != ''" >
				AND CAPITAL_BANK = #{capitalBank,jdbcType=VARCHAR}
			</if>
			<if test="returnBank != null and returnBank != ''" >
				AND RETURN_BANK = #{returnBank,jdbcType=VARCHAR}
			</if>
			<if test="partners != null and partners != ''" >
				AND PARTNERS = #{partners,jdbcType=VARCHAR}
			</if>
			<if test="groupId != null and groupId != ''" >
				AND GROUP_ID = #{groupId,jdbcType=NUMERIC}
			</if>
			<if test="gpId != null and gpId != ''" >
				AND GP_ID = #{gpId,jdbcType=VARCHAR}
			</if>
			<if test="rmbRaiseAmount != null and rmbRaiseAmount != ''" >
				AND RMB_RAISE_AMOUNT = #{rmbRaiseAmount,jdbcType=NUMERIC}
			</if>
			<if test="currentAmount != null and currentAmount != ''" >
				AND CURRENT_AMOUNT = #{currentAmount,jdbcType=NUMERIC}
			</if>
			<if test="currentCurrency != null and currentCurrency != ''" >
				AND CURRENT_CURRENCY = #{currentCurrency,jdbcType=VARCHAR}
			</if>
			<if test="rmbCurrentAmount != null and rmbCurrentAmount != ''" >
				AND RMB_CURRENT_AMOUNT = #{rmbCurrentAmount,jdbcType=NUMERIC}
			</if>
			<if test="maintenanceId != null and maintenanceId != ''" >
				AND MAINTENANCE_ID = #{maintenanceId,jdbcType=VARCHAR}
			</if>
			<if test="maintenance != null and maintenance != ''" >
				AND MAINTENANCE = #{maintenance,jdbcType=VARCHAR}
			</if>
			<if test="socialCode != null and socialCode != ''" >
				AND SOCIAL_CODE = #{socialCode,jdbcType=VARCHAR}
			</if>
			<if test="keyPersonLock != null and keyPersonLock != ''" >
				AND KEY_PERSON_LOCK = #{keyPersonLock,jdbcType=VARCHAR}
			</if>
			<if test="ratioInGp != null and ratioInGp != ''" >
				AND RATIO_IN_GP = #{ratioInGp,jdbcType=NUMERIC}
			</if>
			<if test="rmbPlanAmount != null and rmbPlanAmount != ''" >
				AND RMB_PLAN_AMOUNT = #{rmbPlanAmount,jdbcType=NUMERIC}
			</if>
			<if test="fundScope != null and fundScope != ''" >
				AND FUND_SCOPE = #{fundScope,jdbcType=VARCHAR}
			</if>
			<if test="yhRatioAsLp != null and yhRatioAsLp != ''" >
				AND YH_RATIO_AS_LP = #{yhRatioAsLp,jdbcType=NUMERIC}
			</if>
			<if test="yhRatioInGp != null and yhRatioInGp != ''" >
				AND YH_RATIO_IN_GP = #{yhRatioInGp,jdbcType=NUMERIC}
			</if>
			<if test="yhRatioInMc != null and yhRatioInMc != ''" >
				AND YH_RATIO_IN_MC = #{yhRatioInMc,jdbcType=NUMERIC}
			</if>
			<if test="email != null and email != ''" >
				AND EMAIL = #{email,jdbcType=VARCHAR}
			</if>
			<if test="enteId != null and enteId != ''" >
				AND ENTE_ID = #{enteId,jdbcType=VARCHAR}
			</if>
			<if test="emailPassword != null and emailPassword != ''" >
				AND EMAIL_PASSWORD = #{emailPassword,jdbcType=VARCHAR}
			</if>
			<if test="financeId != null and financeId != ''" >
				AND FINANCE_ID = #{financeId,jdbcType=VARCHAR}
			</if>
			<if test="financeName != null and financeName != ''" >
				AND FINANCE_NAME = #{financeName,jdbcType=VARCHAR}
			</if>
			<if test="executivePartnerId != null and executivePartnerId != ''" >
				AND EXECUTIVE_PARTNER_ID = #{executivePartnerId,jdbcType=VARCHAR}
			</if>
			<if test="executivePartnerName != null and executivePartnerName != ''" >
				AND EXECUTIVE_PARTNER_NAME = #{executivePartnerName,jdbcType=VARCHAR}
			</if>
			<if test="isFit != null and isFit != ''" >
				AND IS_FIT = #{isFit,jdbcType=VARCHAR}
			</if>
			<if test="custodianOpenBank != null and custodianOpenBank != ''" >
				AND CUSTODIAN_OPEN_BANK = #{custodianOpenBank,jdbcType=VARCHAR}
			</if>
			<if test="custodianBankNum != null and custodianBankNum != ''" >
				AND CUSTODIAN_BANK_NUM = #{custodianBankNum,jdbcType=VARCHAR}
			</if>
			<if test="isRecord != null and isRecord != ''" >
				AND IS_RECORD = #{isRecord,jdbcType=VARCHAR}
			</if>
			<if test="recordCode != null and recordCode != ''" >
				AND RECORD_CODE = #{recordCode,jdbcType=VARCHAR}
			</if>
			<if test="recordDate != null" >
				AND RECORD_DATE = #{recordDate,jdbcType=VARCHAR}
			</if>
			<if test="recordAtta != null and recordAtta != ''" >
				AND RECORD_ATTA = #{recordAtta,jdbcType=VARCHAR}
			</if>
			<if test="isCustodian != null and isCustodian != ''" >
				AND IS_CUSTODIAN = #{isCustodian,jdbcType=VARCHAR}
			</if>
			<if test="custodianAtta != null and custodianAtta != ''" >
				AND CUSTODIAN_ATTA = #{custodianAtta,jdbcType=VARCHAR}
			</if>
			<if test="isAuth != null and isAuth != ''" >
				AND  IS_AUTH = #{isAuth,jdbcType=VARCHAR}
			</if>
			<if test="authAtta != null and authAtta != ''" >
				AND  AUTH_ATTA = #{authAtta,jdbcType=VARCHAR}
			</if>
			<if test="promiseAmount != null and promiseAmount != ''" >
				AND PROMISE_AMOUNT = #{promiseAmount,jdbcType=NUMERIC}
			</if>
			<if test="profitAmount != null and profitAmount != ''" >
				AND  PROFIT_AMOUNT = #{profitAmount,jdbcType=NUMERIC}
			</if>
			<if test="status != null and status != ''" >
				AND  STATUS = #{status,jdbcType=VARCHAR}
			</if>
			<if test="inveCurrentAmount != null and inveCurrentAmount != ''" >
				AND  INVE_CURRENT_AMOUNT = #{inveCurrentAmount,jdbcType=NUMERIC}
			</if>
			<if test="inveCurrentAmount != null and inveCurrentAmount != ''" >
				AND  INVE_CURRENT_AMOUNT = #{inveCurrentAmount,jdbcType=NUMERIC}
			</if>
			<if test="spvType != null and spvType != ''" >
				AND  SPV_TYPE = #{spvType,jdbcType=VARCHAR}
			</if>
			<if test="isExcept != null and isExcept != ''" >
				AND  IS_EXCEPT = #{isExcept,jdbcType=VARCHAR}
			</if>
			<if test="inveRaiseAmount != null" >
				AND INVE_RAISE_AMOUNT = #{inveRaiseAmount,jdbcType=NUMERIC}
			</if>
			<if test="isLead != null and isLead != ''" >
				AND  IS_LEAD = #{isLead,jdbcType=VARCHAR}
			</if>
			<if test="isExit != null and isExit != ''" >
				AND  IS_EXIT = #{isExit,jdbcType=VARCHAR}
			</if>
			<if test="financeAmount != null" >
				AND FINANCE_AMOUNT = #{financeAmount,jdbcType=NUMERIC}
			</if>
			<if test="inveType != null and inveType != ''" >
				AND  INVE_TYPE = #{inveType,jdbcType=VARCHAR}
			</if>
			<if test="appDep != null and appDep != ''" >
				AND  APP_DEP = #{appDep,jdbcType=VARCHAR}
			</if>
			<if test="govFundSrc != null and govFundSrc != ''" >
				AND  GOV_FUND_SRC = #{govFundSrc,jdbcType=VARCHAR}
			</if>
			<if test="basis != null and basis != ''" >
				AND  BASIS = #{basis,jdbcType=VARCHAR}
			</if>
			<if test="inveLimit != null and inveLimit != ''" >
				AND  INVE_LIMIT = #{inveLimit,jdbcType=VARCHAR}
			</if>
			<if test="manDep != null and manDep != ''" >
				AND  MAN_DEP = #{manDep,jdbcType=VARCHAR}
			</if>
			<if test="shortName != null and shortName != ''" >
				AND  SHORT_NAME = #{shortName,jdbcType=VARCHAR}
			</if>
			<if test="fundsType != null " >
				AND  FUNDS_TYPE = #{fundsType,jdbcType=VARCHAR}
			</if>
			<if test="parentId != null and parentId != ''" >
				AND  PARENT_ID = #{parentId,jdbcType=VARCHAR}
			</if>
			<if test="fundCategory != null and fundCategory != ''" >
				AND  FUNDCATEGORY = #{fundCategory,jdbcType=VARCHAR}
			</if>
			<if test="oldSubPlatProp != null and oldSubPlatProp != ''" >
				AND  OLD_SUB_PLAT_PROP = #{oldSubPlatProp,jdbcType=VARCHAR}
			</if>
			<if test="isDirect != null and isDirect != ''" >
				AND  ISDIRECT = #{isDirect,jdbcType=VARCHAR}
			</if>
			<if test="isDesignate != null and isDesignate != ''" >
				AND  IS_DESIGNATE = #{isDesignate,jdbcType=VARCHAR}
			</if>
			<if test="fundCodeSign != null and fundCodeSign != ''" >
				AND  FUND_CODE_SIGN = #{fundCodeSign,jdbcType=VARCHAR}
			</if>
		</where>
	</select>

	<sql id="searchSql">
		select bb.*,dd.ACTUAL_AMOUNT ,
        CASE WHEN ccc.RAISE_AMOUNT != 0 AND bb.RAISE_AMOUNT != 0
        THEN   RTrim(to_char(NVL(ccc.RAISE_AMOUNT / bb.RAISE_AMOUNT, 0)*100, 'FM99999999990.99'), '.') || '%'
        ELSE '0%' END as RAISE_CURRENT,
        CASE WHEN ccc.INVE_AMOUNT != 0 AND bb.CURRENT_AMOUNT != 0
        THEN   RTrim(to_char(NVL(ccc.INVE_AMOUNT / bb.CURRENT_AMOUNT, 0)*100, 'FM99999999990.99'), '.') || '%'
        ELSE '0%' END as bjjPer
		from (SELECT F.*,
		RTrim(to_char(NVL(F.RMB_PLAN_AMOUNT, 0) / 100000000, 'FM99999999990.99'), '.') as PLAN_AMOUNT_DISPLAY,
		RTrim(to_char(NVL(F.RMB_CURRENT_AMOUNT, 0) / 100000000, 'FM99999999990.99'), '.') as CURRENT_AMOUNT_DISPLAY,
		RTrim(to_char(NVL(F.RMB_RAISE_AMOUNT, 0) / 100000000, 'FM99999999990.99'), '.')  as RAISE_AMOUNT_DISPLAY,
		(SELECT  COUNT(1) FROM TZ_T_PROJ_INFO P WHERE P.INVE_ID=F.FUND_ID and p.proj_type='1' AND P.PROJ_STATUS  not IN ('1', '9', '10', '11','2','3','4','6') and p.status!='2') PROJ_NUM,
		(SELECT RTrim(to_char(NVL(SUM(sign_amount_rmb), 0) / 10000,
		'FM99999999990.99'),
		'.')
		FROM (select t1.inve_id, sum(t2.sign_amount_rmb)  as sign_amount_rmb
		from tz_t_proj_info t1
		inner join tz_t_proj_contract_file t2
		on t2.proj_id = t1.proj_id
		inner join (select x.proj_id,
		max(x.sign_dt) as max_sign_dt,
		max(x.create_dt) as max_create_dt
		from tz_t_proj_contract_file x
		where x.file_type = '1'
		and x.status = '3'
		and x.sign_dt is not null
		group by x.proj_id) t3
		on t3.proj_id = t2.proj_id
		and t3.max_sign_dt = t2.sign_dt
		and t3.max_create_dt = t2.create_dt
		where t1.proj_status != '7'
		group by t1.inve_id) M
		WHERE  M.INVE_ID=F.FUND_ID) AS INVEST_AMOUNT
		FROM BD_T_FUND_INFO F)bb
		left join
		(select SUM(g.ACTUAL_AMOUNT) as ACTUAL_AMOUNT,FUND_ID from   BD_T_FUND_INFO F inner join TZ_T_PROJ_INFO P on P.INVE_ID=F.FUND_ID
		AND P.STATUS!='2'
		inner join TZ_T_PROJ_APP_INFO g on  g.PROJ_ID=p.PROJ_ID group by F.FUND_ID)dd on dd.FUND_ID=bb.FUND_ID
        left join RZ_T_FUND_SHARE_INFO ccc on ccc.fund_id=bb.fund_id and ccc.ENTE_ID='0'
		<where>
			<include refid="searchCondition.searchClause" />

		<if test='paramMap.GROUP_ID != null and paramMap.GROUP_ID != ""' >
			and (bb.GROUP_ID= #{paramMap.GROUP_ID})
		</if>
		<if test='paramMap.PLAT_PROP != null and paramMap.PLAT_PROP != ""' >
			and bb.PLAT_PROP IN (${paramMap.PLAT_PROP})
		</if>
		<if test='paramMap.FUND_STRUCT != null and paramMap.FUND_STRUCT != ""' >
			and bb.FUND_STRUCT IN (${paramMap.FUND_STRUCT})
		</if>
		<if test='paramMap.FUND_STS != null and paramMap.FUND_STS != ""' >
			and bb.FUND_STS IN (${paramMap.FUND_STS})
		</if>
        <if test='paramMap.keyWord != null and paramMap.keyWord != ""' >
            and (bb.FUND_NAME like ${paramMap.keyWord} or bb.REG_NAME like ${paramMap.keyWord})
        </if>
		<if test='paramMap.ledgeMagType=="1"' >
			and bb.fund_src in(0,1)
		</if>
		<if test='paramMap.USER_ID != null and paramMap.USER_ID != ""' >
			and bb.FUND_ID IN (select FUND_ID from BD_T_FUND_USER_RELATE FU
			WHERE FU.USER_ID=#{paramMap.USER_ID})
		</if>
		</where>
		ORDER BY bb.UPDATE_DT DESC
	</sql>

	<select id="selectListPage" resultMap="FundInfoResult2" parameterType="com.founder.ssm.core.common.SearchCondition">
	 <include refid="searchSql" />
     </select>


	<resultMap id="InfoResult" type="com.ppmg.ei.model.FundResultModel">
		<result column="FUND_ID" property="fundId" jdbcType="VARCHAR" />
		<result column="FUND_CODE" property="fundCode" jdbcType="VARCHAR" />
		<result column="FUND_NAME" property="fundName" jdbcType="VARCHAR" />
		<result column="REG_NAME" property="regName" jdbcType="VARCHAR" />
		<result column="MC_ID" property="mcId" jdbcType="VARCHAR" />
		<result column="MC_NAME" property="mcName" jdbcType="VARCHAR" />
		<result column="GP" property="gp" jdbcType="VARCHAR" />
		<result column="CONTACT" property="contact" jdbcType="VARCHAR" />
		<result column="PHONE_NO" property="phoneNo" jdbcType="VARCHAR" />
		<result column="CONTACT_EMAIL" property="contactEmail" jdbcType="VARCHAR" />
		<result column="PLAN_AMOUNT" property="planAmount" jdbcType="NUMERIC" />
		<result column="PLAN_CURR" property="planCurr" jdbcType="VARCHAR" />
		<result column="RAISE_AMOUNT" property="raiseAmount" jdbcType="NUMERIC" />
		<result column="RAISE_CURRENCY" property="raiseCurrency" jdbcType="VARCHAR" />
		<result column="FUND_STRUCT" property="fundStruct" jdbcType="VARCHAR" />
		<result column="PLAT_PROP" property="platProp" jdbcType="VARCHAR" />
		<result column="SUB_PLAT_PROP" property="subPlatProp" jdbcType="VARCHAR" />
		<result column="SETUP_DT" property="setupDt" jdbcType="TIMESTAMP" />
		<result column="CLOSE_DT" property="closeDt" jdbcType="TIMESTAMP" />
		<result column="REG_ADD" property="regAdd" jdbcType="VARCHAR" />
		<result column="ORGN_CODE" property="orgnCode" jdbcType="VARCHAR" />
		<result column="LEGAL_PERSON" property="legalPerson" jdbcType="VARCHAR" />
		<result column="CUSTODIAN_BANK" property="custodianBank" jdbcType="VARCHAR" />
		<result column="REG_CAPITAL" property="regCapital" jdbcType="NUMERIC" />
		<result column="REG_CURRENCY" property="regCurrency" jdbcType="VARCHAR" />
		<result column="CAPITAL_ACCOUNT" property="capitalAccount" jdbcType="VARCHAR" />
		<result column="RETURN_ACCOUNT" property="returnAccount" jdbcType="VARCHAR" />
		<result column="FUND_STS" property="fundSts" jdbcType="VARCHAR" />
		<result column="DESC_FILE" property="descFile" jdbcType="VARCHAR" />
		<result column="FUND_SRC" property="fundSrc" jdbcType="VARCHAR" />
		<result column="CREATE_BY" property="createBy" jdbcType="VARCHAR" />
		<result column="CREATE_DT" property="createDt" jdbcType="TIMESTAMP" />
		<result column="UPDATE_BY" property="updateBy" jdbcType="VARCHAR" />
		<result column="UPDATE_DT" property="updateDt" jdbcType="TIMESTAMP" />
		<result column="FUND_GENRE" property="fundGenre" jdbcType="VARCHAR" />
		<result column="CUSTODIAN_BANKACCOUNT" property="custodianBankaccount" jdbcType="VARCHAR" />
		<result column="CAPITAL_BANK" property="capitalBank" jdbcType="VARCHAR" />
		<result column="RETURN_BANK" property="returnBank" jdbcType="VARCHAR" />
		<result column="PARTNERS" property="partners" jdbcType="VARCHAR" />
		<result column="GROUP_ID" property="groupId" jdbcType="NUMERIC" />
		<result column="GP_ID" property="gpId" jdbcType="VARCHAR" />
		<result column="RMB_RAISE_AMOUNT" property="rmbRaiseAmount" jdbcType="NUMERIC" />
		<result column="CURRENT_AMOUNT" property="currentAmount" jdbcType="NUMERIC" />
		<result column="CURRENT_CURRENCY" property="currentCurrency" jdbcType="VARCHAR" />
		<result column="RMB_CURRENT_AMOUNT" property="rmbCurrentAmount" jdbcType="NUMERIC" />
		<result column="MAINTENANCE_ID" property="maintenanceId" jdbcType="VARCHAR" />
		<result column="MAINTENANCE" property="maintenance" jdbcType="VARCHAR" />
		<result column="SOCIAL_CODE" property="socialCode" jdbcType="VARCHAR" />
		<result column="KEY_PERSON_LOCK" property="keyPersonLock" jdbcType="VARCHAR" />
		<result column="RATIO_IN_GP" property="ratioInGp" jdbcType="NUMERIC" />
		<result column="RMB_PLAN_AMOUNT" property="rmbPlanAmount" jdbcType="NUMERIC" />
		<result column="FUND_SCOPE" property="fundScope" jdbcType="VARCHAR" />
		<result column="YH_RATIO_AS_LP" property="yhRatioAsLp" jdbcType="NUMERIC" />
		<result column="YH_RATIO_IN_GP" property="yhRatioInGp" jdbcType="NUMERIC" />
		<result column="YH_RATIO_IN_MC" property="yhRatioInMc" jdbcType="NUMERIC" />
		<result column="EMAIL" property="email" jdbcType="VARCHAR" />
		<result column="ENTE_ID" property="enteId" jdbcType="VARCHAR" />
		<result column="PERCENT" property="perCent" jdbcType="VARCHAR" />
		<result column="EMAIL_PASSWORD" property="emailPassword" jdbcType="VARCHAR" />
		<result column="FINANCE_ID" property="financeId" jdbcType="VARCHAR" />
		<result column="FINANCE_NAME" property="financeName" jdbcType="VARCHAR" />
		<result column="EXECUTIVE_PARTNER_ID" property="executivePartnerId" jdbcType="VARCHAR" />
		<result column="EXECUTIVE_PARTNER_NAME" property="executivePartnerName" jdbcType="VARCHAR" />
		<result column="IS_FIT" property="isFit" jdbcType="VARCHAR" />
		<result column="CUSTODIAN_OPEN_BANK" property="custodianOpenBank" jdbcType="VARCHAR" />
		<result column="CUSTODIAN_BANK_NUM" property="custodianBankNum" jdbcType="VARCHAR" />
		<result column="IS_RECORD" property="isRecord" jdbcType="VARCHAR" />
		<result column="RECORD_CODE" property="recordCode" jdbcType="VARCHAR" />
		<result column="RECORD_DATE" property="recordDate" jdbcType="TIMESTAMP" />
		<result column="RECORD_ATTA" property="recordAtta" jdbcType="VARCHAR" />
		<result column="IS_CUSTODIAN" property="isCustodian" jdbcType="VARCHAR" />
		<result column="CUSTODIAN_ATTA" property="custodianAtta" jdbcType="VARCHAR" />
		<result column="IS_AUTH" property="isAuth" jdbcType="VARCHAR" />
		<result column="AUTH_ATTA" property="authAtta" jdbcType="VARCHAR" />
		<result column="PROMISE_AMOUNT" property="promiseAmount" jdbcType="NUMERIC" />
		<result column="PROFIT_AMOUNT" property="profitAmount" jdbcType="NUMERIC" />
		<result column="STATUS" property="status" jdbcType="VARCHAR" />
		<result column="INVE_CURRENT_AMOUNT" property="inveCurrentAmount" jdbcType="NUMERIC" />
		<result column="SPV_TYPE" property="spvType" jdbcType="VARCHAR" />
		<result column="REGISTER_CODE" property="registerCode" jdbcType="VARCHAR" />
		<result column="RECORD_CODE" property="recordCode" jdbcType="VARCHAR" />
		<result column="RECORD_DATE" property="recordDate" jdbcType="TIMESTAMP" />
		<result column="ADDRESS_DETAILS" property="addressDetails" jdbcType="VARCHAR" />
		<result column="IS_EXCEPT" property="isExcept" jdbcType="VARCHAR" />
		<result column="INVE_RAISE_AMOUNT" property="inveRaiseAmount" jdbcType="NUMERIC" />
		<result column="IS_LEAD" property="isLead" jdbcType="VARCHAR" />
		<result column="IS_EXIT" property="isExit" jdbcType="VARCHAR" />
		<result column="FINANCE_AMOUNT" property="financeAmount" jdbcType="VARCHAR" />
		<result column="INVE_TYPE" property="inveType" jdbcType="VARCHAR" />
		<result column="APP_DEP" property="appDep" jdbcType="VARCHAR" />
		<result column="GOV_FUND_SRC" property="govFundSrc" jdbcType="VARCHAR" />
		<result column="BASIS" property="basis" jdbcType="VARCHAR" />
		<result column="INVE_LIMIT" property="inveLimit" jdbcType="VARCHAR" />
		<result column="MAN_DEP" property="manDep" jdbcType="VARCHAR" />
		<result column="SHORT_NAME" property="shortName" jdbcType="VARCHAR" />
		<result column="FUNDS_TYPE" property="fundsType" jdbcType="VARCHAR" />
		<result column="PARENT_ID" property="parentId" jdbcType="VARCHAR" />
		<result column="FUNDCATEGORY" property="fundCategory" jdbcType="VARCHAR" />
		<result column="OLD_SUB_PLAT_PROP" property="oldSubPlatProp" jdbcType="VARCHAR" />
		<result column="ISDIRECT" property="isDirect" jdbcType="VARCHAR" />
		<result column="IS_DESIGNATE" property="isDesignate" jdbcType="VARCHAR" />
		<result column="FUND_CODE_SIGN" property="fundCodeSign" jdbcType="VARCHAR" />
		<result column="CREDIT_CODE" property="creditCode" jdbcType="VARCHAR" />
		<result column="REGISTER_STATUS" property="registerStatus" jdbcType="VARCHAR" />
		<result column="YEAR" property="year" jdbcType="VARCHAR" />
		<result column="QUARTER" property="quarter" jdbcType="VARCHAR" />
		<result column="TOTAL_ASSETS" property="totalAssets" jdbcType="NUMERIC" />
		<result column="TOTAL_MANAGE" property="totalManage" jdbcType="NUMERIC" />
		<result column="TOTAL_DEPOSIT" property="totalDeposit" jdbcType="NUMERIC" />
		<result column="TOTAL_CONSULT" property="totalConsult" jdbcType="NUMERIC" />
		<result column="TOTAL_AUDIT" property="totalAudit" jdbcType="NUMERIC" />
		<result column="TOTAL_LAWYER" property="totalLawyer" jdbcType="NUMERIC" />
		<result column="TOTAL_OTHER" property="totalOther" jdbcType="NUMERIC" />
		<result column="INVESTOR_NAME" property="investorName" jdbcType="VARCHAR" />
		<result column="CZ_INVE_AMOUNT" property="czInveAmount" jdbcType="NUMERIC" />
		<result column="CZ_RAISE_AMOUNT" property="czRaiseAmount" jdbcType="NUMERIC" />
		<result column="CAPITAL_SOURCE_NAME" property="capitalSourceName" jdbcType="VARCHAR" />
		<result column="INVE_TYPE_NAME" property="inveTypeName" jdbcType="VARCHAR" />
		<result column="ASSESSMENT_DATE" property="assessmentDate" jdbcType="TIMESTAMP" />
		<result column="END_TOTAL_ASSETS" property="endTotalAssets" jdbcType="NUMERIC" />
		<result column="END_NET_ASSETS" property="endNetAssets" jdbcType="NUMERIC" />
		<result column="TOTAL_MANAGE_PAY" property="totalManagePay" jdbcType="NUMERIC" />
		<result column="TOTAL_CONSULT_PAY" property="totalConsultPay" jdbcType="NUMERIC" />
		<result column="TOTAL_DEPOSIT_PAY" property="totalDepositPay" jdbcType="NUMERIC" />
		<result column="TOTAL_OUTSOURCE" property="totalOutsource" jdbcType="NUMERIC" />
		<result column="TOTAL_OUTSOURCE_PAY" property="totalOutsourcePay" jdbcType="NUMERIC" />
		<result column="TOTAL_ACHIEVEMENT" property="totalAchievement" jdbcType="NUMERIC" />
		<result column="TOTAL_ACHIEVEMENT_PAY" property="totalAchievementPay" jdbcType="NUMERIC" />
		<result column="TOTAL_BONUS" property="totalBonus" jdbcType="NUMERIC" />
		<result column="TOTAL_PROFIT" property="totalProfit" jdbcType="NUMERIC" />
		<result column="TOTAL_RESIDUE" property="totalResidue" jdbcType="NUMERIC" />
		<result column="TOTAL_AVAILABLE_FUNDS" property="totalAvailableFunds" jdbcType="NUMERIC" />

	</resultMap>
	<sql id="searchSql1">
		<if test='paramMap.type=="0"' >
       select DISTINCT
	   hh.YEAR, hh.QUARTER, hh.TOTAL_ASSETS, hh.TOTAL_MANAGE, hh.TOTAL_DEPOSIT, hh.TOTAL_CONSULT, hh.TOTAL_AUDIT, hh.TOTAL_LAWYER, hh.TOTAL_OTHER, hh.FILE_DESC, hh.ASSESSMENT_DATE, hh.END_TOTAL_ASSETS, hh.END_NET_ASSETS, hh.TOTAL_MANAGE_PAY, hh.TOTAL_CONSULT_PAY, hh.TOTAL_DEPOSIT_PAY, hh.TOTAL_OUTSOURCE, hh.TOTAL_OUTSOURCE_PAY, hh.TOTAL_ACHIEVEMENT, hh.TOTAL_ACHIEVEMENT_PAY, hh.TOTAL_BONUS, hh.TOTAL_PROFIT, hh.TOTAL_RESIDUE, hh.TOTAL_AVAILABLE_FUNDS,
       a.*,
       f.DURATION_PERIOD,f.INVE_PERIOD,f.INVE_START_DATE,f.INVE_END_DATE,
       g.ADDRESS_DETAILS,g.CREDIT_CODE
		from
		EI.BD_T_FUND_INFO a
		left join 	EI.BD_T_FUND_INVE_DESC f on f.FUND_ID=a.FUND_ID
		left join  MASTER.T_ENT_BASE_INFO g on g.ENTERPRISE_ID=a.ENTE_ID
		left join ( SELECT ROW_NUMBER() OVER(PARTITION BY aa.fund_id  order by year desc,QUARTER desc NULLS LAST)RN,
		aa.* from BD_T_FUND_COST_INFO aa where 1=1)hh on a.fund_id=hh.fund_id and hh.RN = 1
		<where>
			a.FUND_STS not in(1,10,11,4,6,2,3,9)
		   and	a.FUND_SRC='1'
		   and a.STATUS='1'
		   and  a.group_id='1'
			<if test="searchBean.keyword!='' and searchBean.keyword!=null">
				<bind name="pattern" value="'%' + searchBean.keyword + '%'" />
				AND ( a.FUND_NAME like #{pattern} OR a.MC_NAME like #{pattern} or a.CUSTODIAN_BANK like #{pattern} )
			</if>
			<include refid="searchCondition.searchClause" />
		</where>
			order by a.fund_id desc
		</if>
		<if test='paramMap.type=="3"' >
			select DISTINCT
			hh.YEAR, hh.QUARTER, hh.TOTAL_ASSETS, hh.TOTAL_MANAGE, hh.TOTAL_DEPOSIT, hh.TOTAL_CONSULT, hh.TOTAL_AUDIT, hh.TOTAL_LAWYER, hh.TOTAL_OTHER, hh.FILE_DESC, hh.ASSESSMENT_DATE, hh.END_TOTAL_ASSETS, hh.END_NET_ASSETS, hh.TOTAL_MANAGE_PAY, hh.TOTAL_CONSULT_PAY, hh.TOTAL_DEPOSIT_PAY, hh.TOTAL_OUTSOURCE, hh.TOTAL_OUTSOURCE_PAY, hh.TOTAL_ACHIEVEMENT, hh.TOTAL_ACHIEVEMENT_PAY, hh.TOTAL_BONUS, hh.TOTAL_PROFIT, hh.TOTAL_RESIDUE, hh.TOTAL_AVAILABLE_FUNDS,
			gg.INVESTOR_NAME,h.INVE_AMOUNT as CZ_INVE_AMOUNT,h.RAISE_AMOUNT as CZ_RAISE_AMOUNT,t.CODE_NAME as CAPITAL_SOURCE_NAME,tt.CODE_NAME as INVE_TYPE_NAME,a.*,f.DURATION_PERIOD,f.INVE_PERIOD,f.INVE_START_DATE,f.INVE_END_DATE,
			g.ADDRESS_DETAILS,g.CREDIT_CODE
			from
			EI.BD_T_FUND_INFO a
			left join 	EI.BD_T_FUND_INVE_DESC f on f.FUND_ID=a.FUND_ID
			left join  MASTER.T_ENT_BASE_INFO g on g.ENTERPRISE_ID=a.ENTE_ID
			left join EI.RZ_T_FUND_SHARE_INFO h ON h.FUND_ID=a.FUND_ID
			left join  base.COMM_T_CODE t on h.CAPITAL_SOURCE=t.CODE_VALUE and t.PARENT_ID='1000'
			left join  base.COMM_T_CODE tt on h.INVE_TYPE=tt.CODE_VALUE and tt.PARENT_ID='1001'
			left join  ei.BD_T_INVE_INFO gg on gg.INVESTOR_ID=h.INVESTOR_ID
			left join ( SELECT ROW_NUMBER() OVER(PARTITION BY aa.fund_id  order by year desc,QUARTER desc NULLS LAST)RN,
			aa.* from BD_T_FUND_COST_INFO aa where 1=1)hh on a.fund_id=hh.fund_id and hh.RN = 1
			<where>
			a.FUND_STS not in(1,10,11,4,6,2,3,9)
			and	a.FUND_SRC='1'
			and a.STATUS='1'
			and  a.group_id='1'
			<if test="searchBean.keyword!='' and searchBean.keyword!=null">
				<bind name="pattern" value="'%' + searchBean.keyword + '%'" />
				AND ( a.FUND_NAME like #{pattern} OR a.MC_NAME like #{pattern} or a.CUSTODIAN_BANK like #{pattern} )
			</if>
			<include refid="searchCondition.searchClause" />
			</where>

		</if>
		<if test='paramMap.type=="10"' >
			select DISTINCT
			hh.YEAR, hh.QUARTER, hh.TOTAL_ASSETS, hh.TOTAL_MANAGE, hh.TOTAL_DEPOSIT, hh.TOTAL_CONSULT, hh.TOTAL_AUDIT, hh.TOTAL_LAWYER, hh.TOTAL_OTHER, hh.FILE_DESC, hh.ASSESSMENT_DATE, hh.END_TOTAL_ASSETS, hh.END_NET_ASSETS, hh.TOTAL_MANAGE_PAY, hh.TOTAL_CONSULT_PAY, hh.TOTAL_DEPOSIT_PAY, hh.TOTAL_OUTSOURCE, hh.TOTAL_OUTSOURCE_PAY, hh.TOTAL_ACHIEVEMENT, hh.TOTAL_ACHIEVEMENT_PAY, hh.TOTAL_BONUS, hh.TOTAL_PROFIT, hh.TOTAL_RESIDUE, hh.TOTAL_AVAILABLE_FUNDS,
			gg.INVESTOR_NAME,h.INVE_AMOUNT as  CZ_INVE_AMOUNT,h.RAISE_AMOUNT as CZ_RAISE_AMOUNT,t.CODE_NAME as CAPITAL_SOURCE_name,tt.CODE_NAME as INVE_TYPE_name,a.*,f.DURATION_PERIOD,f.INVE_PERIOD,f.INVE_START_DATE,f.INVE_END_DATE,
			g.ADDRESS_DETAILS,g.CREDIT_CODE
			from
			EI.BD_T_FUND_INFO a
			left join 	EI.BD_T_FUND_INVE_DESC f on f.FUND_ID=a.FUND_ID
			left join  MASTER.T_ENT_BASE_INFO g on g.ENTERPRISE_ID=a.ENTE_ID
			left join EI.RZ_T_FUND_SHARE_INFO h ON h.FUND_ID=a.FUND_ID
			left join  base.COMM_T_CODE t on h.CAPITAL_SOURCE=t.CODE_VALUE and t.PARENT_ID='1000'
			left join  base.COMM_T_CODE tt on h.INVE_TYPE=tt.CODE_VALUE and tt.PARENT_ID='1001'
			left join  ei.BD_T_INVE_INFO gg on gg.INVESTOR_ID=h.INVESTOR_ID
			left join EI.BD_T_FUND_COST_INFO hh on hh.fund_id=a.fund_id and hh.status!='9'
			<where>
				a.FUND_STS not in(1,10,11,4,6,2,3,9)
				and	a.FUND_SRC='1'
				and a.STATUS='1'
				and  a.group_id='1'
				<if test="searchBean.keyword!='' and searchBean.keyword!=null">
					<bind name="pattern" value="'%' + searchBean.keyword + '%'" />
					AND ( a.FUND_NAME like #{pattern} OR a.MC_NAME like #{pattern} or a.CUSTODIAN_BANK like #{pattern} )
				</if>
				<include refid="searchCondition.searchClause" />
			</where>
			order by a.fund_id desc
		</if>
		<if test='paramMap.type=="2"' >
			select DISTINCT
			hh.YEAR, hh.QUARTER, hh.TOTAL_ASSETS, hh.TOTAL_MANAGE, hh.TOTAL_DEPOSIT, hh.TOTAL_CONSULT, hh.TOTAL_AUDIT, hh.TOTAL_LAWYER, hh.TOTAL_OTHER, hh.FILE_DESC, hh.ASSESSMENT_DATE, hh.END_TOTAL_ASSETS, hh.END_NET_ASSETS, hh.TOTAL_MANAGE_PAY, hh.TOTAL_CONSULT_PAY, hh.TOTAL_DEPOSIT_PAY, hh.TOTAL_OUTSOURCE, hh.TOTAL_OUTSOURCE_PAY, hh.TOTAL_ACHIEVEMENT, hh.TOTAL_ACHIEVEMENT_PAY, hh.TOTAL_BONUS, hh.TOTAL_PROFIT, hh.TOTAL_RESIDUE, hh.TOTAL_AVAILABLE_FUNDS,
			a.*,f.DURATION_PERIOD,f.INVE_PERIOD,f.INVE_START_DATE,f.INVE_END_DATE,
			g.ADDRESS_DETAILS,g.CREDIT_CODE
			from
			EI.BD_T_FUND_INFO a
			left join 	EI.BD_T_FUND_INVE_DESC f on f.FUND_ID=a.FUND_ID
			left join  MASTER.T_ENT_BASE_INFO g on g.ENTERPRISE_ID=a.ENTE_ID
			left join EI.BD_T_FUND_COST_INFO hh on hh.fund_id=a.fund_id and hh.status!='9'
			<where>
				a.FUND_STS not in(1,10,11,4,6,2,3,9)
				and	a.FUND_SRC='1'
				and a.STATUS='1'
				<if test="searchBean.keyword!='' and searchBean.keyword!=null">
					<bind name="pattern" value="'%' + searchBean.keyword + '%'" />
					AND ( a.FUND_NAME like #{pattern} OR a.MC_NAME like #{pattern} or a.CUSTODIAN_BANK like #{pattern} )
				</if>
				<include refid="searchCondition.searchClause" />
			</where>
			order by a.fund_id desc
		</if>
	</sql>
	<select id="fundinveInfoList" resultMap="FundInfoResult15" parameterType="com.founder.ssm.core.common.SearchCondition">
		<include refid="searchSql9" />
	</select>
	<sql id="searchSql9">
		select a.*,d.REGISTER_DT,g.INVE_START_DATE,g.INVE_END_DATE
		from  BD_T_FUND_INFO a
		left join BD_T_FUND_MC_INFO d on a.MC_ID=d.MC_ID
		left join BD_T_FUND_INVE_DESC g on a.FUND_ID=g.FUND_ID
		<where>
			a.FUND_SRC='1' and a.status='1' and a.FUND_STS not in(1,10,11,4,6,2,3,9)
			and a.group_id='1'
			<if test="searchBean.keyword!='' and searchBean.keyword!=null">
				<bind name="pattern" value="'%' + searchBean.keyword + '%'" />
				AND ( a.REG_NAME like #{pattern} OR a.MC_NAME like #{pattern}  )
			</if>
			<include refid="searchCondition.searchClause" />
		</where>
      order by a.fund_id desc
	</sql>


	<select id="selectgovernmentFundListPage" resultMap="InfoResult" parameterType="com.founder.ssm.core.common.SearchCondition">
		<include refid="searchSql1" />
	</select>

	<select id="selectCount" resultType="Integer" parameterType="com.founder.ssm.core.common.SearchCondition">
		SELECT COUNT(*) FROM (
			<include refid="searchSql" />
		) t 
	</select>

	<select id="selectCountBy" resultType="Integer" parameterType="com.ppmg.ei.model.FundInfoModel">
		SELECT COUNT(*) FROM BD_T_FUND_INFO
		<where>
			<if test="fundId != null and fundId != ''" >
				FUND_ID = #{fundId,jdbcType=VARCHAR}
			</if>
			<if test="fundCode != null and fundCode != ''" >
				AND FUND_CODE = #{fundCode,jdbcType=VARCHAR}
			</if>
			<if test="fundName != null and fundName != ''" >
				AND FUND_NAME = #{fundName,jdbcType=VARCHAR}
			</if>
			<if test="regName != null and regName != ''" >
				AND REG_NAME = #{regName,jdbcType=VARCHAR}
			</if>
			<if test="mcId != null and mcId != ''" >
				AND MC_ID = #{mcId,jdbcType=VARCHAR}
			</if>
			<if test="mcName != null and mcName != ''" >
				AND MC_NAME = #{mcName,jdbcType=VARCHAR}
			</if>
			<if test="gp != null and gp != ''" >
				AND GP = #{gp,jdbcType=VARCHAR}
			</if>
			<if test="contact != null and contact != ''" >
				AND CONTACT = #{contact,jdbcType=VARCHAR}
			</if>
			<if test="phoneNo != null and phoneNo != ''" >
				AND PHONE_NO = #{phoneNo,jdbcType=VARCHAR}
			</if>
			<if test="contactEmail != null and contactEmail != ''" >
				AND CONTACT_EMAIL = #{contactEmail,jdbcType=VARCHAR}
			</if>
			<if test="planAmount != null and planAmount != ''" >
				AND PLAN_AMOUNT = #{planAmount,jdbcType=NUMERIC}
			</if>
			<if test="planCurr != null and planCurr != ''" >
				AND PLAN_CURR = #{planCurr,jdbcType=VARCHAR}
			</if>
			<if test="raiseAmount != null and raiseAmount != ''" >
				AND RAISE_AMOUNT = #{raiseAmount,jdbcType=NUMERIC}
			</if>
			<if test="raiseCurrency != null and raiseCurrency != ''" >
				AND RAISE_CURRENCY = #{raiseCurrency,jdbcType=VARCHAR}
			</if>
			<if test="fundStruct != null and fundStruct != ''" >
				AND FUND_STRUCT = #{fundStruct,jdbcType=VARCHAR}
			</if>
			<if test="platProp != null and platProp != ''" >
				AND PLAT_PROP = #{platProp,jdbcType=VARCHAR}
			</if>
			<if test="subPlatProp != null and subPlatProp != ''" >
				AND SUB_PLAT_PROP = #{subPlatProp,jdbcType=VARCHAR}
			</if>
			<if test="setupDt != null" >
				AND SETUP_DT = #{setupDt,jdbcType=VARCHAR}
			</if>
			<if test="closeDt != null" >
				AND CLOSE_DT = #{closeDt,jdbcType=VARCHAR}
			</if>
			<if test="regAdd != null and regAdd != ''" >
				AND REG_ADD = #{regAdd,jdbcType=VARCHAR}
			</if>
			<if test="orgnCode != null and orgnCode != ''" >
				AND ORGN_CODE = #{orgnCode,jdbcType=VARCHAR}
			</if>
			<if test="legalPerson != null and legalPerson != ''" >
				AND LEGAL_PERSON = #{legalPerson,jdbcType=VARCHAR}
			</if>
			<if test="custodianBank != null and custodianBank != ''" >
				AND CUSTODIAN_BANK = #{custodianBank,jdbcType=VARCHAR}
			</if>
			<if test="regCapital != null and regCapital != ''" >
				AND REG_CAPITAL = #{regCapital,jdbcType=NUMERIC}
			</if>
			<if test="regCurrency != null and regCurrency != ''" >
				AND REG_CURRENCY = #{regCurrency,jdbcType=VARCHAR}
			</if>
			<if test="capitalAccount != null and capitalAccount != ''" >
				AND CAPITAL_ACCOUNT = #{capitalAccount,jdbcType=VARCHAR}
			</if>
			<if test="returnAccount != null and returnAccount != ''" >
				AND RETURN_ACCOUNT = #{returnAccount,jdbcType=VARCHAR}
			</if>
			<if test="fundSts != null and fundSts != ''" >
				AND FUND_STS = #{fundSts,jdbcType=VARCHAR}
			</if>
			<if test="descFile != null and descFile != ''" >
				AND DESC_FILE = #{descFile,jdbcType=VARCHAR}
			</if>
			<if test="fundSrc != null and fundSrc != ''" >
				AND FUND_SRC = #{fundSrc,jdbcType=VARCHAR}
			</if>
			<if test="createBy != null and createBy != ''" >
				AND CREATE_BY = #{createBy,jdbcType=VARCHAR}
			</if>
			<if test="createDt != null" >
				AND CREATE_DT = #{createDt,jdbcType=VARCHAR}
			</if>
			<if test="updateBy != null and updateBy != ''" >
				AND UPDATE_BY = #{updateBy,jdbcType=VARCHAR}
			</if>
			<if test="updateDt != null" >
				AND UPDATE_DT = #{updateDt,jdbcType=VARCHAR}
			</if>
			<if test="fundGenre != null and fundGenre != ''" >
				AND FUND_GENRE = #{fundGenre,jdbcType=VARCHAR}
			</if>
			<if test="custodianBankaccount != null and custodianBankaccount != ''" >
				AND CUSTODIAN_BANKACCOUNT = #{custodianBankaccount,jdbcType=VARCHAR}
			</if>
			<if test="capitalBank != null and capitalBank != ''" >
				AND CAPITAL_BANK = #{capitalBank,jdbcType=VARCHAR}
			</if>
			<if test="returnBank != null and returnBank != ''" >
				AND RETURN_BANK = #{returnBank,jdbcType=VARCHAR}
			</if>
			<if test="partners != null and partners != ''" >
				AND PARTNERS = #{partners,jdbcType=VARCHAR}
			</if>
			<if test="groupId != null and groupId != ''" >
				AND GROUP_ID = #{groupId,jdbcType=NUMERIC}
			</if>
			<if test="gpId != null and gpId != ''" >
				AND GP_ID = #{gpId,jdbcType=VARCHAR}
			</if>
			<if test="rmbRaiseAmount != null and rmbRaiseAmount != ''" >
				AND RMB_RAISE_AMOUNT = #{rmbRaiseAmount,jdbcType=NUMERIC}
			</if>
			<if test="currentAmount != null and currentAmount != ''" >
				AND CURRENT_AMOUNT = #{currentAmount,jdbcType=NUMERIC}
			</if>
			<if test="currentCurrency != null and currentCurrency != ''" >
				AND CURRENT_CURRENCY = #{currentCurrency,jdbcType=VARCHAR}
			</if>
			<if test="rmbCurrentAmount != null and rmbCurrentAmount != ''" >
				AND RMB_CURRENT_AMOUNT = #{rmbCurrentAmount,jdbcType=NUMERIC}
			</if>
			<if test="maintenanceId != null and maintenanceId != ''" >
				AND MAINTENANCE_ID = #{maintenanceId,jdbcType=VARCHAR}
			</if>
			<if test="maintenance != null and maintenance != ''" >
				AND MAINTENANCE = #{maintenance,jdbcType=VARCHAR}
			</if>
			<if test="socialCode != null and socialCode != ''" >
				AND SOCIAL_CODE = #{socialCode,jdbcType=VARCHAR}
			</if>
			<if test="keyPersonLock != null and keyPersonLock != ''" >
				AND KEY_PERSON_LOCK = #{keyPersonLock,jdbcType=VARCHAR}
			</if>
			<if test="ratioInGp != null and ratioInGp != ''" >
				AND RATIO_IN_GP = #{ratioInGp,jdbcType=NUMERIC}
			</if>
			<if test="rmbPlanAmount != null and rmbPlanAmount != ''" >
				AND RMB_PLAN_AMOUNT = #{rmbPlanAmount,jdbcType=NUMERIC}
			</if>
			<if test="fundScope != null and fundScope != ''" >
				AND FUND_SCOPE = #{fundScope,jdbcType=VARCHAR}
			</if>
			<if test="yhRatioAsLp != null and yhRatioAsLp != ''" >
				AND YH_RATIO_AS_LP = #{yhRatioAsLp,jdbcType=NUMERIC}
			</if>
			<if test="yhRatioInGp != null and yhRatioInGp != ''" >
				AND YH_RATIO_IN_GP = #{yhRatioInGp,jdbcType=NUMERIC}
			</if>
			<if test="yhRatioInMc != null and yhRatioInMc != ''" >
				AND YH_RATIO_IN_MC = #{yhRatioInMc,jdbcType=NUMERIC}
			</if>
			<if test="email != null and email != ''" >
				AND EMAIL = #{email,jdbcType=VARCHAR}
			</if>
			<if test="enteId != null and enteId != ''" >
				AND ENTE_ID = #{enteId,jdbcType=VARCHAR}
			</if>
			<if test="emailPassword != null and emailPassword != ''" >
				AND EMAIL_PASSWORD = #{emailPassword,jdbcType=VARCHAR}
			</if>
			<if test="financeId != null and financeId != ''" >
				AND FINANCE_ID = #{financeId,jdbcType=VARCHAR}
			</if>
			<if test="financeName != null and financeName != ''" >
				AND FINANCE_NAME = #{financeName,jdbcType=VARCHAR}
			</if>
			<if test="executivePartnerId != null and executivePartnerId != ''" >
				AND EXECUTIVE_PARTNER_ID = #{executivePartnerId,jdbcType=VARCHAR}
			</if>
			<if test="executivePartnerName != null and executivePartnerName != ''" >
				AND EXECUTIVE_PARTNER_NAME = #{executivePartnerName,jdbcType=VARCHAR}
			</if>
			<if test="isFit != null and isFit != ''" >
				AND IS_FIT = #{isFit,jdbcType=VARCHAR}
			</if>
			<if test="custodianOpenBank != null and custodianOpenBank != ''" >
				AND CUSTODIAN_OPEN_BANK = #{custodianOpenBank,jdbcType=VARCHAR}
			</if>
			<if test="custodianBankNum != null and custodianBankNum != ''" >
				AND CUSTODIAN_BANK_NUM = #{custodianBankNum,jdbcType=VARCHAR}
			</if>
			<if test="isRecord != null and isRecord != ''" >
				AND IS_RECORD = #{isRecord,jdbcType=VARCHAR}
			</if>
			<if test="recordCode != null and recordCode != ''" >
				AND RECORD_CODE = #{recordCode,jdbcType=VARCHAR}
			</if>
			<if test="recordDate != null" >
				AND RECORD_DATE = #{recordDate,jdbcType=VARCHAR}
			</if>
			<if test="recordAtta != null and recordAtta != ''" >
				AND RECORD_ATTA = #{recordAtta,jdbcType=VARCHAR}
			</if>
			<if test="isCustodian!= null and  isCustodian!= ''" >
				AND  IS_CUSTODIAN= #{isCustodian,jdbcType=VARCHAR}
			</if>
			<if test="custodianAtta!= null and  custodianAtta!= ''" >
				AND  CUSTODIAN_ATTA= #{custodianAtta,jdbcType=VARCHAR}
			</if>
			<if test="isAuth != null and isAuth != ''" >
				AND  IS_AUTH = #{isAuth,jdbcType=VARCHAR}
			</if>
			<if test="authAtta != null and authAtta != ''" >
				AND  AUTH_ATTA = #{authAtta,jdbcType=VARCHAR}
			</if>
			<if test="promiseAmount != null and promiseAmount != ''" >
				AND PROMISE_AMOUNT = #{promiseAmount,jdbcType=NUMERIC}
			</if>
			<if test="profitAmount != null and profitAmount != ''" >
				AND  PROFIT_AMOUNT = #{profitAmount,jdbcType=NUMERIC}
			</if>
			<if test="status != null and status != ''" >
				AND  STATUS = #{status,jdbcType=VARCHAR}
			</if>
			<if test="inveCurrentAmount != null and inveCurrentAmount != ''" >
				AND  INVE_CURRENT_AMOUNT = #{inveCurrentAmount,jdbcType=NUMERIC}
			</if>
			<if test="spvType != null and spvType != ''" >
				AND  SPV_TYPE = #{spvType,jdbcType=VARCHAR}
			</if>
			<if test="isExcept != null and isExcept != ''" >
				AND  IS_EXCEPT = #{isExcept,jdbcType=VARCHAR}
			</if>
			<if test="inveRaiseAmount != null" >
				AND INVE_RAISE_AMOUNT = #{inveRaiseAmount,jdbcType=NUMERIC}
			</if>
			<if test="isLead != null and isLead != ''" >
				AND  IS_LEAD = #{isLead,jdbcType=VARCHAR}
			</if>
			<if test="isExit != null and isExit != ''" >
				AND  IS_EXIT = #{isExit,jdbcType=VARCHAR}
			</if>
			<if test="financeAmount != null" >
				AND FINANCE_AMOUNT = #{financeAmount,jdbcType=VARCHAR}
			</if>
			<if test="inveType != null and inveType != ''" >
				AND  INVE_TYPE = #{inveType,jdbcType=VARCHAR}
			</if>
			<if test="appDep != null and appDep != ''" >
				AND  APP_DEP = #{appDep,jdbcType=VARCHAR}
			</if>
			<if test="govFundSrc != null and govFundSrc != ''" >
				AND  GOV_FUND_SRC = #{govFundSrc,jdbcType=VARCHAR}
			</if>
			<if test="basis != null and basis != ''" >
				AND  BASIS = #{basis,jdbcType=VARCHAR}
			</if>
			<if test="inveLimit != null and inveLimit != ''" >
				AND  INVE_LIMIT = #{inveLimit,jdbcType=VARCHAR}
			</if>
			<if test="manDep != null and manDep != ''" >
				AND  MAN_DEP = #{manDep,jdbcType=VARCHAR}
			</if>
			<if test="shortName != null and shortName != ''" >
				AND  SHORT_NAME = #{shortName,jdbcType=VARCHAR}
			</if>
			<if test="fundsType != null and fundsType != ''" >
				AND  FUNDS_TYPE = #{fundsType,jdbcType=VARCHAR}
			</if>
			<if test="parentId != null and parentId != ''" >
				AND  PARENT_ID = #{parentId,jdbcType=VARCHAR}
			</if>
			<if test="fundCategory != null and fundCategory != ''" >
				AND  FUNDCATEGORY = #{fundCategory,jdbcType=VARCHAR}
			</if>
			<if test="oldSubPlatProp != null and oldSubPlatProp != ''" >
				AND  OLD_SUB_PLAT_PROP = #{oldSubPlatProp,jdbcType=VARCHAR}
			</if>
			<if test="isDirect != null and isDirect != ''" >
				AND  ISDIRECT = #{isDirect,jdbcType=VARCHAR}
			</if>
			<if test="isDesignate != null and isDesignate != ''" >
				AND  IS_DESIGNATE = #{isDesignate,jdbcType=VARCHAR}
			</if>
			<if test="fundCodeSign != null and fundCodeSign != ''" >
				AND  FUND_CODE_SIGN = #{fundCodeSign,jdbcType=VARCHAR}
			</if>
		</where>
	</select>

	<select id="selectList" parameterType="com.ppmg.ei.model.FundInfoModel" resultMap="FundInfoResult">
		SELECT * FROM BD_T_FUND_INFO
		<where>
		    status!='2'
			<if test="fundId != null and fundId != ''" >
				AND FUND_ID = #{fundId,jdbcType=VARCHAR}
			</if>
			<if test="fundCode != null and fundCode != ''" >
				AND FUND_CODE = #{fundCode,jdbcType=VARCHAR}
			</if>
			<if test="fundName != null and fundName != ''" >
				AND FUND_NAME = #{fundName,jdbcType=VARCHAR}
			</if>
			<if test="regName != null and regName != ''" >
				AND REG_NAME = #{regName,jdbcType=VARCHAR}
			</if>
			<if test="mcId != null and mcId != ''" >
				AND MC_ID = #{mcId,jdbcType=VARCHAR}
			</if>
			<if test="mcName != null and mcName != ''" >
				AND MC_NAME = #{mcName,jdbcType=VARCHAR}
			</if>
			<if test="gp != null and gp != ''" >
				AND GP = #{gp,jdbcType=VARCHAR}
			</if>
			<if test="contact != null and contact != ''" >
				AND CONTACT = #{contact,jdbcType=VARCHAR}
			</if>
			<if test="phoneNo != null and phoneNo != ''" >
				AND PHONE_NO = #{phoneNo,jdbcType=VARCHAR}
			</if>
			<if test="contactEmail != null and contactEmail != ''" >
				AND CONTACT_EMAIL = #{contactEmail,jdbcType=VARCHAR}
			</if>
			<if test="planAmount != null and planAmount != ''" >
				AND PLAN_AMOUNT = #{planAmount,jdbcType=NUMERIC}
			</if>
			<if test="planCurr != null and planCurr != ''" >
				AND PLAN_CURR = #{planCurr,jdbcType=VARCHAR}
			</if>
			<if test="raiseAmount != null and raiseAmount != ''" >
				AND RAISE_AMOUNT = #{raiseAmount,jdbcType=NUMERIC}
			</if>
			<if test="raiseCurrency != null and raiseCurrency != ''" >
				AND RAISE_CURRENCY = #{raiseCurrency,jdbcType=VARCHAR}
			</if>
			<if test="fundStruct != null and fundStruct != ''" >
				AND FUND_STRUCT = #{fundStruct,jdbcType=VARCHAR}
			</if>
			<if test="platProp != null and platProp != ''" >
				AND PLAT_PROP = #{platProp,jdbcType=VARCHAR}
			</if>
			<if test="subPlatProp != null and subPlatProp != ''" >
				AND SUB_PLAT_PROP = #{subPlatProp,jdbcType=VARCHAR}
			</if>
			<if test="setupDt != null" >
				AND SETUP_DT = #{setupDt,jdbcType=VARCHAR}
			</if>
			<if test="closeDt != null" >
				AND CLOSE_DT = #{closeDt,jdbcType=VARCHAR}
			</if>
			<if test="regAdd != null and regAdd != ''" >
				AND REG_ADD = #{regAdd,jdbcType=VARCHAR}
			</if>
			<if test="orgnCode != null and orgnCode != ''" >
				AND ORGN_CODE = #{orgnCode,jdbcType=VARCHAR}
			</if>
			<if test="legalPerson != null and legalPerson != ''" >
				AND LEGAL_PERSON = #{legalPerson,jdbcType=VARCHAR}
			</if>
			<if test="custodianBank != null and custodianBank != ''" >
				AND CUSTODIAN_BANK = #{custodianBank,jdbcType=VARCHAR}
			</if>
			<if test="regCapital != null and regCapital != ''" >
				AND REG_CAPITAL = #{regCapital,jdbcType=NUMERIC}
			</if>
			<if test="regCurrency != null and regCurrency != ''" >
				AND REG_CURRENCY = #{regCurrency,jdbcType=VARCHAR}
			</if>
			<if test="capitalAccount != null and capitalAccount != ''" >
				AND CAPITAL_ACCOUNT = #{capitalAccount,jdbcType=VARCHAR}
			</if>
			<if test="returnAccount != null and returnAccount != ''" >
				AND RETURN_ACCOUNT = #{returnAccount,jdbcType=VARCHAR}
			</if>
			<if test="fundSts != null and fundSts != ''" >
				AND FUND_STS = #{fundSts,jdbcType=VARCHAR}
			</if>
			<if test="descFile != null and descFile != ''" >
				AND DESC_FILE = #{descFile,jdbcType=VARCHAR}
			</if>
			<if test="fundSrc != null and fundSrc != ''" >
				AND FUND_SRC = #{fundSrc,jdbcType=VARCHAR}
			</if>
			<if test="createBy != null and createBy != ''" >
				AND CREATE_BY = #{createBy,jdbcType=VARCHAR}
			</if>
			<if test="createDt != null" >
				AND CREATE_DT = #{createDt,jdbcType=VARCHAR}
			</if>
			<if test="updateBy != null and updateBy != ''" >
				AND UPDATE_BY = #{updateBy,jdbcType=VARCHAR}
			</if>
			<if test="updateDt != null" >
				AND UPDATE_DT = #{updateDt,jdbcType=VARCHAR}
			</if>
			<if test="fundGenre != null and fundGenre != ''" >
				AND FUND_GENRE = #{fundGenre,jdbcType=VARCHAR}
			</if>
			<if test="custodianBankaccount != null and custodianBankaccount != ''" >
				AND CUSTODIAN_BANKACCOUNT = #{custodianBankaccount,jdbcType=VARCHAR}
			</if>
			<if test="capitalBank != null and capitalBank != ''" >
				AND CAPITAL_BANK = #{capitalBank,jdbcType=VARCHAR}
			</if>
			<if test="returnBank != null and returnBank != ''" >
				AND RETURN_BANK = #{returnBank,jdbcType=VARCHAR}
			</if>
			<if test="partners != null and partners != ''" >
				AND PARTNERS = #{partners,jdbcType=VARCHAR}
			</if>
			<if test="groupId != null and groupId != ''" >
				AND GROUP_ID = #{groupId,jdbcType=NUMERIC}
			</if>
			<if test="gpId != null and gpId != ''" >
				AND GP_ID = #{gpId,jdbcType=VARCHAR}
			</if>
			<if test="rmbRaiseAmount != null and rmbRaiseAmount != ''" >
				AND RMB_RAISE_AMOUNT = #{rmbRaiseAmount,jdbcType=NUMERIC}
			</if>
			<if test="currentAmount != null and currentAmount != ''" >
				AND CURRENT_AMOUNT = #{currentAmount,jdbcType=NUMERIC}
			</if>
			<if test="currentCurrency != null and currentCurrency != ''" >
				AND CURRENT_CURRENCY = #{currentCurrency,jdbcType=VARCHAR}
			</if>
			<if test="rmbCurrentAmount != null and rmbCurrentAmount != ''" >
				AND RMB_CURRENT_AMOUNT = #{rmbCurrentAmount,jdbcType=NUMERIC}
			</if>
			<if test="maintenanceId != null and maintenanceId != ''" >
				AND MAINTENANCE_ID = #{maintenanceId,jdbcType=VARCHAR}
			</if>
			<if test="maintenance != null and maintenance != ''" >
				AND MAINTENANCE = #{maintenance,jdbcType=VARCHAR}
			</if>
			<if test="socialCode != null and socialCode != ''" >
				AND SOCIAL_CODE = #{socialCode,jdbcType=VARCHAR}
			</if>
			<if test="keyPersonLock != null and keyPersonLock != ''" >
				AND KEY_PERSON_LOCK = #{keyPersonLock,jdbcType=VARCHAR}
			</if>
			<if test="ratioInGp != null and ratioInGp != ''" >
				AND RATIO_IN_GP = #{ratioInGp,jdbcType=NUMERIC}
			</if>
			<if test="rmbPlanAmount != null and rmbPlanAmount != ''" >
				AND RMB_PLAN_AMOUNT = #{rmbPlanAmount,jdbcType=NUMERIC}
			</if>
			<if test="fundScope != null and fundScope != ''" >
				AND FUND_SCOPE = #{fundScope,jdbcType=VARCHAR}
			</if>
			<if test="yhRatioAsLp != null and yhRatioAsLp != ''" >
				AND YH_RATIO_AS_LP = #{yhRatioAsLp,jdbcType=NUMERIC}
			</if>
			<if test="yhRatioInGp != null and yhRatioInGp != ''" >
				AND YH_RATIO_IN_GP = #{yhRatioInGp,jdbcType=NUMERIC}
			</if>
			<if test="yhRatioInMc != null and yhRatioInMc != ''" >
				AND YH_RATIO_IN_MC = #{yhRatioInMc,jdbcType=NUMERIC}
			</if>
			<if test="email != null and email != ''" >
				AND EMAIL = #{email,jdbcType=VARCHAR}
			</if>
			<if test="enteId != null and enteId != ''" >
				AND ENTE_ID = #{enteId,jdbcType=VARCHAR}
			</if>
			<if test="emailPassword != null and emailPassword != ''" >
				AND EMAIL_PASSWORD = #{emailPassword,jdbcType=VARCHAR}
			</if>
			<if test="financeId != null and financeId != ''" >
				AND FINANCE_ID = #{financeId,jdbcType=VARCHAR}
			</if>
			<if test="financeName != null and financeName != ''" >
				AND FINANCE_NAME = #{financeName,jdbcType=VARCHAR}
			</if>
			<if test="executivePartnerId != null and executivePartnerId != ''" >
				AND EXECUTIVE_PARTNER_ID = #{executivePartnerId,jdbcType=VARCHAR}
			</if>
			<if test="executivePartnerName != null and executivePartnerName != ''" >
				AND EXECUTIVE_PARTNER_NAME = #{executivePartnerName,jdbcType=VARCHAR}
			</if>
			<if test="isFit != null and isFit != ''" >
				AND IS_FIT = #{isFit,jdbcType=VARCHAR}
			</if>
			<if test="custodianOpenBank != null and custodianOpenBank != ''" >
				AND CUSTODIAN_OPEN_BANK = #{custodianOpenBank,jdbcType=VARCHAR}
			</if>
			<if test="custodianBankNum != null and custodianBankNum != ''" >
				AND CUSTODIAN_BANK_NUM = #{custodianBankNum,jdbcType=VARCHAR}
			</if>
			<if test="isRecord != null and isRecord != ''" >
				AND IS_RECORD = #{isRecord,jdbcType=VARCHAR}
			</if>
			<if test="recordCode != null and recordCode != ''" >
				AND RECORD_CODE = #{recordCode,jdbcType=VARCHAR}
			</if>
			<if test="recordDate != null" >
				AND RECORD_DATE = #{recordDate,jdbcType=VARCHAR}
			</if>
			<if test="recordAtta != null and recordAtta != ''" >
				AND RECORD_ATTA = #{recordAtta,jdbcType=VARCHAR}
			</if>
			<if test="isCustodian!= null and  isCustodian!= ''" >
				AND  IS_CUSTODIAN= #{isCustodian,jdbcType=VARCHAR}
			</if>
			<if test="custodianAtta!= null and  custodianAtta!= ''" >
				AND  CUSTODIAN_ATTA= #{custodianAtta,jdbcType=VARCHAR}
			</if>
			<if test="isAuth != null and isAuth != ''" >
				AND  IS_AUTH = #{isAuth,jdbcType=VARCHAR}
			</if>
			<if test="authAtta != null and authAtta != ''" >
				AND  AUTH_ATTA = #{authAtta,jdbcType=VARCHAR}
			</if>
			<if test="promiseAmount != null and promiseAmount != ''" >
				AND PROMISE_AMOUNT = #{promiseAmount,jdbcType=NUMERIC}
			</if>
			<if test="profitAmount != null and profitAmount != ''" >
				AND  PROFIT_AMOUNT = #{profitAmount,jdbcType=NUMERIC}
			</if>
			<if test="status != null and status != ''" >
				AND  STATUS = #{status,jdbcType=VARCHAR}
			</if>
			<if test="inveCurrentAmount != null and inveCurrentAmount != ''" >
				AND  INVE_CURRENT_AMOUNT = #{inveCurrentAmount,jdbcType=NUMERIC}
			</if>
			<if test="spvType != null and spvType != ''" >
				AND  SPV_TYPE = #{spvType,jdbcType=VARCHAR}
			</if>
			<if test="isExcept != null and isExcept != ''" >
				AND  IS_EXCEPT = #{isExcept,jdbcType=VARCHAR}
			</if>
			<if test="inveRaiseAmount != null" >
				AND INVE_RAISE_AMOUNT = #{inveRaiseAmount,jdbcType=NUMERIC}
			</if>
			<if test="isLead != null and isLead != ''" >
				AND  IS_LEAD = #{isLead,jdbcType=VARCHAR}
			</if>
			<if test="isExit != null and isExit != ''" >
				AND  IS_EXIT = #{isExit,jdbcType=VARCHAR}
			</if>
			<if test="financeAmount != null" >
				AND FINANCE_AMOUNT = #{financeAmount,jdbcType=VARCHAR}
			</if>
			<if test="inveType != null and inveType != ''" >
				AND  INVE_TYPE = #{inveType,jdbcType=VARCHAR}
			</if>
			<if test="appDep != null and appDep != ''" >
				AND  APP_DEP = #{appDep,jdbcType=VARCHAR}
			</if>
			<if test="govFundSrc != null and govFundSrc != ''" >
				AND  GOV_FUND_SRC = #{govFundSrc,jdbcType=VARCHAR}
			</if>
			<if test="basis != null and basis != ''" >
				AND  BASIS = #{basis,jdbcType=VARCHAR}
			</if>
			<if test="inveLimit != null and inveLimit != ''" >
				AND  INVE_LIMIT = #{inveLimit,jdbcType=VARCHAR}
			</if>
			<if test="manDep != null and manDep != ''" >
				AND  MAN_DEP = #{manDep,jdbcType=VARCHAR}
			</if>
			<if test="shortName != null and shortName != ''" >
				AND  SHORT_NAME = #{shortName,jdbcType=VARCHAR}
			</if>
			<if test="fundsType != null and fundsType != ''" >
				AND  FUNDS_TYPE = #{fundsType,jdbcType=VARCHAR}
			</if>
			<if test="parentId != null and parentId != ''" >
				AND  PARENT_ID = #{parentId,jdbcType=VARCHAR}
			</if>
			<if test="fundCategory != null and fundCategory != ''" >
				AND  FUNDCATEGORY = #{fundCategory,jdbcType=VARCHAR}
			</if>
			<if test="oldSubPlatProp != null and oldSubPlatProp != ''" >
				AND  OLD_SUB_PLAT_PROP = #{oldSubPlatProp,jdbcType=VARCHAR}
			</if>
			<if test="isDirect != null and isDirect != ''" >
				AND  ISDIRECT = #{isDirect,jdbcType=VARCHAR}
			</if>
			<if test="isDesignate != null and isDesignate != ''" >
				AND  IS_DESIGNATE = #{isDesignate,jdbcType=VARCHAR}
			</if>
			<if test="fundCodeSign != null and fundCodeSign != ''" >
				AND  FUND_CODE_SIGN = #{fundCodeSign,jdbcType=VARCHAR}
			</if>
		</where>
	</select>

	<select id="selectSql2Obj" parameterType="java.lang.String" resultMap="FundInfoResult">
		${value}
	</select>
	<select id="selectSql2Map" parameterType="java.lang.String" resultType="Map">
		${value}
	</select>
	<update id="updateSql" parameterType="java.lang.String">
		${value}
	</update>
	<select id="selectCountSql" parameterType="java.lang.String" resultType="Integer">
		${value}
	</select>
	<!-- end autocreate -->
	<!-- 基金详细信息 -->
	<select id="getFundDetailInfoByFundId" parameterType="java.lang.String" resultMap="FundInfoResult2">
		SELECT * FROM BD_T_FUND_INFO WHERE FUND_ID = #{fundId}
	</select>
    <!-- 基金投资信息 -->
    <select id="getFundInvestInfoByFundId" parameterType="java.lang.String" resultMap="FundInfoResult3">
			select T.THISYEAR_INVEST_COUNT,
		   T.THISYEAR_INVEST_AMOUNT,
		   (select count(t1.proj_id) as cnt
			  from tz_t_proj_info t1
			 where t1.inve_id = #{fundId}
			   and t1.proj_status not in ('2', '3', '4', '7', '8', '15')
			   and t1.proj_type in ('1', '2')
			) as TOTAL_INVEST_COUNT,
		   (select RTrim(to_char(NVL(sum(t2.sign_amount_rmb), 0) / 10000, 'FM99999999990.99'), '.')|| ' 万元' as amt
			  from tz_t_proj_info t1
			 inner join tz_t_proj_contract_file t2
				on t2.proj_id = t1.proj_id
			 inner join (select x.proj_id,
							   max(x.sign_dt) as max_sign_dt,
							   max(x.create_dt) as max_create_dt
						  from tz_t_proj_contract_file x
						 where x.file_type = '1'
						   and x.status = '3'
						   and x.sign_dt is not null
						 group by x.proj_id) t3
				on t3.proj_id = t2.proj_id
			   and t3.max_sign_dt = t2.sign_dt
			   and t3.max_create_dt = t2.create_dt
			 where t1.inve_id = #{fundId}
			   and t1.proj_status not in ('7', '8')
			   and t1.proj_type in ('1', '2')) as TOTAL_INVEST_AMOUNT,
		   (select count(1) as cnt
			  from tz_t_proj_info t1
			 where t1.inve_id = #{fundId}
			   and t1.proj_status in ('11', '12', '13')
			   and t1.proj_type in ('1', '2')) as INVESTING_COUNT
	   from (select count(t1.proj_id) as THISYEAR_INVEST_COUNT,
				   RTrim(to_char(NVL(sum(t2.sign_amount_rmb), 0) / 10000, 'FM99999999990.99'), '.')|| ' 万元' as THISYEAR_INVEST_AMOUNT
			  from tz_t_proj_info t1
			 inner join tz_t_proj_contract_file t2
				on t2.proj_id = t1.proj_id
			 inner join (select x.proj_id,
							   max(x.sign_dt) as max_sign_dt,
							   max(x.create_dt) as max_create_dt
						  from tz_t_proj_contract_file x
						 where x.file_type = '1'
						   and x.status = '3'
						   and x.sign_dt is not null
						   and to_char(x.sign_dt, 'yyyy') =
							   to_char(sysdate, 'yyyy')
						 group by x.proj_id) t3
				on t3.proj_id = t2.proj_id
			   and t3.max_sign_dt = t2.sign_dt
			   and t3.max_create_dt = t2.create_dt
			 where t1.inve_id = #{fundId}
			   and t1.proj_status not in ('2', '3', '4', '7', '8', '15')
			   and t1.proj_type in ('1', '2')) T

	</select>
	<!--<select id="projectInvestedList" resultType="Map">
				select t1.*,t2.*,t3.* from (
				select  b.REG_NAME AS ztRegName,count(a.PROJ_ID)as ztCount,
				count(decode(d.IS_JS,'1','1'))as ztCountJs ,sum(c.FINA_AMOUNT) as ztFinaAmount,
				sum(c.INTENDED_AMOUNT) as ztIntendedAmount ,sum(c.PRE_MONEY) AS ztPreMoney,
				sum(c.POST_MONEY) AS ztPostMoney,sum((c.PRE_MONEY-c.POST_MONEY)) as ztMoney
				from BD_T_FUND_INFO b
				inner join TZ_T_PROJ_INFO a on  a.INVE_ID=b.FUND_ID
				inner JOIN EI.TZ_T_PROJ_APP_INFO c ON a.PROJ_ID=c.PROJ_ID
				left join BD_T_FIT_REGULATION_SELF d on a.INVE_ID=d.FUND_ID
				where
				a.PROJ_TYPE='1' and a.PROJ_SRC='1'
				group by b.REG_NAME) t1,
				(select  b.REG_NAME AS tzRegName,count(a.PROJ_ID)as tzCount,count(decode(d.IS_JS,'1','1'))as tzCountJs ,
				sum(c.FINA_AMOUNT) as tzFinaAmount,sum(c.INTENDED_AMOUNT) AS tzIntendedAmount ,
				sum(c.PRE_MONEY) AS tzPreMoney,sum(c.POST_MONEY) AS tzPostMoney ,
				sum((c.PRE_MONEY-c.POST_MONEY)) as tzMoney from
				BD_T_FUND_INFO b
				inner join TZ_T_PROJ_INFO a on  a.INVE_ID=b.FUND_ID
				inner JOIN EI.TZ_T_PROJ_APP_INFO c ON a.PROJ_ID=c.PROJ_ID
				left join BD_T_FIT_REGULATION_SELF d on a.INVE_ID=d.FUND_ID
				where
				a.PROJ_TYPE='2' and
				a.PROJ_SRC='1'
				group by b.REG_NAME)t2 ,
				(select  b.REG_NAME as zjRegName,,count(a.PROJ_ID)as zjCount,count(decode(d.IS_JS,'1','1'))as zjCountJs,
				sum(c.FINA_AMOUNT) AS zjFinaAmount,sum(c.INTENDED_AMOUNT) AS zjIntendedAmount,
				sum(c.PRE_MONEY) AS zjPreMoney ,sum(c.POST_MONEY) AS zjPostMoney,sum((c.PRE_MONEY-c.POST_MONEY)) as zjMoney from
				BD_T_FUND_INFO b
				inner join TZ_T_PROJ_INFO a on  a.INVE_ID=b.FUND_ID
				inner JOIN EI.TZ_T_PROJ_APP_INFO c ON a.PROJ_ID=c.PROJ_ID
				left join BD_T_FIT_REGULATION_SELF d on a.INVE_ID=d.FUND_ID
				where
				a.PROJ_TYPE='3' and
				a.PROJ_SRC='1'
				group by b.REG_NAME)t3
				where t1.REG_NAME=t2.REG_NAME and t3.REG_NAME=t1.REG_NAME
	</select>-->
	
			<select id="selectFundIdList"  parameterType="java.lang.String"  resultType="Map">
               select count(*) as COUNTGS,RTrim(to_char(sum(aa.amount),'fm999999999999.9999'),'.') as AMOUNT,sum(aa.CURRENT_AMOUNT) as SUMCURRENTAMOUNT from  (
                select a.FUND_ID ,sum(b.INVE_AMOUNT) as amount,count(a.FUND_ID),sum(CURRENT_AMOUNT)/10000 as CURRENT_AMOUNT from
                BD_T_FUND_INFO a left join RZ_T_FUND_SHARE_INFO b on a.FUND_ID=b.FUND_ID
                where a.FUND_SRC='1' and a.FUND_ID!='0' and b.ENTE_ID in('0','50') and a.fund_sts not in(1,10,11,4,6,2,3,9,14)
                and a.status='1'
                group by  a.FUND_ID
                )aa
			</select>
		<!--<select id="selectSumByFundId" parameterType="java.lang.String" resultMap="Map">


		</select>-->
<select id="selectByName" parameterType="java.lang.String"  resultMap="FundInfoResult">
	select * from EI.BD_T_FUND_INFO
	WHERE FUND_NAME=#{fundName,jdbcType=VARCHAR}
	and FUND_SRC in('2','4','5')
</select>

	<select id="selectListByFundCode" parameterType="java.lang.String"  resultMap="FundInfoResult">
		select * from EI.BD_T_FUND_INFO where FUND_CODE like #{fundCode,jdbcType=VARCHAR}
		and FUND_SRC in('1')
        order by FUND_ID DESC
	</select>
	<select id="selectFundOrSpvListByPage"  resultMap="FundInfoResult1" parameterType="com.founder.ssm.core.common.SearchCondition" >
           select aa.*,bb.CREDIT_CODE from (select
          a.*,
          b.PROJ_STATUS,
          b.proj_id,
          b.inve_id,
          b.spv_type as spvT,
          c.fund_name as inve_name,
          c.raise_amount as amount,
		  c.ENTE_ID as entId,
          d.is_js,
          d.IS_CORR,
          e.INVE_CURRENT_AMOUNT as inveCamount,
          e.INVE_RAISE_AMOUNT as inveRamount，
          e.IS_DECISION_PASS,
          e.DECISION_DATE,
          DECODE(b.spv_type,'','否','是' ) as isSpv
           from
          EI.TZ_T_PROJ_INFO b
          inner join  EI.BD_T_FUND_INFO a on b.PROJ_OBJECT=a.fund_id and b.proj_type='5' and a.status='1'
          left join   EI.BD_T_FUND_INFO c on b.inve_id=c.fund_id and c.fund_src in(2,4) and c.status='1'
          left join EI.BD_T_FIT_REGULATION_SELF d on d.PROJ_ID=b.PROJ_ID
          left join EI.TZ_T_PROJ_APP_INFO e on b.PROJ_ID=e.PROJ_ID)aa
		  left join MASTER.T_ENT_BASE_INFO bb on bb.ENTERPRISE_ID=aa.entId
		  <where>
			  <if test="searchBean.fundName != null and searchBean.fundName != ''" >
				  AND aa.fund_name like #{searchBean.fundName}
			  </if>
			  <include refid="searchCondition.searchClause" />
		  </where>
		order by aa.fund_id desc
	</select>

	<select id="fundComprehensiveListPage"  resultType="Map" parameterType="com.founder.ssm.core.common.SearchCondition">
	    SELECT * FROM (select DISTINCT a.*,f.DURATION_PERIOD,f.INVE_PERIOD,f.INVE_START_DATE,f.INVE_END_DATE,
		g.ADDRESS_DETAILS,g.PRIVINCE,ff.REGISTER_NO
		from
		BD_T_FUND_INFO a
		left join 	BD_T_FUND_INVE_DESC f on f.FUND_ID=a.FUND_ID
		left join  MASTER.T_ENT_BASE_INFO g on g.ENTERPRISE_ID=a.ENTE_ID
		left join BD_T_FUND_MC_INFO ff on ff.mc_id=a.mc_id
		where
		a.FUND_STS not in(9,11)
		and	a.FUND_SRC='1'
		and a.STATUS='1')XX
			left join
			(select zzz.* from(select bb.REG_NAME,bb.fund_id2,cc.*,dd.*,ee.* from (select DISTINCT b.REG_NAME,b.fund_id as fund_id2  from BD_T_FUND_INFO b
			left join TZ_T_PROJ_INFO a on  a.INVE_ID=b.FUND_ID

			left JOIN EI.TZ_T_PROJ_APP_INFO c ON a.PROJ_ID=c.PROJ_ID
			left join BD_T_FIT_REGULATION_SELF d on a.PROJ_ID=d.PROJ_ID
			where 	b.FUND_SRC='1'and  b.FUND_STS not in(9,11) and b.status='1'

			)bb
			left join
			(select  b.REG_NAME as ONEREGNAME,count(0) AS ONECOUNT,count(decode(d.IS_JS,'1','1'))as ONECOUNTJS ,sum(c.FINA_AMOUNT)ONEFINAAMOUNT,sum(c.INTENDED_AMOUNT)AS ONEINTENDEDAMOUNT ,sum(c.PRE_MONEY) AS ONEPREMONEY ,sum(c.POST_MONEY) AS ONEPOSTMONEY,sum((c.PRE_MONEY-c.POST_MONEY)) as ONEMONEY,SUM(c.ACTUAL_AMOUNT) as ONEACTUALAMOUNT from
			BD_T_FUND_INFO b
			left join TZ_T_PROJ_INFO a on  a.INVE_ID=b.FUND_ID
			left JOIN EI.TZ_T_PROJ_APP_INFO c ON a.PROJ_ID=c.PROJ_ID
			left join BD_T_FIT_REGULATION_SELF d on a.PROJ_ID=d.PROJ_ID
			where a.PROJ_TYPE='1' and a.status='1' and b.status='1'
			group by b.REG_NAME)cc on cc.ONEREGNAME=bb.REG_NAME
			left join
			(select  b.REG_NAME as TWOREGNAME, count(0) AS TWOCOUNT,count(decode(d.IS_JS,'1','1'))as TWOCOUNTJS ,sum(c.FINA_AMOUNT) AS TWOFINAAMOUNT,sum(c.INTENDED_AMOUNT) AS TWOINTENDEDAMOUNT ,sum(c.PRE_MONEY)AS TWOPREMONEY,sum(c.POST_MONEY) AS TWOPOSTMONEY,sum((c.PRE_MONEY-c.POST_MONEY)) as TWOMONEY from
			BD_T_FUND_INFO b
			left join TZ_T_PROJ_INFO a on  a.INVE_ID=b.FUND_ID
			left JOIN EI.TZ_T_PROJ_APP_INFO c ON a.PROJ_ID=c.PROJ_ID
			left join BD_T_FIT_REGULATION_SELF d on a.PROJ_ID=d.PROJ_ID
			where a.PROJ_TYPE in(2,4) and a.status='1'

			group by b.REG_NAME)dd on dd.TWOREGNAME=bb.REG_NAME
			left join
			(
			select
			bbb.FOURREGNAME as FOURREGNAME,
			sum(bbb.FOURCONT) AS FOURCONT,
			sum(bbb.FOURCOUNTJS)as FOURCOUNTJS ,
			sum(bbb.FOURFINAAMOUNT) AS FOURFINAAMOUNT,
			sum(bbb.FOURINTENDEDAMOUNT) AS FOURINTENDEDAMOUNT ,
			sum(bbb.FOURPREMONEY)AS FOURPREMONEY,
			sum(bbb.FOURPOSTMONEY) AS FOURPOSTMONEY,
			SUM(bbb.FOURACTUALAMOUNT) as FOURACTUALAMOUNT
			from  (select cc.REG_NAME as FOURREGNAME,count(0) AS FOURCONT,count(decode(d.IS_JS,'1','1'))as FOURCOUNTJS ,sum(c.FINA_AMOUNT) AS FOURFINAAMOUNT,sum(c.INTENDED_AMOUNT) AS FOURINTENDEDAMOUNT ,
			sum(c.PRE_MONEY)AS FOURPREMONEY,sum(c.POST_MONEY) AS FOURPOSTMONEY,SUM(c.ACTUAL_AMOUNT) as FOURACTUALAMOUNT
			from (
			select dd.PROJ_OBJECT,dd.REG_NAME from
			(select e.PROJ_OBJECT,b.REG_NAME
			from  BD_T_FUND_INFO b
			inner join TZ_T_PROJ_INFO e on e.INVE_ID=b.FUND_ID
			where  e.PROJ_TYPE in(2,4)
			)dd inner join BD_T_FUND_INFO tt on tt.FUND_ID=dd.PROJ_OBJECT
			)cc
			inner join TZ_T_PROJ_INFO a on cc.PROJ_OBJECT=a.INVE_ID
			INNER JOIN EI.TZ_T_PROJ_APP_INFO c ON a.PROJ_ID=c.PROJ_ID
			LEFT join  EI.BD_T_FIT_REGULATION_SELF d on a.PROJ_ID=d.PROJ_ID
			where  a.PROJ_TYPE='3'
			group by cc.REG_NAME
			union all
			select yy.reg_name as FOURREGNAME,count(0) AS FOURCONT, count(decode(m.IS_JS,'1','1'))as FOURCOUNTJS ,sum(c.FINA_AMOUNT) AS FOURFINAAMOUNT,sum(c.INTENDED_AMOUNT) AS FOURINTENDEDAMOUNT ,
			sum(c.PRE_MONEY)AS FOURPREMONEY,sum(c.POST_MONEY) AS FOURPOSTMONEY,SUM(c.ACTUAL_AMOUNT) as FOURACTUALAMOUNT from (
			select gg.PROJ_OBJECT,gg.reg_name from (
			SELECT a.PROJ_OBJECT,cc.reg_name FROM (
			SELECT TT.PROJ_OBJECT,TT.REG_NAME FROM (
			select dd.PROJ_OBJECT,dd.REG_NAME from	(
			select e.PROJ_OBJECT,b.REG_NAME from  BD_T_FUND_INFO b
			inner join TZ_T_PROJ_INFO e on e.INVE_ID=b.FUND_ID and e.PROJ_TYPE in(2,4) and e.status='1') dd
			inner join BD_T_FUND_INFO tt on tt.FUND_ID=dd.PROJ_OBJECT and tt.status='1')TT
			INNER JOIN BD_T_FUND_INFO PP on PP.FUND_ID=TT.PROJ_OBJECT and PP.statu='1')cc
			inner join TZ_T_PROJ_INFO a on cc.PROJ_OBJECT=a.INVE_ID and a.PROJ_TYPE='3' and a.status='1')gg
			inner join BD_T_FUND_INFO vv on vv.fund_id=gg.PROJ_OBJECT and vv.status='1')yy
			inner join TZ_T_PROJ_INFO d on d.INVE_ID=yy.PROJ_OBJECT
			INNER JOIN EI.TZ_T_PROJ_APP_INFO c ON d.PROJ_ID=c.PROJ_ID
			LEFT join  EI.BD_T_FIT_REGULATION_SELF m on d.PROJ_ID=m.PROJ_ID
			where   d.PROJ_TYPE='6' and d.status='1'
			group by yy.reg_name)bbb
			group by bbb.FOURREGNAME

			)ee on ee.FOURREGNAME=bb.REG_NAME)zzz
             )sss on sss.fund_id2=XX.FUND_ID

	</select>

	<select id="selectByNameAndFundSrc" parameterType="java.lang.String"  resultMap="FundInfoResult">
	select * from EI.BD_T_FUND_INFO
	WHERE FUND_NAME=#{fundName,jdbcType=VARCHAR}
	and FUND_SRC in('2','4')
   </select>

	<select id="selectListProjPage" resultMap="FundInfoResult2" parameterType="com.founder.ssm.core.common.SearchCondition">
		<include refid="searchProjSql" />
	</select>
	<sql id="searchProjSql">
		select ss.CREDIT_CODE,ss.START_DATE,ss.ADDRESS_DETAILS,ppp.PROJ_ID,ppp.INVE_NAME,ppp.PROJ_SRC,ppp.PROJ_STATUS,ppp.PROJ_NO,ppp.PROJ_NAME,ppp.UPDATE_DT as updateDtStr,
		bb.*,
		CASE WHEN bb.RAISE_AMOUNT != 0 AND t.INVE_RAISE_AMOUNT != 0
		THEN   RTrim(to_char(NVL(t.INVE_RAISE_AMOUNT / bb.RAISE_AMOUNT, 0)*100, 'FM99999999990.99'), '.') || '%'
		ELSE '0%' END as PER_RAISE_CURRENT
		FROM BD_T_FUND_INFO bb
		inner join TZ_T_PROJ_INFO ppp ON ppp.PROJ_OBJECT=bb.fund_id and proj_type in(2) and ppp.status!='2'
		left join TZ_T_PROJ_APP_INFO t on t.proj_id=ppp.proj_id
		left join bd_t_fund_info mmm on mmm.fund_id=ppp.inve_id
		left join master.T_ENT_BASE_INFO ss  on bb.ente_id=ss.ENTERPRISE_ID
		<where>
			<include refid="searchCondition.searchClause" />
			<if test='paramMap.INVES=="2" ' >
			and ppp.inve_id in(select fund_id from BD_T_FUND_INFO ff where 1=1 and ((ff.GROUP_ID in(1) and fund_src='0') or (ff.group_id='2' and OLD_SUB_PLAT_PROP='1' )))
			</if>
			<if test='paramMap.INVES=="3" ' >
				and bb.group_id='3'
			</if>
	<!--		<if test='paramMap.fundsType=="1" ' >
				and ( ISDIRECT='1')
			</if>
			<if test='paramMap.INVES=="1" ' >
				and bb.OLD_SUB_PLAT_PROP in(2,4)
			</if>
            <if test='paramMap.INVES=="2" ' >
                and bb.OLD_SUB_PLAT_PROP='2'
            </if>
			<if test='paramMap.INVES=="4" and paramMap.GROUP_ID=="3" ' >
				AND (
				((bb.OLD_SUB_PLAT_PROP IN (4,5)OR(bb.OLD_SUB_PLAT_PROP='2' AND bb.SUB_PLAT_PROP='4' )))
				)
			</if>
			<if test='paramMap.INVES=="4" and  paramMap.GROUP_ID=="2"' >
				AND (

				 (bb.GROUP_ID= '1' and bb.MC_ID= '10008') or (bb.GROUP_ID= '1' and bb.fund_src= '1')or(bb.GROUP_ID= '2' and bb.OLD_SUB_PLAT_PROP IN (4) and mmm.OLD_SUB_PLAT_PROP in(2))
				)
			</if>-->
		<!--	<if test='paramMap.INVES=="4" and paramMap.isRrojRole=="1" and  paramMap.isFundRole=="1" ' >
				AND (
				(ppp.GROUP_ID=#{paramMap.GROUP_ID} and (bb.OLD_SUB_PLAT_PROP IN (4,5)OR(OLD_SUB_PLAT_PROP='2' AND SUB_PLAT_PROP='4' )))
				or (bb.GROUP_ID= '1' and bb.MC_ID= '10008')or (bb.GROUP_ID= '1' and bb.fund_src= '1')
				)
			</if>
			<if test='paramMap.INVES=="3" ' >
				and bb.OLD_SUB_PLAT_PROP='3'
			</if>

			<if test='paramMap.INVES=="5" ' >
				and bb.OLD_SUB_PLAT_PROP in(2,3,4,5)
			</if>
-->
			<if test='paramMap.PLAT_PROP != null and paramMap.PLAT_PROP != ""' >
				and bb.PLAT_PROP IN (${paramMap.PLAT_PROP})
			</if>
			<if test='paramMap.FUND_STRUCT != null and paramMap.FUND_STRUCT != ""' >
				and bb.FUND_STRUCT IN (${paramMap.FUND_STRUCT})
			</if>
			<if test='paramMap.FUND_STS != null and paramMap.FUND_STS != ""' >
				and bb.FUND_STS IN (${paramMap.FUND_STS})
			</if>
			<if test='paramMap.keyWord != null and paramMap.keyWord != ""' >
				and (bb.fund_name like ${paramMap.keyWord} or ppp.inve_name like ${paramMap.keyWord} or ppp.proj_name like ${paramMap.keyWord} or ppp.PROJ_OBJECT_NAME like ${paramMap.keyWord})
			</if>
			<if test='paramMap.USER_ID != null and paramMap.USER_ID != ""' >
				and bb.FUND_ID IN (select FUND_ID from BD_T_FUND_USER_RELATE FU
				WHERE FU.USER_ID=#{paramMap.USER_ID})
			</if>
		</where>
		ORDER BY bb.UPDATE_DT DESC
	</sql>


	<!--新增-->
	<insert id="insertFundInfoMapper" parameterType="List">
		INSERT INTO BD_T_FUND_INFO (FUND_ID,CURRENT_AMOUNT,CURRENT_CURRENCY,CREATE_BY,UPDATE_BY)
		<foreach collection="list" item="item" index="index" separator="union all">
			(select
			#{item.fundId,jdbcType=VARCHAR},
			#{item.currentAmount,jdbcType=VARCHAR},
			#{item.currentCurrency,jdbcType=VARCHAR},
			#{item.createBy,jdbcType=VARCHAR},
			#{item.updateBy,jdbcType=VARCHAR}
			from dual)
		</foreach>
	</insert>
	<update id="updateFundInfoMapper" parameterType="com.ppmg.ei.model.FundInfoModel">
		UPDATE BD_T_FUND_INFO
		<set>
			<if test="fundId != null and fundId != ''" >
				FUND_ID = #{fundId,jdbcType=VARCHAR},
			</if>
			<if test="currentAmount != null and currentAmount != ''" >
				CURRENT_AMOUNT = #{currentAmount,jdbcType=VARCHAR},
			</if>
			<if test="currentCurrency != null and currentCurrency != ''" >
				CURRENT_CURRENCY = #{currentCurrency,jdbcType=VARCHAR},
			</if>
			<if test="shortName != null and shortName != ''" >
				SHORT_NAME = #{shortName,jdbcType=VARCHAR},
			</if>
			<if test="createBy != null and createBy != ''" >
				CREATE_BY = #{createBy,jdbcType=VARCHAR},
			</if>
			<if test="updateBy != null and updateBy != ''" >
				UPDATE_BY = #{updateBy,jdbcType=VARCHAR},
			</if>
		</set>
		WHERE FUND_ID = #{fundId,jdbcType=VARCHAR}
	</update>

	<select id="selectFofListPage"  resultMap="FundInfoResult" parameterType="com.founder.ssm.core.common.SearchCondition">
        select a.* ,START_DATE,
		CASE WHEN a.RAISE_AMOUNT != 0 AND a.RAISE_AMOUNT != 0
		THEN   RTrim(to_char(NVL(a.INVE_RAISE_AMOUNT / a.RAISE_AMOUNT, 0)*100, 'FM99999999990.99'), '.') || '%'
		ELSE '0%' END as PERCENT
        from EI.BD_T_FUND_INFO a
        left join master.T_ENT_BASE_INFO b on a.ente_id=b.ENTERPRISE_ID
		<where>
		    a.status!='2'
			<if test='paramMap.groupId=="2" ' >
			  and ((a.GROUP_ID in(1) and fund_src='0') or (a.group_id='2' and OLD_SUB_PLAT_PROP='1' ))
			</if>
			<if test='paramMap.groupId=="3" and paramMap.OLD_SUB_PLAT_PROP=="7" ' >
				and ((a.GROUP_ID in(1,2) and ISDIRECT='1') or a.OLD_SUB_PLAT_PROP='7')
			</if>
			<if test='paramMap.groupId=="3" and paramMap.OLD_SUB_PLAT_PROP=="1" ' >
				and a.GROUP_ID='3'
			</if>
            <if test='paramMap.groupId=="3" and paramMap.OLD_SUB_PLAT_PROP=="1,7" ' >
               and (a.group_id='3' and a.OLD_SUB_PLAT_PROP in('1','7'))
            </if>
			<if test='paramMap.keyWord != null and paramMap.keyWord != ""' >
				and a.FUND_NAME like ${paramMap.keyWord}
			</if>
		<include refid="searchCondition.searchClause"/>
		</where>
		 order by a.CREATE_DT desc
	</select>
	<!--查询母基金+代管基金-->
	<select id="selectFofListPageAll"  resultMap="FundInfoResult" parameterType="com.founder.ssm.core.common.SearchCondition">
		select a.* ,
		CASE WHEN a.RAISE_AMOUNT != 0 AND a.RAISE_AMOUNT != 0
		THEN   RTrim(to_char(NVL(a.INVE_RAISE_AMOUNT / a.RAISE_AMOUNT, 0)*100, 'FM99999999990.99'), '.') || '%'
		ELSE '0%' END as PERCENT
		from EI.BD_T_FUND_INFO a
		<where>
			a.status!='2' and a.GROUP_ID='2'
			<if test='paramMap.keyWord != null and paramMap.keyWord != ""' >
				and a.FUND_NAME like ${paramMap.keyWord}
			</if>
			<if test='paramMap.oldSubPlatProp != null and paramMap.oldSubPlatProp != "" and paramMap.oldSubPlatProp == "21"' >
				and a.OLD_SUB_PLAT_PROP = '2' or a.OLD_SUB_PLAT_PROP = '3'
			</if>
			<if test='paramMap.oldSubPlatProp != null and paramMap.oldSubPlatProp != "" and paramMap.oldSubPlatProp != "21"' >
				and a.OLD_SUB_PLAT_PROP = ${paramMap.oldSubPlatProp}
			</if>
		</where>
		order by a.UPDATE_DT desc
	</select>

    <select id="selectByList" parameterType="com.ppmg.ei.model.FundInfoModel" resultMap="FundInfoResult">
      select * from  EI.BD_T_FUND_INFO WHERE
      OLD_SUB_PLAT_PROP=#{oldSubPlatProp}
      and PARENT_ID is null
      AND STATUS!='2'
      order by fund_id desc
	</select>

	<select id="selectNewCode" resultMap="FundInfoResult" parameterType="java.util.Map">
      select * from EI.BD_T_FUND_INFO where status!='2' and OLD_SUB_PLAT_PROP='2'
      and parent_id is not null
      and FUND_CODE_SIGN=#{fundCodeSign}
      and fund_code like #{code}
      order by fund_id desc
	</select>

	<select id="selectNewCodeName" resultMap="FundInfoResult" parameterType="java.util.Map">
      select * from EI.BD_T_FUND_INFO
      where status!='2'
      and OLD_SUB_PLAT_PROP in(4,5)
      and FUND_CODE_SIGN=#{fundCodeSign}
      and fund_code like #{code} order by fund_id desc
	</select>

	<update id="updateForId" parameterType="com.ppmg.ei.model.FundInfoModel">
		UPDATE BD_T_FUND_INFO
		<set>
			<if test="fundId != null and fundId != ''" >
				FUND_ID = #{fundId,jdbcType=VARCHAR},
			</if>
			<if test="fundCode != null and fundCode != ''" >
				FUND_CODE = #{fundCode,jdbcType=VARCHAR},
			</if>
			<if test="fundName != null and fundName != ''" >
				FUND_NAME = #{fundName,jdbcType=VARCHAR},
			</if>
			<if test="regName != null and regName != ''" >
				REG_NAME = #{regName,jdbcType=VARCHAR},
			</if>
			<if test="mcId != null " >
				MC_ID = #{mcId,jdbcType=VARCHAR},
			</if>
			<if test="mcName != null " >
				MC_NAME = #{mcName,jdbcType=VARCHAR},
			</if>
			<if test="gp != null " >
				GP = #{gp,jdbcType=VARCHAR},
			</if>
			<if test="contact != null" >
				CONTACT = #{contact,jdbcType=VARCHAR},
			</if>
			<if test="phoneNo != null " >
				PHONE_NO = #{phoneNo,jdbcType=VARCHAR},
			</if>
			<if test="contactEmail != null " >
				CONTACT_EMAIL = #{contactEmail,jdbcType=VARCHAR},
			</if>
			<if test="planAmount != null " >
				PLAN_AMOUNT = #{planAmount,jdbcType=NUMERIC},
			</if>
			<if test="planCurr != null " >
				PLAN_CURR = #{planCurr,jdbcType=VARCHAR},
			</if>
			<if test="raiseAmount != null " >
				RAISE_AMOUNT = #{raiseAmount,jdbcType=NUMERIC},
			</if>
			<if test="raiseCurrency != null " >
				RAISE_CURRENCY = #{raiseCurrency,jdbcType=VARCHAR},
			</if>
			<if test="fundStruct != null " >
				FUND_STRUCT = #{fundStruct,jdbcType=VARCHAR},
			</if>
			<if test="platProp != null " >
				PLAT_PROP = #{platProp,jdbcType=VARCHAR},
			</if>
			<if test="subPlatProp != null" >
				SUB_PLAT_PROP = #{subPlatProp,jdbcType=VARCHAR},
			</if>
			<if test="setupDt != null" >
				SETUP_DT = #{setupDt,jdbcType=TIMESTAMP},
			</if>
			<if test="closeDt != null" >
				CLOSE_DT = #{closeDt,jdbcType=TIMESTAMP},
			</if>
			<if test="regAdd != null " >
				REG_ADD = #{regAdd,jdbcType=VARCHAR},
			</if>
			<if test="orgnCode != null" >
				ORGN_CODE = #{orgnCode,jdbcType=VARCHAR},
			</if>
			<if test="legalPerson != null " >
				LEGAL_PERSON = #{legalPerson,jdbcType=VARCHAR},
			</if>
			<if test="custodianBank != null " >
				CUSTODIAN_BANK = #{custodianBank,jdbcType=VARCHAR},
			</if>
			<if test="regCapital != null " >
				REG_CAPITAL = #{regCapital,jdbcType=NUMERIC},
			</if>
			<if test="regCurrency != null " >
				REG_CURRENCY = #{regCurrency,jdbcType=VARCHAR},
			</if>
			<if test="capitalAccount != null " >
				CAPITAL_ACCOUNT = #{capitalAccount,jdbcType=VARCHAR},
			</if>
			<if test="returnAccount != null " >
				RETURN_ACCOUNT = #{returnAccount,jdbcType=VARCHAR},
			</if>
			<if test="fundSts != null" >
				FUND_STS = #{fundSts,jdbcType=VARCHAR},
			</if>
			<if test="descFile != null " >
				DESC_FILE = #{descFile,jdbcType=VARCHAR},
			</if>
			<if test="fundSrc != null " >
				FUND_SRC = #{fundSrc,jdbcType=VARCHAR},
			</if>
			<if test="createBy != null " >
				CREATE_BY = #{createBy,jdbcType=VARCHAR},
			</if>
			<if test="createDt != null" >
				CREATE_DT = #{createDt,jdbcType=TIMESTAMP},
			</if>
			<if test="updateBy != null and updateBy != ''" >
				UPDATE_BY = #{updateBy,jdbcType=VARCHAR},
			</if>
			<if test="updateDt != null" >
				UPDATE_DT = #{updateDt,jdbcType=TIMESTAMP},
			</if>
			<if test="fundGenre != null " >
				FUND_GENRE = #{fundGenre,jdbcType=VARCHAR},
			</if>
			<if test="custodianBankaccount != null " >
				CUSTODIAN_BANKACCOUNT = #{custodianBankaccount,jdbcType=VARCHAR},
			</if>
			<if test="capitalBank != null" >
				CAPITAL_BANK = #{capitalBank,jdbcType=VARCHAR},
			</if>
			<if test="returnBank != null" >
				RETURN_BANK = #{returnBank,jdbcType=VARCHAR},
			</if>
			<if test="partners != null " >
				PARTNERS = #{partners,jdbcType=VARCHAR},
			</if>
			<if test="groupId != null and groupId != ''" >
				GROUP_ID = #{groupId,jdbcType=NUMERIC},
			</if>
			<if test="gpId != null " >
				GP_ID = #{gpId,jdbcType=VARCHAR},
			</if>
			<if test="rmbRaiseAmount != null " >
				RMB_RAISE_AMOUNT = #{rmbRaiseAmount,jdbcType=NUMERIC},
			</if>
			<if test="currentAmount != null " >
				CURRENT_AMOUNT = #{currentAmount,jdbcType=NUMERIC},
			</if>
			<if test="currentCurrency != null" >
				CURRENT_CURRENCY = #{currentCurrency,jdbcType=VARCHAR},
			</if>
			<if test="rmbCurrentAmount != null " >
				RMB_CURRENT_AMOUNT = #{rmbCurrentAmount,jdbcType=NUMERIC},
			</if>
			<if test="maintenanceId != null" >
				MAINTENANCE_ID = #{maintenanceId,jdbcType=VARCHAR},
			</if>
			<if test="maintenance != null " >
				MAINTENANCE = #{maintenance,jdbcType=VARCHAR},
			</if>
			<if test="socialCode != null " >
				SOCIAL_CODE = #{socialCode,jdbcType=VARCHAR},
			</if>
			<if test="keyPersonLock != null" >
				KEY_PERSON_LOCK = #{keyPersonLock,jdbcType=VARCHAR},
			</if>
			<if test="ratioInGp != null " >
				RATIO_IN_GP = #{ratioInGp,jdbcType=NUMERIC},
			</if>
			<if test="rmbPlanAmount != null " >
				RMB_PLAN_AMOUNT = #{rmbPlanAmount,jdbcType=NUMERIC},
			</if>
			<if test="fundScope != null " >
				FUND_SCOPE = #{fundScope,jdbcType=VARCHAR},
			</if>
			<if test="yhRatioAsLp != null " >
				YH_RATIO_AS_LP = #{yhRatioAsLp,jdbcType=NUMERIC},
			</if>
			<if test="yhRatioInGp != null " >
				YH_RATIO_IN_GP = #{yhRatioInGp,jdbcType=NUMERIC},
			</if>
			<if test="yhRatioInMc != null " >
				YH_RATIO_IN_MC = #{yhRatioInMc,jdbcType=NUMERIC},
			</if>
			<if test="email != null " >
				EMAIL = #{email,jdbcType=VARCHAR},
			</if>
			<if test="enteId != null " >
				ENTE_ID = #{enteId,jdbcType=VARCHAR},
			</if>
			<if test="emailPassword != null" >
				EMAIL_PASSWORD = #{emailPassword,jdbcType=VARCHAR},
			</if>
			<if test="financeId != null" >
				FINANCE_ID = #{financeId,jdbcType=VARCHAR},
			</if>
			<if test="financeName != null " >
				FINANCE_NAME = #{financeName,jdbcType=VARCHAR},
			</if>
			<if test="executivePartnerId != null " >
				EXECUTIVE_PARTNER_ID = #{executivePartnerId,jdbcType=VARCHAR},
			</if>
			<if test="executivePartnerName != null " >
				EXECUTIVE_PARTNER_NAME = #{executivePartnerName,jdbcType=VARCHAR},
			</if>
			<if test="isFit != null " >
				IS_FIT = #{isFit,jdbcType=VARCHAR},
			</if>
			<if test="custodianOpenBank != null " >
				CUSTODIAN_OPEN_BANK = #{custodianOpenBank,jdbcType=VARCHAR},
			</if>
			<if test="custodianBankNum != null " >
				CUSTODIAN_BANK_NUM = #{custodianBankNum,jdbcType=VARCHAR},
			</if>
			<if test="isRecord != null" >
				IS_RECORD = #{isRecord,jdbcType=VARCHAR},
			</if>
			<if test="recordCode != null and recordCode != ''" >
				RECORD_CODE = #{recordCode,jdbcType=VARCHAR},
			</if>
			<if test="recordDate != null" >
				RECORD_DATE = #{recordDate,jdbcType=TIMESTAMP},
			</if>
			<if test="recordAtta != null " >
				RECORD_ATTA = #{recordAtta,jdbcType=VARCHAR},
			</if>
			<if test="isCustodian!= null " >
				IS_CUSTODIAN = #{isCustodian,jdbcType=VARCHAR},
			</if>
			<if test="custodianAtta != null " >
				CUSTODIAN_ATTA = #{custodianAtta,jdbcType=VARCHAR},
			</if>
			<if test="isAuth != null and isAuth != ''" >
				IS_AUTH = #{isAuth,jdbcType=VARCHAR},
			</if>
			<if test="authAtta != null and authAtta != ''" >
				AUTH_ATTA = #{authAtta,jdbcType=VARCHAR},
			</if>
			<if test="promiseAmount != null " >
				PROMISE_AMOUNT = #{promiseAmount,jdbcType=NUMERIC},
			</if>
			<if test="profitAmount != null " >
				PROFIT_AMOUNT = #{profitAmount,jdbcType=NUMERIC},
			</if>
			<if test="status != null and status != ''" >
				STATUS = #{status,jdbcType=VARCHAR},
			</if>
			<if test="inveCurrentAmount != null " >
				INVE_CURRENT_AMOUNT = #{inveCurrentAmount,jdbcType=NUMERIC},
			</if>
			<if test="spvType != null " >
				SPV_TYPE = #{spvType,jdbcType=VARCHAR},
			</if>
			<if test="isExcept != null" >
				IS_EXCEPT = #{isExcept,jdbcType=VARCHAR},
			</if>
			<if test="inveRaiseAmount != null" >
				INVE_RAISE_AMOUNT = #{inveRaiseAmount,jdbcType=NUMERIC},
			</if>
			<if test="isLead != null " >
				IS_LEAD = #{isLead,jdbcType=VARCHAR},
			</if>
			<if test="isExit != null " >
				IS_EXIT = #{isExit,jdbcType=VARCHAR},
			</if>
			<if test="financeAmount != null" >
				FINANCE_AMOUNT = #{financeAmount,jdbcType=VARCHAR},
			</if>
			<if test="inveType != null " >
				INVE_TYPE = #{inveType,jdbcType=VARCHAR},
			</if>
			<if test="appDep != null " >
				APP_DEP = #{appDep,jdbcType=VARCHAR},
			</if>
			<if test="govFundSrc != null " >
				GOV_FUND_SRC = #{govFundSrc,jdbcType=VARCHAR},
			</if>
			<if test="basis != null" >
				BASIS = #{basis,jdbcType=VARCHAR},
			</if>
			<if test="inveLimit != null" >
				INVE_LIMIT = #{inveLimit,jdbcType=VARCHAR},
			</if>
			<if test="manDep != null " >
				MAN_DEP = #{manDep,jdbcType=VARCHAR},
			</if>
			<if test="shortName != null " >
				SHORT_NAME = #{shortName,jdbcType=VARCHAR},
			</if>
			<if test="fundsType != null and fundsType != ''" >
				FUNDS_TYPE = #{fundsType,jdbcType=VARCHAR},
			</if>
			<if test="parentId != null" >
				PARENT_ID = #{parentId,jdbcType=VARCHAR},
			</if>
			<if test="fundCategory != null " >
				FUNDCATEGORY = #{fundCategory,jdbcType=VARCHAR},
			</if>
			<if test="oldSubPlatProp != null a" >
				OLD_SUB_PLAT_PROP = #{oldSubPlatProp,jdbcType=VARCHAR},
			</if>
			<if test="isDirect != null " >
				ISDIRECT = #{isDirect,jdbcType=VARCHAR},
			</if>
			<if test="isDesignate != null " >
				IS_DESIGNATE = #{isDesignate,jdbcType=VARCHAR},
			</if>
		</set>
		WHERE FUND_ID = #{fundId,jdbcType=VARCHAR}
	</update>

	<select id="selectByProjNum" parameterType="java.lang.String" resultType="Integer">
      SELECT  COUNT(1) FROM TZ_T_PROJ_INFO P
      where
      p.inve_id=#{fundId}
      and p.PROJ_STATUS not in('1', '9','10', '11','12')
      and p.status!='2' and proj_type='1'


	</select>

	<select id="getInfoListPage" resultMap="FundInfoResult" parameterType="com.founder.ssm.core.common.SearchCondition">
		<include refid="searchSql33" />
	</select>
	<sql id="searchSql33">
        select a.*,g.CREDIT_CODE   from EI.BD_T_FUND_INFO a
        left join MASTER.T_ENT_BASE_INFO g on g.ENTERPRISE_ID=a.ENTE_ID
		<if test='paramMap.fundSrc=="2"' >
         left join tz_t_proj_info c on a.fund_id=c.proj_object and proj_type in(2,4,5) and c.status!='2'
		</if>
		<where>
		    a.status!='2'
			<include refid="searchCondition.searchClause" />
			<if test='paramMap.fundSrc=="1"' >
				and a.fund_src in(2)
				<if test='paramMap.userId != null and paramMap.userId != ""' >
					and a.fund_id in(select FUND_ID from BD_T_FUND_USER_RELATE FU
					WHERE FU.USER_ID=#{paramMap.userId})
				</if>
			</if>
			<if test='paramMap.fundSrc=="2"' >
				and a.fund_src in(2,4,5)
				<if test='paramMap.userId != null and paramMap.userId != ""' >
					and c.inve_id in(select FUND_ID from BD_T_FUND_USER_RELATE FU
					WHERE FU.USER_ID=#{paramMap.userId})
				</if>
			</if>
			<if test='paramMap.keyWord != null and paramMap.keyWord != ""' >
				and a.FUND_NAME like ${paramMap.keyWord}
			</if>
		</where>
		ORDER BY a.FUND_ID DESC
	</sql>

	<select id="selectInveListPage" resultMap="FundInfoResult" parameterType="com.founder.ssm.core.common.SearchCondition">
		<include refid="searchInveSql" />
	</select>
	<sql id="searchInveSql">
		select bb.*  FROM  EI.BD_T_FUND_INFO bb
		left join EI.TZ_T_PROJ_INFO a on
		a.proj_type='2'
		and a.proj_object=bb.fund_id and a.status!='2'
		<where>
			<include refid="searchCondition.searchClause" />
			<if test='paramMap.fundsType=="1" ' >
				and ( (bb.ISDIRECT='1' and bb.group_id='3' and bb.OLD_SUB_PLAT_PROP in(1,7))or(  bb.group_id in(1,2) and bb.ISDIRECT='1' and a.proj_status in(5,15,7,8)))
			</if>
			<if test='paramMap.keyWord != null and paramMap.keyWord != ""' >
				and (bb.fund_name like ${paramMap.keyWord})
			</if>
			<if test='paramMap.USER_ID != null and paramMap.USER_ID != ""' >
				and bb.FUND_ID IN (select FUND_ID from BD_T_FUND_USER_RELATE FU
				WHERE FU.USER_ID=#{paramMap.USER_ID})
			</if>
		</where>
		ORDER BY bb.UPDATE_DT DESC
	</sql>

	<resultMap id="NjFundInfoResult" type="com.ppmg.ei.model.NjFundInfoModel">
		<result column="FUND_ID" property="fundId" jdbcType="VARCHAR" />
		<result column="FUND_CODE" property="fundCode" jdbcType="VARCHAR" />
		<result column="FUND_NAME" property="fundName" jdbcType="VARCHAR" />
		<result column="REG_NAME" property="regName" jdbcType="VARCHAR" />
		<result column="MC_ID" property="mcId" jdbcType="VARCHAR" />
		<result column="MC_NAME" property="mcName" jdbcType="VARCHAR" />
		<result column="GP" property="gp" jdbcType="VARCHAR" />
		<result column="CONTACT" property="contact" jdbcType="VARCHAR" />
		<result column="PHONE_NO" property="phoneNo" jdbcType="VARCHAR" />
		<result column="CONTACT_EMAIL" property="contactEmail" jdbcType="VARCHAR" />
		<result column="PLAN_AMOUNT" property="planAmount" jdbcType="NUMERIC" />
		<result column="PLAN_CURR" property="planCurr" jdbcType="VARCHAR" />
		<result column="RAISE_AMOUNT" property="raiseAmount" jdbcType="NUMERIC" />
		<result column="RAISE_CURRENCY" property="raiseCurrency" jdbcType="VARCHAR" />
		<result column="FUND_STRUCT" property="fundStruct" jdbcType="VARCHAR" />
		<result column="PLAT_PROP" property="platProp" jdbcType="VARCHAR" />
		<result column="SUB_PLAT_PROP" property="subPlatProp" jdbcType="VARCHAR" />
		<result column="SETUP_DT" property="setupDt" jdbcType="TIMESTAMP" />
		<result column="CLOSE_DT" property="closeDt" jdbcType="TIMESTAMP" />
		<result column="REG_ADD" property="regAdd" jdbcType="VARCHAR" />
		<result column="ORGN_CODE" property="orgnCode" jdbcType="VARCHAR" />
		<result column="LEGAL_PERSON" property="legalPerson" jdbcType="VARCHAR" />
		<result column="CUSTODIAN_BANK" property="custodianBank" jdbcType="VARCHAR" />
		<result column="REG_CAPITAL" property="regCapital" jdbcType="NUMERIC" />
		<result column="REG_CURRENCY" property="regCurrency" jdbcType="VARCHAR" />
		<result column="CAPITAL_ACCOUNT" property="capitalAccount" jdbcType="VARCHAR" />
		<result column="RETURN_ACCOUNT" property="returnAccount" jdbcType="VARCHAR" />
		<result column="FUND_STS" property="fundSts" jdbcType="VARCHAR" />
		<result column="DESC_FILE" property="descFile" jdbcType="VARCHAR" />
		<result column="FUND_SRC" property="fundSrc" jdbcType="VARCHAR" />
		<result column="CREATE_BY" property="createBy" jdbcType="VARCHAR" />
		<result column="CREATE_DT" property="createDt" jdbcType="TIMESTAMP" />
		<result column="UPDATE_BY" property="updateBy" jdbcType="VARCHAR" />
		<result column="UPDATE_DT" property="updateDt" jdbcType="TIMESTAMP" />
		<result column="FUND_GENRE" property="fundGenre" jdbcType="VARCHAR" />
		<result column="CUSTODIAN_BANKACCOUNT" property="custodianBankaccount" jdbcType="VARCHAR" />
		<result column="CAPITAL_BANK" property="capitalBank" jdbcType="VARCHAR" />
		<result column="RETURN_BANK" property="returnBank" jdbcType="VARCHAR" />
		<result column="PARTNERS" property="partners" jdbcType="VARCHAR" />
		<result column="GROUP_ID" property="groupId" jdbcType="NUMERIC" />
		<result column="GP_ID" property="gpId" jdbcType="VARCHAR" />
		<result column="RMB_RAISE_AMOUNT" property="rmbRaiseAmount" jdbcType="NUMERIC" />
		<result column="IS_LEAD" property="isLead" jdbcType="VARCHAR" />
		<result column="BASIS" property="basis" jdbcType="VARCHAR" />
		<result column="APP_DEP" property="appDep" jdbcType="VARCHAR" />
		<result column="INVE_LIMIT" property="inveLimit" jdbcType="VARCHAR" />
		<result column="MAN_DEP" property="manDep" jdbcType="VARCHAR" />
		<result column="PARENT_ID" property="parentId" jdbcType="VARCHAR" />
		<result column="DATA_SRC" property="dataSrc" jdbcType="VARCHAR" />
		<result column="FUND_CODE_TYPE" property="fundCodeType" jdbcType="VARCHAR" />
		<result column="REG_DT" property="regDt" jdbcType="TIMESTAMP" />
		<result column="REG_CODE" property="regCode" jdbcType="VARCHAR" />
		<result column="INVE_TYPE" property="inveType" jdbcType="VARCHAR" />
		<result column="REG_DATE" property="regDate" jdbcType="TIMESTAMP" />
		<result column="IS_EXIT" property="isExit" jdbcType="VARCHAR" />
		<result column="FINANCE_AMOUNT" property="financeAmount" jdbcType="NUMERIC" />
		<result column="IS_FIT" property="isFit" jdbcType="VARCHAR" />
		<result column="REP_NAME" property="repName" jdbcType="VARCHAR" />
		<result column="REP_ID" property="repId" jdbcType="VARCHAR" />
		<result column="MOTHER_FUND_ID" property="motherFundId" jdbcType="VARCHAR" />
		<result column="MOTHER_FUND_NAME" property="motherFundName" jdbcType="VARCHAR" />
		<result column="FUND_CODE_SIGN" property="fundCodeSign" jdbcType="VARCHAR" />
	</resultMap>

	<select id="getJcFundList" resultMap="NjFundInfoResult" parameterType="com.founder.ssm.core.common.SearchCondition">
		select * from EINJ.BD_t_fund_info
		<where>
			and fund_id not in(11277,11278,11279,11280,11281,11282,11283,11284,11285,11286,11287,11265,11276)
			<if test="searchBean.keyword!='' and searchBean.keyword!=null">
				<bind name="pattern" value="'%' + searchBean.keyword + '%'" />
				AND ( FUND_NAME like #{pattern} OR FUND_CODE like #{pattern} )
			</if>
			<include refid="searchCondition.searchClause" />
		</where>
		order by UPDATE_DT desc
	</select>

<select id="selectJcInveListPage"  resultMap="FundInfoResult" parameterType="com.founder.ssm.core.common.SearchCondition">
	 select * from EI.BD_T_FUND_INFO
		<where>
				<if test='paramMap.keyWord != null and paramMap.keyWord != ""' >
					and FUND_NAME like ${paramMap.keyWord}
				</if>
				<include refid="searchCondition.searchClause" />
		</where>

</select>
	<!--首页统计begin -->
	<!--获取 二级基金投三级基金数 -->

	<select id="getsumfund"  resultType="Map" parameterType="java.lang.String">
		select sum(gs) as SUMFUN,sum(sumTwoCurrentAmount) as SUMTWOCURRENTAMOUNT from (
		select * from
		(select count(*) as gs,sum(aa.CURRENT_AMOUNT) as sumTwoCurrentAmount from EI.BD_T_FUND_INFO aa inner join tz_t_proj_info bb on aa.FUND_ID=bb.PROJ_OBJECT
		and aa.fund_src in(2,4) and aa.group_id='1' and aa.status='1'
		and bb.PROJ_TYPE in(2,4) and bb.group_id='1' and bb.status='1'
		and bb.PROJ_STATUS not in(1,10,11,4,6,2,3,9)
		inner join
		(select a.FUND_ID from
		BD_T_FUND_INFO a
		where a.FUND_SRC='1' and a.FUND_ID!='0'
		and a.status='1'
		and a.fund_sts not in(1,10,11,4,6,2,3,9) and a.group_id='1'
		<![CDATA[and nvl(a.IS_EXCEPT,'0')<1]]>
		) bbb on bbb.FUND_ID=bb.inve_id
		)
		UNION all
		(select count(*) as gs,sum(mmm.CURRENT_AMOUNT) as sumTwoCurrentAmount  from (select a.FUND_ID from
		BD_T_FUND_INFO a
		where a.FUND_SRC='1' and a.FUND_ID!='0'
		and a.status='1'
		and a.fund_sts not in(1,10,11,4,6,2,3,9) and a.group_id='1' and a.IS_EXCEPT='1')aa
		inner join EI.tz_t_proj_info ee on ee.inve_id=aa.fund_id and ee.proj_type in(2,4) and ee.PROJ_STATUS not in(1,10,11,4,6,2,3,9) and ee.status='1'
		inner join EI.BD_T_FUND_INFO ff on ff.fund_id=ee.proj_object and ff.group_id='1' and ff.FUND_SRC in(2,4) and ff.status='1'
		inner join EI.tz_t_proj_info mm on mm.inve_id=ff.FUND_ID and mm.proj_type='5' and mm.status!='2' and  mm.PROJ_STATUS not in(1,10,11,4,6,2,3,9)
		inner join EI.BD_T_FUND_INFO mmm on mmm.FUND_ID=mm.proj_object and mmm.fund_src='5' and mmm.status!='2'
		)
		)ppp

	</select>

	<select id="getSumProj" resultType="Map" parameterType="java.lang.String">
		select sum(ttt.gs) as SUMPROJ,sum(ttt.PAY_AMOUNT) as SUMTWOPAY ,sum(ttt.qtAmount) as QTAMOUNT from (
		  select count(DISTINCT aaa.proj_id) as gs,sum(SUM_ACTUAL_PAY_AMOUNT) as PAY_AMOUNT,(sum(m.FINA_AMOUNT)-sum(m.ACTUAL_AMOUNT))as qtAmount from EI.tz_t_proj_info aaa
		inner join  EI.BD_T_FUND_INFO a on a.FUND_ID=aaa.inve_id
		LEFT JOIN   EI.TZ_T_PROJ_APP_INFO  m on m.proj_id=aaa.PROJ_ID
		left join (
		select sum(DECODE(aa.RMB_ACTUAL_PAY_AMOUNT, null, aa.ACTUAL_PAY_AMOUNT,aa.RMB_ACTUAL_PAY_AMOUNT)) as SUM_ACTUAL_PAY_AMOUNT,     PROJECT_OR_FUND_ID  from XJL_T_PAYMENT_REQUEST aa where aa.status!='9'
		group by PROJECT_OR_FUND_ID
		)f on aaa.proj_id=f.PROJECT_OR_FUND_ID
		where
		a.FUND_SRC='1'
		and a.status='1'
		and a.fund_sts not in(1,10,11,4,6,2,3,9)
		and a.group_id='1'
		<![CDATA[and nvl(a.IS_EXCEPT,'0')<1]]>
		and aaa.proj_type='1'
		and aaa.PROJ_STATUS not in(1,10,11,4,6,2,3,9)
		and aaa.group_id='1'
		and aaa.status='1'
		UNION all
		select count(DISTINCT tt.proj_id) ,sum(SUM_ACTUAL_PAY_AMOUNT)as PAY_AMOUNT ,(sum(m.FINA_AMOUNT)-sum(m.ACTUAL_AMOUNT)) as qtAmount from (
		select a.FUND_ID from
		BD_T_FUND_INFO a
		where a.FUND_SRC='1'
		 and a.FUND_ID!='0'
		 and a.status='1'
		and a.fund_sts not in(1,10,11,4,6,2,3,9) and a.group_id='1' and a.IS_EXCEPT='1')aa
		inner join EI.tz_t_proj_info ee on ee.inve_id=aa.fund_id
		and ee.proj_type in(2,4)
		and ee.PROJ_STATUS not in(1,10,11,4,6,2,3,9)
		and ee.status='1'
		and  ee.group_id='1'
		inner join EI.BD_T_FUND_INFO ff on ff.fund_id=ee.proj_object
		and ff.group_id='1'
		and ff.FUND_SRC in(2,4)
		and ff.status='1'
		inner join EI.tz_t_proj_info tt on tt.inve_id=ff.FUND_ID
		and tt.proj_type='3'
		and tt.group_id='1'
		and tt.status='1'
		and tt.proj_status not in(1,10,11,4,6,2,3,9)
		LEFT JOIN   EI.TZ_T_PROJ_APP_INFO  m on m.proj_id=tt.PROJ_ID
		left join(	select sum(DECODE(aa.RMB_ACTUAL_PAY_AMOUNT, null, aa.ACTUAL_PAY_AMOUNT,aa.RMB_ACTUAL_PAY_AMOUNT)) as SUM_ACTUAL_PAY_AMOUNT,     PROJECT_OR_FUND_ID  from XJL_T_PAYMENT_REQUEST aa where aa.status!='9'
		group by PROJECT_OR_FUND_ID
		)f on tt.proj_id=f.PROJECT_OR_FUND_ID
		)ttt
</select>

	<select id="getSumCurrAmount" resultType="Map">
	select sum(CURRENT_AMOUNT)as SUMCURRAMOUNT
        from EI.BD_T_FUND_INFO a
	   where
		    a.status!='2'
		  and ((a.GROUP_ID in(1) and a.fund_src='0') or (a.group_id='2' and a.OLD_SUB_PLAT_PROP='1' ))
	</select>
	<select id="getSumPay" resultType="Map">
		  select sum(RMB_ACTUAL_PAY_AMOUNT) as SUMPAY from XJL_T_PAYMENT_REQUEST where PROJECT_OR_FUND_ID in(
        select proj_id from TZ_T_PROJ_INFO where inve_id in(
        select fund_id
        from EI.BD_T_FUND_INFO a
		where
		    a.status!='2'
		    and ((a.GROUP_ID in(1) and a.fund_src='0') or (a.group_id='2' and a.OLD_SUB_PLAT_PROP='1' ))
			)
         and status!='2'
         and proj_status not in(1,10,11,12,2,3,9,13,14)
         and proj_type in(1,2,4)
       ) and STATUS=4

	</select>

	<select id="getCountFund" resultType="Map" parameterType="java.lang.String">
	 select count(*) as COUNTFUND
      from TZ_T_PROJ_INFO a
      inner join bd_t_fund_info c on a.PROJ_OBJECT=c.fund_id and a.PROJ_TYPE='2'  and c.status!='2'
	  where
		a.status!='2' and
			 a.PROJ_STATUS not in('1', '9', '10', '11','12','2','3','13','14') and
			 a.inve_id in(
			 select fund_id
            from EI.BD_T_FUND_INFO a
		   where
		     a.status!='2'
		     and ((a.GROUP_ID in(1) and a.fund_src='0') or (a.group_id='2' and a.OLD_SUB_PLAT_PROP='1' ))
			)
	</select>
	<select id="getCountS"  resultType="Map" parameterType="java.lang.String">
      select count(DECODE(PROJ_STATUS, '13', 1,null)) as COUNTAPP,
      count(DECODE(PROJ_STATUS, '5', 1,null)) as COUNTPOLICY,
      count(DECODE(PROJ_STATUS, '9', 1,null)) as COUNTOUT
      from TZ_T_PROJ_INFO a
		where 1=1
		and a.inve_id in(
					select fund_id
					from EI.BD_T_FUND_INFO a
					where
						a.status!='2'
					  and ((a.GROUP_ID in(1) and a.fund_src='0') or (a.group_id='2' and a.OLD_SUB_PLAT_PROP='1' ))
					 )



	</select>
	<select id="getCountProj" resultType="Map" parameterType="java.lang.String">
        select sum(SUM_ACTUAL_PAY_AMOUNT) as SUMRMBACTUALPAYAMOUNT ,count(1) as COUNTPROJ
        from EI.TZ_T_PROJ_INFO bb
	  inner join EI.BD_T_FUND_INFO ff on ff.fund_id=bb.inve_id
	  left join (select sum(RMB_ACTUAL_PAY_AMOUNT) as SUM_ACTUAL_PAY_AMOUNT,PROJECT_OR_FUND_ID  from XJL_T_PAYMENT_REQUEST  where 1=1 AND  STATUS=4
			group by PROJECT_OR_FUND_ID)aa on aa.PROJECT_OR_FUND_ID=bb.proj_id
	  WHERE ff.ISDIRECT='1' and proj_type='1'
	  and bb.status!='2' and bb.proj_status not in(1,10,11,12,2,3,13,14,9)
	  and bb.inve_id in(
	select bb.fund_id  FROM  EI.BD_T_FUND_INFO bb
		left join EI.TZ_T_PROJ_INFO a on
		a.proj_type='2'
		and a.proj_object=bb.fund_id and a.status!='2'
		where
		 1=1 and bb.STATUS!='2'
		and ( (bb.ISDIRECT='1' and bb.group_id='3' and bb.OLD_SUB_PLAT_PROP in(1,7))or(  bb.group_id in(1,2) and bb.ISDIRECT='1' and a.proj_status in(5,15,7,8)))
    )

	</select>

	<select id="countOtherProj" resultType="Map" parameterType="java.lang.String">
		select count(DECODE(PROJ_STATUS, '1', 1,null))as COUNTCB,count(DECODE(PROJ_STATUS, '13', 1,null))as COUNTLX,count(DECODE(PROJ_STATUS, '5', 1,null))as COUNTJC,count(DECODE(PROJ_STATUS, '9', 1,null))as COUNTTC
		from EI.TZ_T_PROJ_INFO bb
		inner join EI.BD_T_FUND_INFO ff on ff.fund_id=bb.inve_id
		WHERE
		ff.ISDIRECT='1'
		and proj_type='1'
		and bb.status!='2'
		and ff.status!='2'
		and bb.inve_id in(
		select bb.fund_id  FROM  EI.BD_T_FUND_INFO bb
		left join EI.TZ_T_PROJ_INFO a on
		a.proj_type='2'
		and a.proj_object=bb.fund_id and a.status!='2'
		where
		 1=1 and bb.STATUS!='2'
	   and ( (bb.ISDIRECT='1' and bb.group_id='3' and bb.OLD_SUB_PLAT_PROP in(1,7))or(  bb.group_id in(1,2) and bb.ISDIRECT='1' and a.proj_status in(5,15,7,8)))
     )

	</select>

	<select id="countHyProj" resultType="Map" parameterType="java.lang.String">
        select count(distinct proj_object) as HYPROJ from EI.TZ_T_PROJ_INFO where
	   PROJ_TYPE ='1'
	   AND group_id='4'
	   and status!='2'
	   AND PROJ_STATUS NOT IN(1,10,11,4,6,2,3,9,14)

	</select>


	<select id="countHyProjPay" resultType="Map" parameterType="java.lang.String">
        select sum(b.RMB_ACTUAL_PAY_AMOUNT)as COUNTPAYHY from EI.TZ_T_PROJ_INFO a
       inner join XJL_T_PAYMENT_REQUEST b on a.proj_id=b.PROJECT_OR_FUND_ID
		where
	   a.PROJ_TYPE ='1'
	   AND a.group_id='4'
	   and a.status!='2'
	   AND a.PROJ_STATUS NOT IN(1,10,11,4,6,2,3,9,14)
	   and b.status='4'
	</select>

	<select id="countOtherHyProj" resultType="Map" parameterType="java.lang.String">
	 select
	 count(DECODE(PROJ_STATUS, '1', 1,null))as COUNTHYCB,
	 count(DECODE(PROJ_STATUS, '5', 1,null))as COUNTHYLX,
	 count(DECODE(PROJ_STATUS, '9', 1,null))as COUNTHYTC
	 from EI.TZ_T_PROJ_INFO where  PROJ_TYPE ='1' AND group_id='4' and status!='2'

	</select>

	<select id="getFunpermission" resultType="Map" parameterType="Map">
		  select f.* from APP_USER a
		inner join BASE.APP_USERROLE b on a.id=b.USERID
		inner join BASE.APP_ROLE d on d.id=b.ROLEID
		inner join BASE.APP_ROLEFUNCPERMISSION c on c.ROLEID=d.id
		inner join BASE.APP_FUNC_PERMISSION f on f.id=c.PERMISSIONID
		where f.FATHERID=#{fatherId}
			  and a.id=#{userId}

    </select>

	<select id="getThreeSumProj" resultType="Map" parameterType="java.lang.String">
		select sum(trC) as THREECOUNT ,sum(trA) as THREESUMPAY ,sum(qtAmount)as QTAMOUNT from (
		select count(d.proj_id) as trC,sum(f.SUM_ACTUAL_PAY_AMOUNT) as trA,(sum(m.FINA_AMOUNT)-sum(m.ACTUAL_AMOUNT))as qtAmount
		from EI.BD_T_FUND_INFO a inner join EI.tz_t_proj_info b ON a.fund_id=b.inve_id
		and a.fund_src='1'
		<![CDATA[and nvl(a.IS_EXCEPT,'0')<1]]>
		and a.group_id='1'
		and a.status='1'
		and b.PROJ_STATUS not in(1,10,11,4,6,2,3,9,12)
		and a.fund_sts not in(1,10,11,4,6,2,3,9,12)
		and b.proj_type in(2,4) and b.status='1'
		inner join EI.BD_T_FUND_INFO c on b.proj_object=c.FUND_ID and c.status='1' and c.fund_src in(2,4)
		inner join EI.tz_t_proj_info d on d.inve_id=c.FUND_ID and d.proj_type='3' and d.status!='2'
		and d.PROJ_STATUS not in(1,10,11,4,6,2,3,9,12)
		LEFT JOIN  EI.TZ_T_PROJ_APP_INFO  m on m.proj_id=d.PROJ_ID
		left join (
		select sum(ACTUAL_PAY_AMOUNT) as SUM_ACTUAL_PAY_AMOUNT, PROJECT_OR_FUND_ID  from XJL_T_PAYMENT_REQUEST aa where aa.status!='9'
		group by PROJECT_OR_FUND_ID
		)f on d.proj_id=f.PROJECT_OR_FUND_ID
		UNION ALL
		select count(g.proj_id),sum(f.ACTUAL_PAY_AMOUNT),(sum(m.FINA_AMOUNT)-sum(m.ACTUAL_AMOUNT))as qtAmount from
		EI.BD_T_FUND_INFO a inner join EI.tz_t_proj_info b ON a.fund_id=b.inve_id
		and a.fund_src='1'
		and a.IS_EXCEPT='1'
		and a.group_id='1'
		and a.status!='2'
		and b.PROJ_STATUS not in(1,10,11,4,6,2,3,9,12)
		and a.fund_sts not in(1,10,11,4,6,2,3,9,12)
		and b.proj_type in(2,4)
		inner join EI.BD_T_FUND_INFO c on b.proj_object=c.FUND_ID and c.status!='2' and c.fund_src in(2,4)
		inner join EI.tz_t_proj_info d on d.inve_id=c.FUND_ID AND d.PROJ_TYPE='5' and d.status!='2'
		and d.PROJ_STATUS not in(1,10,11,4,6,2,3,9,12)
		inner join  EI.BD_T_FUND_INFO f on d.proj_object=f.fund_id and f.fund_src='5' and f.status!='2'
		inner join EI.tz_t_proj_info g on f.fund_id=g.inve_id and g.proj_object not in(1,10,11,4,6,2,3,9,12)
		and g.status!='2' and g.proj_type='6'
		LEFT JOIN   EI.TZ_T_PROJ_APP_INFO  m on m.proj_id=d.PROJ_ID
		left join (
		select sum(ACTUAL_PAY_AMOUNT) as ACTUAL_PAY_AMOUNT, PROJECT_OR_FUND_ID  from XJL_T_PAYMENT_REQUEST aa where aa.status!='9'
		group by PROJECT_OR_FUND_ID
		)f on d.proj_id=f.PROJECT_OR_FUND_ID

		)

	</select>

	<select id="getSumQtThreeProj" resultType="Map" parameterType="java.lang.String">
		select sum(aaa.tsQtAmount) as TSQTAMOUNT from( select (sum(nvl(c.CURRENT_AMOUNT,0))-sum(nvl(f.INVE_CURRENT_AMOUNT,0)))as tsQtAmount
		from EI.BD_T_FUND_INFO a
		inner join EI.tz_t_proj_info b ON a.fund_id=b.inve_id
		and a.fund_src='1'
        <![CDATA[and nvl(a.IS_EXCEPT,'0')<1]]>
		and a.group_id='1'
		and a.status='1'
		and b.PROJ_STATUS not in(1,10,11,4,6,2,3,9,12,13,14)
		and a.fund_sts not in(1,10,11,4,6,2,3,9,12,13,14)
		and b.proj_type in(2,4)
		inner join EI.BD_T_FUND_INFO c on b.proj_object=c.FUND_ID and c.status!='2' and c.fund_src in(2,4)
		left join EI.TZ_T_PROJ_APP_INFO f on f.PROJ_ID=b.PROJ_NO
		union all
		select sum(nvl(g.CURRENT_AMOUNT,0))-sum(nvl(f.INVE_CURRENT_AMOUNT,0))
		from EI.BD_T_FUND_INFO a
		inner join EI.tz_t_proj_info b ON a.fund_id=b.inve_id
		and a.fund_src='1'
		and a.IS_EXCEPT='1'
		and a.group_id='1'
		and a.status='1'
		and b.PROJ_STATUS not in(1,10,11,4,6,2,3,9,12,13,14)
		and a.fund_sts not in(1,10,11,4,6,2,3,9,12,13,14)
		and b.proj_type in(2,4)
		inner join EI.BD_T_FUND_INFO c on b.proj_object=c.FUND_ID and c.status='1' and c.fund_src in(2,4)
		inner join EI.tz_t_proj_info d on d.inve_id=c.fund_id and d.PROJ_STATUS not in(1,10,11,4,6,2,3,9,12,13,14) and d.status!='2' and d.proj_type='5'
		inner join EI.BD_T_FUND_INFO g on g.fund_id=d.proj_object and g.fund_src='5' and g.status='1'
		left join EI.TZ_T_PROJ_APP_INFO f on f.PROJ_ID=d.PROJ_id
		)aaa

	</select>
	<!--首页统计end -->

	<select id="fundInfoInveList" resultMap="FundInfoResult" parameterType="com.founder.ssm.core.common.SearchCondition">
		  select   DISTINCT c.*
         FROM BD_T_FUND_INFO bb
    	 inner join TZ_T_PROJ_INFO ppp ON ppp.PROJ_OBJECT=bb.fund_id and proj_type in(2)  and ppp.status!='2'
		 inner JOIN BD_T_FUND_INFO c on c.fund_id=ppp.inve_id and c.status!='2'
		<where>
			bb.status!='2'
			AND (
			(bb.GROUP_ID='2' and (bb.OLD_SUB_PLAT_PROP IN (4,5)OR(bb.OLD_SUB_PLAT_PROP='2' AND bb.SUB_PLAT_PROP='4' )))
			or (bb.GROUP_ID= '1' and bb.MC_ID= '10008'  )or (bb.GROUP_ID= '1' and bb.fund_src= '1')
			)
			<if test='paramMap.keyWord != null and paramMap.keyWord != ""' >
				and c.FUND_NAME like ${paramMap.keyWord}
			</if>
			<include refid="searchCondition.searchClause" />
		</where>

	</select>

	<select id="getSumProjNum" resultType="Integer" parameterType="java.lang.String">
		select count(*) from ei.tz_t_proj_info where inve_id=#{fundId} and proj_type='1' and status!='2'
	</select>

	<select id="selectCgListPage"   resultMap="FundInfoResultStr"  parameterType="com.founder.ssm.core.common.SearchCondition">
		select a.*,b.proj_id,b.proj_name,b.inve_name,b.UPDATE_DT as upDt
		from bd_t_fund_info a
		inner join tz_t_proj_info b on b.proj_object=a.fund_id
		and b.proj_type='2' and a.status!='2' and b.status!='2' AND b.GROUP_ID!='1'
		<where>
			<if test='paramMap.typeStr=="2"' >
				a.OLD_SUB_PLAT_PROP in(4,6,5)
				and ( b.CREATE_BY=#{paramMap.loginName} or b.CREATE_BY=#{paramMap.userId} or
				b.CREATE_BY in (
				select TO_CHAR(z2.id)as id  from bd_t_fund_account_maping z1 inner join   base.app_user z2 on z1.user_id=z2.loginname where z1.is_rep is null and (z1.create_by = #{paramMap.loginName} or  z1.create_by =#{paramMap.userId} )
				)
				or  a.FUND_ID in (select z2.OBJECT_ID from GF_T_DATA_APPLY z2 where z2.USER_ID =#{paramMap.loginName} and z2.APPLY_TYPE='2' and z2.STATUS = '2'))
			</if>
			<if test='paramMap.typeStr=="3"' >
				a.OLD_SUB_PLAT_PROP in(4,6,5)
				and b.proj_status in(7,8,9,15)
			</if>
			<if test='paramMap.keyWord != null and paramMap.keyWord != ""' >
				and (a.FUND_NAME like ${paramMap.keyWord} or a.REG_NAME like ${paramMap.keyWord})
			</if>
			<if test='paramMap.typeStr=="1" ' >
				and a.mc_id in(select ADMIN_ID from BD_T_FUND_ADMIN where admin_name=#{paramMap.loginName})
				and a.OLD_SUB_PLAT_PROP in(4,6,5)
				and b.proj_status in(7,8,9,15)
			</if>
		<include refid="searchCondition.searchClause" />
	</where>
     ORDER BY b.UPDATE_DT DESC
	</select>

	<select id="getFofListPage"  resultMap="FundFofInfoResult1"  parameterType="com.founder.ssm.core.common.SearchCondition">
		select   d.update_dt as upDt,d.proj_name,d.proj_id,d.inve_id,d.inve_name,a.*,b.INVE_PERIOD,c.START_DATE,
		CASE WHEN a.CURRENT_AMOUNT != 0 AND a.CURRENT_AMOUNT != 0
		THEN   RTrim(to_char(NVL(a.RAISE_AMOUNT / a.CURRENT_AMOUNT, 0)*100, 'FM99999999990.99'), '.') || '%'
		ELSE '0%' END as PERCENT,
		(select count(*) from tz_t_proj_info aa  where aa.inve_id=a.FUND_ID and aa.proj_type='1' and aa.status!='2')as projGs,
		(select count(*) from tz_t_proj_info aa  where aa.inve_id=a.FUND_ID and aa.proj_type='2' and aa.status!='2' )as fundGs
		from bd_t_fund_info a
		inner  join tz_t_proj_info d on a.fund_id=d.proj_object and d.proj_type='2'
		left join BD_T_FUND_INVE_DESC b on a.fund_id=b.fund_id
		left join master.T_ENT_BASE_INFO c on c.ENTERPRISE_ID=a.ENTE_ID
		<if test='paramMap.typeStr=="2"' >
			inner join ei.BD_T_FUND_ACCOUNT_MAPING T on  a.REP_ID = T.ADMIN_ID
			 AND T.IS_REP = 'rep'
			and T.USER_ID = #{paramMap.loginName}
		</if>
		<where>
			a.OLD_SUB_PLAT_PROP in(2)
			<if test='paramMap.keyWord != null and paramMap.keyWord != ""' >
				and a.REG_NAME like ${paramMap.keyWord}
			</if>
			<if test='paramMap.typeStr=="3"' >
			and a.ISDIRECT!='1'
			</if>
		<!--	<if test='paramMap.typeStr=="2" ' >
				and  mc_id in(select ADMIN_ID from BD_T_FUND_ADMIN where admin_name=#{paramMap.loginName}
			</if>-->

			<include refid="searchCondition.searchClause" />
		</where>
		ORDER BY d.update_dt DESC
	</select>

	<select id="getEnteInveList"  resultMap="FundFofInfoResult1"  parameterType="com.founder.ssm.core.common.SearchCondition">
		select * from (select DISTINCT a.* from bd_t_fund_info a left join tz_t_proj_info b on b.proj_object=a.fund_id and
		b.status!='2'
		<where>
			<if test='paramMap.typeStr=="2"'>
				a.OLD_SUB_PLAT_PROP in(2,4,6,5)
				and ( a.CREATE_BY=#{paramMap.loginName} or a.CREATE_BY in (select z1.user_id from
				bd_t_fund_account_maping z1 where z1.is_rep is null and z1.create_by = #{paramMap.loginName})
				or a.FUND_ID in (select z2.OBJECT_ID from GF_T_DATA_APPLY z2 where z2.USER_ID =#{paramMap.loginName} and
				z2.APPLY_TYPE='2' and z2.STATUS = '2'))
			</if>
			<if test='paramMap.typeStr=="1"'>
				a.MC_ID in
				(select z1.ADMIN_ID from BD_T_FUND_ACCOUNT_MAPING z1 where z1.USER_ID =#{paramMap.loginName}
				)
				and a.OLD_SUB_PLAT_PROP in(4,6,5)
				and b.proj_status in(7,8,9,15)
			</if>
			<if test='paramMap.typeStr=="3"'>
				a.OLD_SUB_PLAT_PROP in(2,4,6,5)
				and b.proj_status in(7,8,9,15)
			</if>
			<if test='paramMap.keyWord != null and paramMap.keyWord != ""'>
				and a.REG_NAME like ${paramMap.keyWord}
			</if>
			<include refid="searchCondition.searchClause"/>
		</where>
		<if test='paramMap.typeStr=="2"'>
			union all
			select distinct a.* from bd_t_fund_info a left join tz_t_proj_info b on b.proj_object=a.fund_id and
			b.status!='2' and a.OLD_SUB_PLAT_PROP in(2)
			inner join ei.BD_T_FUND_ACCOUNT_MAPING T on a.REP_ID = T.ADMIN_ID
			AND T.IS_REP = 'rep'
			and T.USER_ID = #{paramMap.loginName}
		</if>
		) a where 1=1
		ORDER BY a.CREATE_DT DESC
	</select>

	<select id="selectFundExportList"  resultMap="FundExportResult"  parameterType="com.founder.ssm.core.common.SearchCondition">
		select mmop.*,klk.INVE_PROJ_NUM,klk.INVE_ENT_NUM,klk.INVE_AMT,klk.INVE_PROVINCE_NUM
		,klk.INVE_PROVINCE_AMT,klk.INVE_LISTED_NUM,klk.INVE_IPO_NUM,klk.INVE_NEW_THIRD_NUM from (select
		decode(ppo.proj_status,'9','已退出','未退出') as proj_status_name,
		ppo.*,
		(to_number(nvl(ppo.proj_gs2,0))+to_number(nvl(ppo.proj_gs1,0))) as proj_gs,
		(to_number(nvl(ppo.proj_gs3,0))+to_number(nvl(ppo.proj_gs4,0))) as ente_gs,
		(to_number(nvl(ppo.PROJ_AMOUNT2,0))+to_number(nvl(ppo.PROJ_AMOUNT1,0))) as PROJ_AMOUNT,
		(to_number(nvl(ppo.PROVINCE_GS2,0))+to_number(nvl(ppo.PROVINCE_GS1,0))) as PROVINCE_GS,
		(to_number(nvl(ppo.PROVINCE_AMOUNT2,0))+to_number(nvl(ppo.PROVINCE_AMOUNT1,0))) as PROVINCE_AMOUNT,
		(to_number(nvl(ppo.SS_GS2,0))+to_number(nvl(ppo.SS_GS1,0))) as SS_GS,
		(to_number(nvl(ppo.IPO_GS2,0))+to_number(nvl(ppo.IPO_GS1,0))) as IPO_GS,
		(to_number(nvl(ppo.NEW_BOARD_GS2,0))+to_number(nvl(ppo.NEW_BOARD_GS1,0))) as NEW_BOARD_GS
		from (select distinct
		a.proj_status,a.inve_id,a.updateDt,a.OLD_SUB_PLAT_PROP,a.inve_name,a.proj_id,a.FUND_ID,a.reg_name,a.MC_NAME,a.SETUP_DT,b.START_DATE,
		(
		to_number(nvl(c.DURATION_PERIOD,0))
		+to_number(nvl(c.INVE_PERIOD,0))
		+to_number(nvl(DECODE(c.is_ROLL_OVER,'1',ROLL_OVER,'0'),0))
		+to_number(nvl(c.PAYBACK_PERIOD,0))
		+to_number(nvl(DECODE(c.is_PAYBACK_OVER,'1',PAYBACK_OVER,'0'),0))
		+to_number(nvl(DECODE(c.is_DURATION_OVER,'1',DURATION_OVER,'0'),0))
		)as cooperation_year,
		c.INVE_PERIOD,
		c.INVE_START_DATE,
		c.INVE_END_DATE,
		a.CURRENT_AMOUNT,
		a.RAISE_AMOUNT,
		(select sum(RMB_INVE_AMOUNT) from RZ_T_FUND_SHARE_INFO aa where aa.fund_id=a.fund_id and aa.INVESTOR_ID='20064'
		)
		as JC_CURRENT_AMOUNT,
		(select sum(ac.RMB_INVE_AMOUNT) from XJL_T_LEDGER_MAG ac where ac.status!='1'
		and ac.OBJECT_ID='20064' and ac.proj_id=a.proj_id and ac.LEDGER_TYPE='1' )as JC_RAISE_AMOUNT,
		ccc.PAID_AMOUNT as JC_RAISE_AMOUNT_ONE,
		ccc.PLAN_AMOUNT as JC_CURRENT_AMOUNT_ONE,
		(select count(*) from tz_t_proj_info m where m.INVE_ID=a.fundIds and m.proj_type='1' and m.status!='2'
		) as
		proj_gs2,
		( select count(distinct cc.proj_id)
		from tz_t_proj_info aa
		inner join bd_t_fund_info bb on aa.proj_object=bb.fund_id and aa.proj_type='2'
		inner join tz_t_proj_info cc on cc.inve_id=bb.fund_id AND CC.PROJ_TYPE='1' and cc.group_id='3'
		where aa.inve_id=a.fundIds AND AA.STATUS!='2' AND bb.status!='2' and cc.status!='2'
		) as proj_gs1,
		(select count(DISTINCT m.proj_object) from tz_t_proj_info m where m.INVE_ID=a.fundIds and m.proj_type='1' and m.status!='2'
		) as
		proj_gs3,
		( select count(DISTINCT cc.proj_object) from tz_t_proj_info aa
		inner join bd_t_fund_info bb on aa.proj_object=bb.fund_id and aa.proj_type='2'
		inner join tz_t_proj_info cc on cc.inve_id=bb.fund_id AND CC.PROJ_TYPE='1' and cc.group_id='3'
		where aa.inve_id=a.fundIds AND AA.STATUS!='2' AND bb.status!='2' and cc.status!='2'
		) as proj_gs4,
		(select sum(RMB_INTENDED_AMOUNT) from tz_t_proj_info m
		left join ei.BD_T_ENTE_INFO d on m.PROJ_OBJECT=d.ENTERPRISE_ID
		left join ei.TZ_T_PROJ_APP_INFO v on v.PROJ_ID=m.proj_id
		where m.INVE_ID=a.fundIds and m.proj_type='1' and m.status!='2'
		) as PROJ_AMOUNT2,
		(select sum(v.RMB_INTENDED_AMOUNT) from tz_t_proj_info aa
		inner join bd_t_fund_info bb on aa.proj_object=bb.fund_id and aa.proj_type='2'
		inner join tz_t_proj_info cc on cc.inve_id=bb.fund_id AND CC.PROJ_TYPE='1' and cc.group_id='3'
		inner join ei.TZ_T_PROJ_APP_INFO v on v.PROJ_ID=cc.proj_id
		where aa.inve_id=a.fundIds AND AA.STATUS!='2' AND bb.status!='2' and cc.status!='2'
		) as PROJ_AMOUNT1,
		(select count(*) from tz_t_proj_info m left join ei.BD_T_ENTE_INFO d on m.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
		where m.INVE_ID=a.fundIds and m.proj_type='1' and m.status!='2' and d.IS_PROVINCE='1'
		and m.group_id='3'
		) as PROVINCE_GS2,
		(select count(*) from tz_t_proj_info aa
		inner join bd_t_fund_info bb on aa.proj_object=bb.fund_id and aa.proj_type='2'
		inner join tz_t_proj_info cc on cc.inve_id=bb.fund_id AND CC.PROJ_TYPE='1' AND cc.group_id='3'
		inner join ei.BD_T_ENTE_INFO d on cc.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
		where aa.inve_id=a.fundIds AND AA.STATUS!='2' AND bb.status!='2' and cc.status!='2' and d.IS_PROVINCE='1'
		) as PROVINCE_GS1,
		(select sum(RMB_INTENDED_AMOUNT) from tz_t_proj_info m
		left join ei.BD_T_ENTE_INFO d on m.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
		left join ei.TZ_T_PROJ_APP_INFO v on v.PROJ_ID=m.proj_id
		where m.INVE_ID=a.fundIds and m.proj_type='1' and m.status!='2' and d.IS_PROVINCE='1' and m.group_id='3'
		) as PROVINCE_AMOUNT2,
		(select sum(v.RMB_INTENDED_AMOUNT) from tz_t_proj_info aa
		inner join bd_t_fund_info bb on aa.proj_object=bb.fund_id and aa.proj_type='2'
		inner join tz_t_proj_info cc on cc.inve_id=bb.fund_id AND CC.PROJ_TYPE='1' and cc.group_id='3'
		inner join ei.TZ_T_PROJ_APP_INFO v on v.PROJ_ID=cc.proj_id
		inner join ei.BD_T_ENTE_INFO d on cc.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
		where aa.inve_id=a.fundIds AND AA.STATUS!='2' AND bb.status!='2' and cc.status!='2' and d.IS_PROVINCE='1'
		) as PROVINCE_AMOUNT1,

		(select count(*) from tz_t_proj_info m left join ei.BD_T_ENTE_INFO d on m.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
		where m.INVE_ID=a.fundIds and m.proj_type='1' and m.status!='2' and d.IS_PUBLIC_COMP='1' and m.group_id='3'
		) as SS_GS2,
		( select count(*) from tz_t_proj_info aa
		inner join bd_t_fund_info bb on aa.proj_object=bb.fund_id and aa.proj_type='2'
		inner join tz_t_proj_info cc on cc.inve_id=bb.fund_id AND CC.PROJ_TYPE='1' and cc.group_id='3'
		inner join ei.BD_T_ENTE_INFO d on cc.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
		where aa.inve_id=a.fundIds AND AA.STATUS!='2' AND bb.status!='2' and cc.status!='2' and d.IS_PUBLIC_COMP='1') as SS_GS1,
		(
		select count(*) from tz_t_proj_info m left join ei.BD_T_ENTE_INFO d on m.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
		where m.INVE_ID=a.fundIds and m.proj_type='1' and m.status!='2' and d.IS_APPLY_IPO='1' and m.group_id='3'
		) as IPO_GS2,
		( select count( distinct cc.proj_id) from tz_t_proj_info aa
		inner join bd_t_fund_info bb on aa.proj_object=bb.fund_id and aa.proj_type='2'
		inner join tz_t_proj_info cc on cc.inve_id=bb.fund_id AND CC.PROJ_TYPE='1' and cc.group_id='3'
		inner join ei.BD_T_ENTE_INFO d on cc.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
		where aa.inve_id=a.fundIds AND AA.STATUS!='2' AND bb.status!='2' and cc.status!='2' and d.IS_APPLY_IPO='1'
		)as IPO_GS1,
		(select count(*) from tz_t_proj_info m left join ei.BD_T_ENTE_INFO d on m.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
		where m.INVE_ID=a.fundIds and m.proj_type='1' and m.status!='2' and d.IS_NEW_BOARD='1' and m.group_id='3'
		) as NEW_BOARD_GS2,
		(select count(*) from tz_t_proj_info aa
		inner join bd_t_fund_info bb on aa.proj_object=bb.fund_id and aa.proj_type='2'
		inner join tz_t_proj_info cc on cc.inve_id=bb.fund_id AND CC.PROJ_TYPE='1' and cc.group_id='3'
		inner join ei.BD_T_ENTE_INFO d on cc.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
		where aa.inve_id=a.fundIds AND AA.STATUS!='2' AND bb.status!='2' and cc.status!='2' and d.IS_NEW_BOARD='1'
		)as NEW_BOARD_GS1
		from
		(select b.proj_status,a.fund_id as fundIds,a.*,b.INVE_NAME,b.inve_id,b.proj_id,b.update_dt as updateDt
		from bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT
		and a.status!='2'
		AND b.status!='2'
		and b.proj_status in(7,8,9,15)
		and b.proj_type='2' and a.OLD_SUB_PLAT_PROP in(2,3,4,6) where b.inve_id= #{paramMap.fundId}
		union all
		select a.proj_status,m.fund_id as fundIds,b.*,a.inve_name,a.inve_id,a.proj_id,a.update_dt as updateDt from
		tz_t_proj_info a
		inner join bd_t_fund_info b on b.fund_id=a.PROJ_OBJECT and a.inve_id=#{paramMap.fundId}
		and b.OLD_SUB_PLAT_PROP='5' and a.proj_status in(7,8,9,15)
		LEFT join tz_t_proj_info d on d.inve_id=b.fund_id and d.proj_type='2' and d.status!='2'
		and d.proj_status in(7,8,9,15)
		LEFT join bd_t_fund_info m on d.proj_object=m.fund_id and m.status!='2'
		union all
		select b.proj_status,a.fund_id as fundIds,a.*,b.INVE_NAME,b.inve_id,b.proj_id,b.update_dt as updateDt from
		bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and b.proj_status in(7,8,9,15)
		where b.inve_id in(select a.fund_id from bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and a.status!='2'
		and b.proj_type='2' and a.OLD_SUB_PLAT_PROP in(2,3,4,6)
		where b.inve_id= #{paramMap.fundId}) and a.status!='2' and b.status!='2'
		)a
		left join master.T_ENT_BASE_INFO b on a.ENTE_ID=b.ENTERPRISE_ID
		left join BD_T_FUND_INVE_DESC c on c.FUND_ID=a.fund_id
		left join (SELECT ROW_NUMBER() OVER(PARTITION BY a.proj_id ORDER BY a.CREATE_DT DESC) RN,
		bb.PLAN_AMOUNT,a.proj_id,bb.PAID_AMOUNT,INVESTOR_ID,a.CREATE_DT,bb.INVESTOR_NAME
		FROM TZ_T_PROJ_OWNERSHIP_INFO a
		inner join TZ_T_PROJ_SHARE_INFO bb on a.OS_ID=bb.OS_ID
		where bb.STATUS='0'
		and bb.INVESTOR_ID='20064'
		)ccc on ccc.proj_id=a.proj_id AND ccc.rn='1'
		<where>
			a.OLD_SUB_PLAT_PROP in(2,3,4,5,6) and a.status!='2'
			<if test='paramMap.keyWord != null and paramMap.keyWord != ""'>
				and (a.FUND_NAME like ${paramMap.keyWord} or a.REG_NAME like ${paramMap.keyWord})
			</if>
			<include refid="searchCondition.searchClause"/>
			order by a.inve_id desc,a.fund_id desc
		</where>
		)ppo
		)mmop
		left join (SELECT ROW_NUMBER() OVER(PARTITION BY ppmk.proj_id ORDER BY ppmk.create_dt asc) RM,
		ppmk.*
		FROM BD_T_FUND_QUIT_INVE_INFO ppmk where 1=1 and is_delete!='1' )klk on klk.proj_id=mmop.proj_id and RM='1'

	</select>

	<select id="getExportInfoList" resultMap="FundExportResult"  parameterType="com.founder.ssm.core.common.SearchCondition">
		select mmop.*,klk.INVE_PROJ_NUM,klk.INVE_ENT_NUM,klk.INVE_AMT,klk.INVE_PROVINCE_NUM
		,klk.INVE_PROVINCE_AMT,klk.INVE_LISTED_NUM,klk.INVE_IPO_NUM,klk.INVE_NEW_THIRD_NUM
		 from (select
		decode(ppo.proj_status,'9','已退出','未退出') as proj_status_name,
		ppo.*,
		(to_number(nvl(ppo.proj_gs2,0))+to_number(nvl(ppo.proj_gs1,0))) as proj_gs,
		(to_number(nvl(ppo.proj_gs3,0))+to_number(nvl(ppo.proj_gs4,0))) as ente_gs,
		(to_number(nvl(ppo.PROJ_AMOUNT2,0))+to_number(nvl(ppo.PROJ_AMOUNT1,0))) as PROJ_AMOUNT,
		(to_number(nvl(ppo.PROVINCE_GS2,0))+to_number(nvl(ppo.PROVINCE_GS1,0))) as PROVINCE_GS,
		(to_number(nvl(ppo.PROVINCE_AMOUNT2,0))+to_number(nvl(ppo.PROVINCE_AMOUNT1,0))) as PROVINCE_AMOUNT,
		(to_number(nvl(ppo.SS_GS2,0))+to_number(nvl(ppo.SS_GS1,0))) as SS_GS,
		(to_number(nvl(ppo.IPO_GS2,0))+to_number(nvl(ppo.IPO_GS1,0))) as IPO_GS,
		(to_number(nvl(ppo.NEW_BOARD_GS2,0))+to_number(nvl(ppo.NEW_BOARD_GS1,0))) as NEW_BOARD_GS
		from (select
		a.proj_status,a.updateDt,a.OLD_SUB_PLAT_PROP,a.inve_name,a.proj_id,a.FUND_ID,a.reg_name,a.MC_NAME,a.SETUP_DT,b.START_DATE,
		(
		to_number(nvl(c.DURATION_PERIOD,0))
		+to_number(nvl(c.INVE_PERIOD,0))
		+to_number(nvl(DECODE(c.is_ROLL_OVER,'1',ROLL_OVER,'0'),0))
		+to_number(nvl(c.PAYBACK_PERIOD,0))
		+to_number(nvl(DECODE(c.is_PAYBACK_OVER,'1',PAYBACK_OVER,'0'),0))
		+to_number(nvl(DECODE(c.is_DURATION_OVER,'1',DURATION_OVER,'0'),0))
		)as cooperation_year,
		c.INVE_PERIOD,
		c.INVE_START_DATE,
		c.INVE_END_DATE,
		a.CURRENT_AMOUNT,
		a.RAISE_AMOUNT,
		(select sum(RMB_INVE_AMOUNT) from RZ_T_FUND_SHARE_INFO aa where aa.fund_id=a.fundIds and aa.INVESTOR_ID='20064')
		as JC_CURRENT_AMOUNT,
		(select sum(ac.RMB_INVE_AMOUNT) from XJL_T_LEDGER_MAG ac where ac.status!='1' and ac.OBJECT_ID='20064' and
		ac.proj_id=a.proj_id and ac.LEDGER_TYPE='1')as JC_RAISE_AMOUNT,
		ccc.PAID_AMOUNT as JC_RAISE_AMOUNT_ONE,
		ccc.PLAN_AMOUNT as JC_CURRENT_AMOUNT_ONE,
        (select count(*) from tz_t_proj_info m where m.INVE_ID=a.fundIds and m.proj_type='1' and m.status!='2' ) as
        proj_gs2,
		( select count(cc.proj_id) from tz_t_proj_info aa
        inner join bd_t_fund_info bb on aa.proj_object=bb.fund_id and aa.proj_type='2'
        inner join tz_t_proj_info cc on cc.inve_id=bb.fund_id AND CC.PROJ_TYPE='1' and cc.group_id='3'
        where aa.inve_id=a.fundIds AND AA.STATUS!='2' AND bb.status!='2' and cc.status!='2'
        ) as proj_gs1,
		(select count(DISTINCT m.proj_object) from tz_t_proj_info m where m.INVE_ID=a.fundIds and m.proj_type='1' and m.status!='2'
		) as
		proj_gs3,
		( select count(DISTINCT cc.proj_object) from tz_t_proj_info aa
		inner join bd_t_fund_info bb on aa.proj_object=bb.fund_id and aa.proj_type='2'
		inner join tz_t_proj_info cc on cc.inve_id=bb.fund_id AND CC.PROJ_TYPE='1' and cc.group_id='3'
		where aa.inve_id=a.fundIds AND AA.STATUS!='2' AND bb.status!='2' and cc.status!='2'
		) as proj_gs4,
		(select sum(RMB_INTENDED_AMOUNT) from tz_t_proj_info m
		left join ei.BD_T_ENTE_INFO d on m.PROJ_OBJECT=d.ENTERPRISE_ID
		left join ei.TZ_T_PROJ_APP_INFO v on v.PROJ_ID=m.proj_id
		where m.INVE_ID=a.fundIds and m.proj_type='1' and m.status!='2'
		) as PROJ_AMOUNT2,
		(select sum(v.RMB_INTENDED_AMOUNT) from tz_t_proj_info aa
		inner join bd_t_fund_info bb on aa.proj_object=bb.fund_id and aa.proj_type='2'
		inner join tz_t_proj_info cc on cc.inve_id=bb.fund_id AND CC.PROJ_TYPE='1' and cc.group_id='3'
		inner join ei.TZ_T_PROJ_APP_INFO v on v.PROJ_ID=cc.proj_id
		where aa.inve_id=a.fundIds AND AA.STATUS!='2' AND bb.status!='2' and cc.status!='2'
		) as PROJ_AMOUNT1,
		(select count(*) from tz_t_proj_info m left join ei.BD_T_ENTE_INFO d on m.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
        where m.INVE_ID=a.fundIds and m.proj_type='1' and m.status!='2' and d.IS_PROVINCE='1'
        and m.group_id='3'
		) as PROVINCE_GS2,
	   ( select count(*) from tz_t_proj_info aa
        inner join bd_t_fund_info bb on aa.proj_object=bb.fund_id and aa.proj_type='2'
        inner join tz_t_proj_info cc on cc.inve_id=bb.fund_id AND CC.PROJ_TYPE='1' AND cc.group_id='3'
        inner join ei.BD_T_ENTE_INFO d on cc.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
        where aa.inve_id=a.fundIds AND AA.STATUS!='2' AND bb.status!='2' and cc.status!='2' and d.IS_PROVINCE='1'
        ) as PROVINCE_GS1,
		(select sum(RMB_INTENDED_AMOUNT) from tz_t_proj_info m
        left join ei.BD_T_ENTE_INFO d on m.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
        left join ei.TZ_T_PROJ_APP_INFO v on v.PROJ_ID=m.proj_id
        where m.INVE_ID=a.fundIds and m.proj_type='1' and m.status!='2' and d.IS_PROVINCE='1' and m.group_id='3'
        ) as PROVINCE_AMOUNT2,
		( select sum(v.RMB_INTENDED_AMOUNT) from tz_t_proj_info aa
        inner join bd_t_fund_info bb on aa.proj_object=bb.fund_id and aa.proj_type='2'
        inner join tz_t_proj_info cc on cc.inve_id=bb.fund_id AND CC.PROJ_TYPE='1' and cc.group_id='3'
        inner join ei.TZ_T_PROJ_APP_INFO v on v.PROJ_ID=cc.proj_id
        inner join ei.BD_T_ENTE_INFO d on cc.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
        where aa.inve_id=a.fundIds AND AA.STATUS!='2' AND bb.status!='2' and cc.status!='2' and d.IS_PROVINCE='1'
		) as PROVINCE_AMOUNT1,
		(select count(*) from tz_t_proj_info m left join ei.BD_T_ENTE_INFO d on m.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
		where m.INVE_ID=a.fundIds and m.proj_type='1' and m.status!='2' and d.IS_PUBLIC_COMP='1' and m.group_id='3') as SS_GS2,
		( select count(*) from tz_t_proj_info aa
        inner join bd_t_fund_info bb on aa.proj_object=bb.fund_id and aa.proj_type='2'
        inner join tz_t_proj_info cc on cc.inve_id=bb.fund_id AND CC.PROJ_TYPE='1' and cc.group_id='3'
        inner join ei.BD_T_ENTE_INFO d on cc.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
        where aa.inve_id=a.fundIds AND AA.STATUS!='2' AND bb.status!='2' and cc.status!='2' and d.IS_PUBLIC_COMP='1'
		) as SS_GS1,
		(select count(*) from tz_t_proj_info m left join ei.BD_T_ENTE_INFO d on m.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
         where m.INVE_ID=a.fundIds and m.proj_type='1' and m.status!='2' and d.IS_APPLY_IPO='1' and m.group_id='3'
        ) as IPO_GS2,
		(select count(*) from tz_t_proj_info aa
        inner join bd_t_fund_info bb on aa.proj_object=bb.fund_id and aa.proj_type='2'
        inner join tz_t_proj_info cc on cc.inve_id=bb.fund_id AND CC.PROJ_TYPE='1' and cc.group_id='3'
        inner join ei.BD_T_ENTE_INFO d on cc.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
        where aa.inve_id=a.fundIds AND AA.STATUS!='2' AND bb.status!='2' and cc.status!='2' and d.IS_APPLY_IPO='1'
        )as IPO_GS1,
		(select count(*) from tz_t_proj_info m left join ei.BD_T_ENTE_INFO d on m.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
        where m.INVE_ID=a.fundIds and m.proj_type='1' and m.status!='2' and d.IS_NEW_BOARD='1' and m.group_id='3'
        ) as NEW_BOARD_GS2,
		(select count(*) from tz_t_proj_info aa
        inner join bd_t_fund_info bb on aa.proj_object=bb.fund_id and aa.proj_type='2'
        inner join tz_t_proj_info cc on cc.inve_id=bb.fund_id AND CC.PROJ_TYPE='1' and cc.group_id='3'
        inner join ei.BD_T_ENTE_INFO d on cc.OLD_ENTERPRISE_ID=d.ENTERPRISE_ID
        where aa.inve_id=a.fundIds AND AA.STATUS!='2' AND bb.status!='2' and cc.status!='2' and d.IS_NEW_BOARD='1')as NEW_BOARD_GS1
		from (
		select b.proj_status,a.fund_id as fundIds,a.*,b.INVE_NAME,b.inve_id,b.proj_id,b.update_dt as updateDt
		from bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and a.status!='2' and b.status!='2'
		and b.proj_type='2' and a.OLD_SUB_PLAT_PROP in(2,3,4,6) and b.proj_status in(7,8,9,15)
		where b.inve_id=#{paramMap.fundId}
		union all
		select a.proj_status,m.fund_id as fundIds,b.*,a.inve_name,a.inve_id,d.proj_id,d.update_dt as updateDt
		from tz_t_proj_info a
		inner join bd_t_fund_info b on b.fund_id=a.PROJ_OBJECT and a.inve_id= #{paramMap.fundId}
		and b.OLD_SUB_PLAT_PROP='5' AND a.proj_status in(7,8,9,15)
		LEFT join tz_t_proj_info d on d.inve_id=b.fund_id and d.proj_type='2' and d.status!='2'
		and d.proj_status in(7,8,9,15)
		LEFT join bd_t_fund_info m on d.proj_object=m.fund_id and m.status!='2'
		and m.OLD_SUB_PLAT_PROP in('4','6')
		union all
		select b.proj_status,a.fund_id as fundIds,a.*,b.INVE_NAME,b.inve_id,b.proj_id,b.update_dt from bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and b.proj_status in(7,8,9,15)
		where b.inve_id in(select a.fund_id from bd_t_fund_info a inner join tz_t_proj_info b
		on a.fund_id=b.PROJ_OBJECT and a.status!='2'
		and b.proj_type='2' and a.OLD_SUB_PLAT_PROP in(2) where b.inve_id= #{paramMap.fundId}
		) and a.status!='2' and b.status!='2'
		)a
		left join master.T_ENT_BASE_INFO b on a.ENTE_ID=b.ENTERPRISE_ID
		left join BD_T_FUND_INVE_DESC c on c.FUND_ID=a.fundIds
		left join (SELECT ROW_NUMBER() OVER(PARTITION BY a.proj_id ORDER BY a.CREATE_DT DESC) RN,
		bb.PLAN_AMOUNT,a.proj_id,bb.PAID_AMOUNT,INVESTOR_ID,a.CREATE_DT,bb.INVESTOR_NAME
		FROM TZ_T_PROJ_OWNERSHIP_INFO a
		inner join TZ_T_PROJ_SHARE_INFO bb on a.OS_ID=bb.OS_ID
		where bb.STATUS='0'
		and bb.INVESTOR_ID='20064'
		)ccc on ccc.proj_id=a.proj_id AND ccc.rn='1'

		<where>
			a.OLD_SUB_PLAT_PROP in(2,3,4,5,6) and a.status!='2'
			<if test='paramMap.keyWord != null and paramMap.keyWord != ""'>
				and (a.FUND_NAME like ${paramMap.keyWord} or a.REG_NAME like ${paramMap.keyWord})
			</if>
			<include refid="searchCondition.searchClause"/>
			order by a.inve_id desc,a.fund_id desc
		</where>
		)ppo
		)mmop
		left join (SELECT ROW_NUMBER() OVER(PARTITION BY ppmk.proj_id ORDER BY ppmk.create_dt asc) RM,
		ppmk.*
		FROM BD_T_FUND_QUIT_INVE_INFO ppmk where 1=1 and is_delete!='1' )klk on klk.proj_id=mmop.proj_id and RM='1'

	</select>

	<select id="projInfoExportListPage" resultMap="projExportResult"  parameterType="com.founder.ssm.core.common.SearchCondition" >
		<!--二级母基金投项目 -->
		select fm.* ,
		kkk.YEAR,
		kkk.STAFF_NUM,
		kkk.RD_STAFF_NUM,
		kkk.TOTAL_ASSETS,
		kkk.TOTAL_LIABILITIES,
		kkk.OWNER_EQUITY,
		kkk.TOTAL_INCOME,
		kkk.TOTAL_PROFIT,
		kkk.NET_PROFIT,
		kkk.RD_FEE,
		kkk.PAY_FEE
		from(select * from (select ggg.* , ROWNUM AS rowno from
		(select
		DISTINCT
		aaa.INVE_ID,
		aaa.proj_name,
		aaa.proj_id,
		aaa.proj_object,
		aaa.inve_name,
		bbb.name as enteName,
		nnn.SETUP_DT,
		nnn.REG_ADD,
		bbb.START_DATE,
		bbb.ADDRESS_DETAILS,
		bbb.REGIST_CAPI,
		nnn.REG_AMOUNT,
		dd.INTENDED_AMOUNT,
		dd.RMB_INTENDED_AMOUNT,
		dd.PER_SHARE,
		CASE WHEN dd.RMB_INTENDED_AMOUNT != 0 AND pp.CURRENT_AMOUNT != 0
		THEN RTrim(to_char(NVL(dd.RMB_INTENDED_AMOUNT*100 / pp.CURRENT_AMOUNT, 0), 'FM999999999999999999999990.99'),
		'.')
		ELSE '0' END as PERCENT,
		dd.INVE_ROUNDS,
		dd.FINA_ROUNDS,
		dd.FINA_TIMES,
		(select min(g.OCCUR_DT) from XJL_T_LEDGER_MAG g where g.proj_id=aaa.proj_id and g.LEDGER_TYPE='1' and g.status!='1' and g.OCCUR_DT is not null group by
		proj_id)as OCCUR_DT,
		dd.inve_type,nnn.INDUSTRY_NAME,
		(select DECODE((count(aa.LABEL_ID)),'16','是','否') as is_private from base.COMM_T_LABEL aa inner join
		base.COMM_T_ENT_LABEL bb on aa.label_id=bb.label_id where 1=1 and bb.ent_id=bbb.ENTERPRISE_ID and
		aa.LABEL_ID='16') as is_private,
		(select DECODE((count(aa.LABEL_ID)),'15','是','否') as is_technology from base.COMM_T_LABEL aa inner join
		base.COMM_T_ENT_LABEL bb on aa.label_id=bb.label_id where 1=1 and bb.ent_id=bbb.ENTERPRISE_ID and
		aa.LABEL_ID='15') as is_technology,
		(select DECODE((count(aa.LABEL_ID)),'4','是','否') as is_strategy from base.COMM_T_LABEL aa inner join
		base.COMM_T_ENT_LABEL bb on aa.label_id=bb.label_id where 1=1 and bb.ent_id=bbb.ENTERPRISE_ID and
		aa.LABEL_ID='4') as is_strategy,
		nnn.IS_DIRECTOR_CNT,
		nnn.IS_SUPERVISOR_CNT,
		dd.POST_MONEY,
		nm.ENTE_POST_VALUE,
		nm.INVE_NEW_VALUE,
		nm.HOLD_SHARE,
		nnn.IS_PUBLIC_COMP,
		nnn.IS_PROVINCE,
		nnn.phase,
		nnn.HLIGHTS_REMARK,
		(select sum(RMB_INVE_AMOUNT) from XJL_T_LEDGER_MAG gg where gg.status!='1' and   gg.proj_id=aaa.proj_id and gg.LEDGER_TYPE='6' group
		by gg.proj_id)as QUIT_RMB_INVE_AMOUNT,
		(select sum(RMB_INVE_AMOUNT) from XJL_T_LEDGER_MAG ggg where ggg.status!='1' and ggg.proj_id=aaa.proj_id and ggg.LEDGER_TYPE='7'
		group by ggg.proj_id)as QUIT_SY,
		tt.OCCUR_DT as QUIT_DT,
		tt.EXIT_TYPE

		from (
		select DISTINCT aa.* from TZ_T_PROJ_INFO aa where inve_id in(select a.fund_id from ei.bd_t_fund_info a inner
		join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT where b.inve_id='11276' and b.proj_type='2' and b.status!='2'
		and OLD_SUB_PLAT_PROP='2'

		) and aa.proj_type='1'
		union all
		<!--二级母基金投参股基金然后再投项目  -->
		select f.* from
		ei.bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and b.inve_id='11276' and b.proj_type='2' and
		b.status!='2' and OLD_SUB_PLAT_PROP='2'
		inner join tz_t_proj_info c on c.INVE_ID=a.fund_id and c.status!='2' and c.proj_type='2'
		left join bd_t_fund_info d on c.PROJ_OBJECT=d.fund_id and d.status!='2'
		inner join tz_t_proj_info f on f.INVE_ID=d.fund_id and c.status!='2' and f.proj_type='1'
		union all
		<!--股基金投项目 -->
		select aa.* from TZ_T_PROJ_INFO aa where inve_id in(select a.fund_id from ei.bd_t_fund_info a inner join
		tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT where b.inve_id='11276' and b.proj_type='2' and b.status!='2' and
		OLD_SUB_PLAT_PROP='4'
		) and aa.proj_type='1'
		)aaa
		left join master.T_ENT_BASE_INFO bbb on bbb.ENTERPRISE_ID=aaa.proj_object
		left join EI.BD_T_ENTE_INFO nnn on nnn.ENTERPRISE_ID=aaa.OLD_ENTERPRISE_ID
		left join ei.tz_t_proj_app_info dd on dd.proj_id=aaa.proj_id
		left join ei.bd_t_fund_info pp on pp.fund_id=aaa.inve_id
		left join
		(SELECT ROW_NUMBER() OVER(PARTITION BY am.OBJECT_ID ORDER BY am.CREATE_DT DESC) RN,
		am.ENTE_POST_VALUE,am.INVE_NEW_VALUE,am.OBJECT_ID,am.HOLD_SHARE
		FROM TZ_T_PROJ_VALUATION am
		where am.status!='9'
		)nm on nm.OBJECT_ID=aaa.proj_object AND nm.rn='1'
		left join
		(SELECT ROW_NUMBER() OVER(PARTITION BY ggm.proj_id ORDER BY ggm.CREATE_DT asc) RM,
		ggm.OCCUR_DT,ggm.EXIT_TYPE,ggm.proj_id
		FROM XJL_T_LEDGER_MAG ggm
		where ggm.LEDGER_TYPE in(6,7) and ggm.status!='1'
		)tt on tt.proj_id=aaa.proj_id AND tt.RM='1'
		<where>
			1=1
			<include refid="searchCondition.searchClause"/>
			ORDER BY aaa.INVE_ID DESC
		</where>
		)ggg where
		<![CDATA[ROWNUM <= #{paramMap.pageSize}]]>
		)nnn where  nnn.rowno >= #{paramMap.currPage}
		)fm
		left join EI.GF_T_FUND_ENTE kkk on kkk.ENTE_ID=fm.proj_object
		and (kkk.YEAR=(to_char(to_date(#{paramMap.year},'yyyy'),'yyyy'))
		or  kkk.YEAR=to_char(add_months(to_date(#{paramMap.year},'yyyy'),-12),'yyyy'))
	</select>

	<select id="projInfoExportCount" resultType="Integer"  parameterType="com.founder.ssm.core.common.SearchCondition" >
		<!--二级母基金投项目 -->
		select count(*) as countGs from (select
		DISTINCT
		aaa.INVE_ID,
		aaa.proj_name,
		aaa.proj_id,
		aaa.proj_object,
		aaa.inve_name,
		bbb.name as enteName,
		nnn.SETUP_DT,
		nnn.REG_ADD,
		bbb.START_DATE,
		bbb.ADDRESS_DETAILS,bbb.REGIST_CAPI,
		dd.INTENDED_AMOUNT,dd.RMB_INTENDED_AMOUNT,
		dd.PER_SHARE,
		CASE WHEN dd.RMB_INTENDED_AMOUNT != 0 AND pp.CURRENT_AMOUNT != 0
		THEN RTrim(to_char(NVL(dd.RMB_INTENDED_AMOUNT / pp.CURRENT_AMOUNT, 0), 'FM999999999999999999999990.99'),
		'.')
		ELSE '0' END as PERCENT,
		dd.INVE_ROUNDS,
		dd.FINA_ROUNDS,
		dd.FINA_TIMES,
		(select min(g.OCCUR_DT) from XJL_T_LEDGER_MAG g where g.proj_id=aaa.proj_id  and g.status!='1'  and g.LEDGER_TYPE='1' and g.OCCUR_DT is not null group by
		proj_id)as OCCUR_DT,
		dd.inve_type,nnn.INDUSTRY_NAME,
		(select DECODE((count(aa.LABEL_ID)),'16','是','否') as is_private from base.COMM_T_LABEL aa inner join
		base.COMM_T_ENT_LABEL bb on aa.label_id=bb.label_id where 1=1 and bb.ent_id=bbb.ENTERPRISE_ID and
		aa.LABEL_ID='16') as is_private,
		(select DECODE((count(aa.LABEL_ID)),'15','是','否') as is_technology from base.COMM_T_LABEL aa inner join
		base.COMM_T_ENT_LABEL bb on aa.label_id=bb.label_id where 1=1 and bb.ent_id=bbb.ENTERPRISE_ID and
		aa.LABEL_ID='15') as is_technology,
		(select DECODE((count(aa.LABEL_ID)),'4','是','否') as is_strategy from base.COMM_T_LABEL aa inner join
		base.COMM_T_ENT_LABEL bb on aa.label_id=bb.label_id where 1=1 and bb.ent_id=bbb.ENTERPRISE_ID and
		aa.LABEL_ID='4') as is_strategy,
		nnn.IS_DIRECTOR_CNT,
		nnn.IS_SUPERVISOR_CNT,
		dd.POST_MONEY,
		nm.ENTE_POST_VALUE,
		nm.INVE_NEW_VALUE,
		nm.HOLD_SHARE,
		nnn.IS_PUBLIC_COMP,
		nnn.IS_PROVINCE,
		nnn.phase,
		nnn.HLIGHTS_REMARK,
		(select sum(RMB_INVE_AMOUNT) from XJL_T_LEDGER_MAG gg where gg.status!='1' and gg.proj_id=aaa.proj_id and gg.LEDGER_TYPE='6' group
		by gg.proj_id)as QUIT_RMB_INVE_AMOUNT,
		(select sum(RMB_INVE_AMOUNT) from XJL_T_LEDGER_MAG ggg where ggg.status!='1' and ggg.proj_id=aaa.proj_id and ggg.LEDGER_TYPE='7'
		group by ggg.proj_id)as QUIT_SY,
		tt.OCCUR_DT as QUIT_DT,
		tt.EXIT_TYPE

		from (
		select DISTINCT aa.*,aa.inve_name as inveNames from TZ_T_PROJ_INFO aa where inve_id
		in(select a.fund_id from ei.bd_t_fund_info a inner
		join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT where b.inve_id=#{paramMap.fundId}
		and b.proj_type='2' and b.status!='2' and a.status!='2'
		and OLD_SUB_PLAT_PROP in('2','4') and b.proj_status!='9'

		) and aa.proj_type='1' and aa.status!='2'
		union all
		<!--二级母基金投参股基金然后再投项目  -->
		select f.*,f.inve_name as inveNames from
		ei.bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and b.inve_id=#{paramMap.fundId}
		and b.proj_type='2' and a.status!='2' and
		b.status!='2' and OLD_SUB_PLAT_PROP in('2','3','4') and b.proj_status!='9' and a.status!='2'
		inner join tz_t_proj_info c on c.INVE_ID=a.fund_id and c.status!='2' and c.proj_type='2'
		and c.proj_status!='9'
		left join bd_t_fund_info d on c.PROJ_OBJECT=d.fund_id and d.status!='2'
		inner join tz_t_proj_info f on f.INVE_ID=d.fund_id and f.status!='2' and f.proj_type='1'
		<!--专项基金-参股基金-投项目 -->
		union all
		select aa.* ,b.reg_name as inveNames  from  tz_t_proj_info a
		inner join  bd_t_fund_info b on b.fund_id=a.PROJ_OBJECT  and a.inve_id=#{paramMap.fundId}
		and b.OLD_SUB_PLAT_PROP='5' and a.proj_status!='9' and a.status!='2'
		inner join tz_t_proj_info d on d.inve_id=b.fund_id and d.proj_type='2' and d.status!='2'
		and d.proj_status!='9'
		inner join bd_t_fund_info m on d.proj_object=m.fund_id and m.status!='2'
		and m.OLD_SUB_PLAT_PROP in(4,6,3,2) and m.status!='2'
		inner join tz_t_proj_info aa on aa.inve_id=m.fund_id and aa.proj_type='1' and aa.status!='2'
		)aaa
		left join master.T_ENT_BASE_INFO bbb on bbb.ENTERPRISE_ID=aaa.proj_object
		left join EI.BD_T_ENTE_INFO nnn on nnn.ENTERPRISE_ID=aaa.OLD_ENTERPRISE_ID
		left join ei.tz_t_proj_app_info dd on dd.proj_id=aaa.proj_id
		left join ei.bd_t_fund_info pp on pp.fund_id=aaa.inve_id
		left join
		(SELECT ROW_NUMBER() OVER(PARTITION BY am.OBJECT_ID ORDER BY am.CREATE_DT DESC) RN,
		am.ENTE_POST_VALUE,am.INVE_NEW_VALUE,am.OBJECT_ID,am.HOLD_SHARE
		FROM TZ_T_PROJ_VALUATION am
		where am.status!='9'
		)nm on nm.OBJECT_ID=aaa.proj_object AND nm.rn='1'
		left join
		(SELECT ROW_NUMBER() OVER(PARTITION BY ggm.proj_id ORDER BY ggm.CREATE_DT asc) RM,
		ggm.OCCUR_DT,ggm.EXIT_TYPE,ggm.proj_id
		FROM XJL_T_LEDGER_MAG ggm
		where ggm.LEDGER_TYPE in(6,7) and ggm.status!='1'
		)tt on tt.proj_id=aaa.proj_id AND tt.RM='1'
		<where>
			1=1
			<include refid="searchCondition.searchClause"/>
			ORDER BY aaa.INVE_ID DESC
		</where>
		)

	</select>

	<select id="projInfoExportList" resultMap="projExportResult"  parameterType="com.founder.ssm.core.common.SearchCondition" >
		<!--二级母基金投项目 -->
		select  fm.* ,
		kkk.YEAR,
		kkk.STAFF_NUM,
		kkk.RD_STAFF_NUM,
		kkk.TOTAL_ASSETS,
		kkk.TOTAL_LIABILITIES,
		kkk.OWNER_EQUITY,
		kkk.TOTAL_INCOME,
		kkk.TOTAL_PROFIT,
		kkk.NET_PROFIT,
		kkk.RD_FEE,
		kkk.PAY_FEE
		from(select * from (select ggg.* , ROWNUM AS rowno from
		(select
		DISTINCT
		aaa.INVE_ID,
		aaa.proj_name,
		aaa.proj_id,
		aaa.proj_object,
		aaa.inveNames as inve_name,
		aaa.update_dt,
		bbb.name as enteName,
		nnn.SETUP_DT,
		nnn.REG_ADD,
		bbb.START_DATE,
		bbb.ADDRESS_DETAILS,
		bbb.REGIST_CAPI,
		nnn.REG_AMOUNT,
		nnn.REG_AMOUNT_CURRENCY,
		dd.INTENDED_AMOUNT,
		dd.RMB_INTENDED_AMOUNT,
		dd.PER_SHARE,

		CASE WHEN dd.RMB_INTENDED_AMOUNT != 0 AND pp.CURRENT_AMOUNT != 0
		THEN RTrim(to_char(NVL(dd.RMB_INTENDED_AMOUNT*100 / pp.CURRENT_AMOUNT, 0), 'FM999999999999999999999990.99'),
		'.')
		ELSE '0' END as PERCENT,
		dd.INVE_ROUNDS,
		dd.FINA_ROUNDS,
		dd.FINA_TIMES,
		(select min(g.OCCUR_DT) from XJL_T_LEDGER_MAG g where g.status!='1' and   g.proj_id=aaa.proj_id and g.LEDGER_TYPE='1' and g.OCCUR_DT is not null group by
		proj_id)as OCCUR_DT,
		dd.inve_type,nnn.INDUSTRY_NAME,
		(select DECODE((count(aa.LABEL_ID)),'0','否','是') as is_private from base.COMM_T_LABEL aa inner join
		base.COMM_T_ENT_LABEL bb on aa.label_id=bb.label_id where 1=1 and bb.ent_id=bbb.ENTERPRISE_ID and
		aa.LABEL_ID='16') as is_private,
		(select DECODE((count(aa.LABEL_ID)),'0','否','是') as is_technology from base.COMM_T_LABEL aa inner join
		base.COMM_T_ENT_LABEL bb on aa.label_id=bb.label_id where 1=1 and bb.ent_id=bbb.ENTERPRISE_ID and
		aa.LABEL_ID='15') as is_technology,
		(select DECODE((count(aa.LABEL_ID)),'0','否','是') as is_strategy from base.COMM_T_LABEL aa inner join
		base.COMM_T_ENT_LABEL bb on aa.label_id=bb.label_id where 1=1 and bb.ent_id=bbb.ENTERPRISE_ID and
		aa.LABEL_ID='4') as is_strategy,
		nnn.IS_DIRECTOR_CNT,
		nnn.IS_SUPERVISOR_CNT,
		dd.POST_MONEY,
		nm.ENTE_POST_VALUE,
		nm.INVE_NEW_VALUE,
		nm.HOLD_SHARE,
		nnn.IS_PUBLIC_COMP,
		nnn.IS_PROVINCE,
		nnn.phase,
		nnn.HLIGHTS_REMARK,
        (select sum(QUIT_PRINCIPAL) from TZ_T_FUND_QUIT_APPL gg where  gg.status!='9' and   gg.proj_id=aaa.proj_id  group
        by gg.proj_id)as QUIT_RMB_INVE_AMOUNT,
        (select sum(QUIT_PROFIT) from TZ_T_FUND_QUIT_APPL gg where  gg.status!='9' and   gg.proj_id=aaa.proj_id  group
        by gg.proj_id)as QUIT_SY,
		tt.QUIT_DT as QUIT_DT,
        tt.QUIT_WAY as EXIT_TYPE
		from (
		select DISTINCT aa.*,aa.inve_name as inveNames from TZ_T_PROJ_INFO aa where inve_id in(
		select a.fund_id from ei.bd_t_fund_info a inner
		join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT
		where b.inve_id=#{paramMap.fundId} and b.proj_type='2' and b.status!='2' and a.status!='2'
		and OLD_SUB_PLAT_PROP in('2','4') and b.proj_status!='9'
		) and aa.proj_type='1' and aa.status!='2'
		union all
		<!--二级母基金投参股基金然后再投项目  -->
		select f.*,f.inve_name as inveNames from
		ei.bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and b.inve_id=#{paramMap.fundId}
		and b.proj_type='2' and a.status!='2' and
		b.status!='2' and OLD_SUB_PLAT_PROP in('2','3','4') and b.proj_status!='9'
		inner join tz_t_proj_info c on c.INVE_ID=a.fund_id and c.status!='2' and c.proj_type='2'
		and c.proj_status!='9'
		left join bd_t_fund_info d on c.PROJ_OBJECT=d.fund_id and d.status!='2'
		inner join tz_t_proj_info f on f.INVE_ID=d.fund_id and f.status!='2' and f.proj_type='1'
		union all
		select aa.*,b.fund_name as inveNames from  tz_t_proj_info a
		inner join  bd_t_fund_info b on b.fund_id=a.PROJ_OBJECT  and a.inve_id=#{paramMap.fundId}
		and b.OLD_SUB_PLAT_PROP='5' and a.proj_status!='9' and a.status!='2'
		inner join tz_t_proj_info d on d.inve_id=b.fund_id and d.proj_type='2' and d.status!='2'
		and d.proj_status!='9'
		inner join bd_t_fund_info m on d.proj_object=m.fund_id and m.status!='2' and m.OLD_SUB_PLAT_PROP in('4','6','3','2')
		inner join tz_t_proj_info aa on aa.inve_id=m.fund_id and aa.proj_type='1' and aa.status!='2'
		)aaa
		left join master.T_ENT_BASE_INFO bbb on bbb.ENTERPRISE_ID=aaa.proj_object
		left join EI.BD_T_ENTE_INFO nnn on nnn.ENTERPRISE_ID=aaa.OLD_ENTERPRISE_ID
		left join ei.tz_t_proj_app_info dd on dd.proj_id=aaa.proj_id
		left join ei.bd_t_fund_info pp on pp.fund_id=aaa.inve_id
		left join
		(SELECT ROW_NUMBER() OVER(PARTITION BY am.ia_id ORDER BY am.CREATE_DT DESC) RN,
		am.ENTE_POST_VALUE,am.INVE_NEW_VALUE,am.ia_id,am.HOLD_SHARE
		FROM TZ_T_PROJ_VALUATION am
		where am.status!='9'
		)nm on nm.ia_id=aaa.proj_id AND nm.rn='1'
		left join
		(SELECT ROW_NUMBER() OVER(PARTITION BY ggm.proj_id ORDER BY ggm.QUIT_DT desc) RM,
        ggm.QUIT_DT,ggm.QUIT_WAY,ggm.proj_id
        FROM TZ_T_FUND_QUIT_APPL ggm
        where  ggm.status!='9'
		)tt on tt.proj_id=aaa.proj_id AND tt.RM='1'
		<where>
			1=1
			<include refid="searchCondition.searchClause"/>
			ORDER BY   aaa.INVE_ID DESC,aaa.proj_id DESC
		</where>
		)ggg where
		<![CDATA[ROWNUM < #{paramMap.end}]]>
		)nnn where  nnn.rowno > #{paramMap.begin}
		)fm
		left join EI.GF_T_FUND_ENTE kkk on kkk.ENTE_ID=fm.proj_object
		and (kkk.YEAR=(to_char(to_date(#{paramMap.year},'yyyy'),'yyyy'))
		or kkk.YEAR=to_char(to_number(to_CHAR(fm.OCCUR_DT,'yyyy'))-1) )
		where 1=1 order by fm.inve_id desc,fm.proj_id desc,  kkk.year asc

	</select>

	<select id="projExportList" resultMap="projExportResult12"  parameterType="com.founder.ssm.core.common.SearchCondition" >

		<!--二级母基金投项目 -->
		select mmm.*,
		kkk.YEAR,
		kkk.STAFF_NUM,
		kkk.RD_STAFF_NUM,
		kkk.TOTAL_ASSETS,
		kkk.TOTAL_LIABILITIES,
		kkk.OWNER_EQUITY,
		kkk.TOTAL_INCOME,
		kkk.TOTAL_PROFIT,
		kkk.NET_PROFIT,
		kkk.RD_FEE,
		kkk.PAY_FEE
		from (select DISTINCT
		aaa.INVE_ID,
		aaa.proj_name,
		aaa.proj_id,
		aaa.proj_object,
		aaa.inveNames as inve_name,
		aaa.update_dt,
		bbb.name as enteName,
		nnn.SETUP_DT,
		nnn.REG_ADD,
		bbb.START_DATE,
		bbb.ADDRESS_DETAILS,
		bbb.REGIST_CAPI,
		nnn.REG_AMOUNT,
		nnn.REG_AMOUNT_CURRENCY,
		dd.INTENDED_AMOUNT,dd.RMB_INTENDED_AMOUNT,
		dd.PER_SHARE,
		CASE WHEN dd.RMB_INTENDED_AMOUNT != 0 AND pp.CURRENT_AMOUNT != 0
		THEN  RTrim(to_char(NVL(dd.RMB_INTENDED_AMOUNT*100 / pp.CURRENT_AMOUNT, 0), 'FM999999999999999999999990.99'), '.')
		ELSE '0' END as PERCENT,
		dd.INVE_ROUNDS,
		dd.FINA_ROUNDS,
		dd.FINA_TIMES,
		(select min(g.OCCUR_DT) from XJL_T_LEDGER_MAG g where g.status!='1' and    g.proj_id=aaa.proj_id and g.LEDGER_TYPE='1'   group by proj_id)as OCCUR_DT,
		dd.inve_type,nnn.INDUSTRY_NAME,
		(select DECODE((count(aa.LABEL_ID)),'0','否','是') as is_private from base.COMM_T_LABEL aa inner join base.COMM_T_ENT_LABEL bb on  aa.label_id=bb.label_id where 1=1  and bb.ent_id=bbb.ENTERPRISE_ID  and aa.LABEL_ID='16') as is_private,
		(select DECODE((count(aa.LABEL_ID)),'0','否','是')  as is_technology from base.COMM_T_LABEL aa inner join base.COMM_T_ENT_LABEL bb on  aa.label_id=bb.label_id where 1=1  and bb.ent_id=bbb.ENTERPRISE_ID  and aa.LABEL_ID='15') as is_technology,
		(select DECODE((count(aa.LABEL_ID)),'0','否','是')  as is_strategy from base.COMM_T_LABEL aa inner join base.COMM_T_ENT_LABEL bb on  aa.label_id=bb.label_id where 1=1  and bb.ent_id=bbb.ENTERPRISE_ID  and aa.LABEL_ID='4') as is_strategy,
		nnn.IS_DIRECTOR_CNT,
		nnn.IS_SUPERVISOR_CNT,
		dd.POST_MONEY,
		nm.ENTE_POST_VALUE,
		nm.INVE_NEW_VALUE,
		nm.HOLD_SHARE,
		nnn.IS_PUBLIC_COMP,
		nnn.IS_PROVINCE,
		nnn.phase,
		nnn.HLIGHTS_REMARK,
        (select sum(QUIT_PRINCIPAL) from TZ_T_FUND_QUIT_APPL gg where  gg.status!='9' and   gg.proj_id=aaa.proj_id  group
        by gg.proj_id)as QUIT_RMB_INVE_AMOUNT,
        (select sum(QUIT_PROFIT) from TZ_T_FUND_QUIT_APPL gg where  gg.status!='9' and   gg.proj_id=aaa.proj_id  group
        by gg.proj_id)as QUIT_SY,
		tt.QUIT_DT ,
        tt.QUIT_WAY as EXIT_TYPE
		from (
		select DISTINCT aa.*,aa.inve_name as inveNames from TZ_T_PROJ_INFO aa
		where inve_id
		in(select a.fund_id from  ei.bd_t_fund_info a  inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT
		 where b.inve_id=#{paramMap.fundId} and b.proj_type='2' and b.status!='2' and a.status!='2'
		 and OLD_SUB_PLAT_PROP in(2,4) and b.proj_status!='9'
		) and aa.proj_type='1' and aa.status!='2'
		union all
		select aa.*,b.reg_name as inveNames from  tz_t_proj_info a
		inner join  bd_t_fund_info b on b.fund_id=a.PROJ_OBJECT and a.status!='2' and b.status!='2'
		and a.inve_id=#{paramMap.fundId} and b.OLD_SUB_PLAT_PROP='5' and a.proj_status!='9'
		inner join tz_t_proj_info d on d.inve_id=b.fund_id and d.proj_type='2'
		and d.status!='2' and d.proj_status!='9'
		inner join bd_t_fund_info m on d.proj_object=m.fund_id and m.status!='2' and m.OLD_SUB_PLAT_PROP in(2,4,6,3)
		inner join tz_t_proj_info aa on aa.inve_id=m.fund_id and aa.proj_type='1' and aa.status!='2'
		union all
		<!--二级母基金投参股基金然后再投项目  -->
		select  f.*,f.inve_name as inveNames from
		ei.bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT  and b.inve_id=#{paramMap.fundId}
		and b.proj_type='2' and b.status!='2' and OLD_SUB_PLAT_PROP in('2','3','4')
		and b.proj_status!='9' and a.status!='2'
		inner join tz_t_proj_info c on c.INVE_ID=a.fund_id and c.status!='2' and c.proj_type='2' and c.proj_status!='9'
		left join bd_t_fund_info d on c.PROJ_OBJECT=d.fund_id  and d.status!='2'
		inner join tz_t_proj_info f on f.INVE_ID=d.fund_id and f.status!='2' and f.proj_type='1'
		)aaa
		left join master.T_ENT_BASE_INFO bbb on bbb.ENTERPRISE_ID=aaa.proj_object
		left join EI.BD_T_ENTE_INFO nnn on nnn.ENTERPRISE_ID=aaa.OLD_ENTERPRISE_ID
		left join ei.tz_t_proj_app_info dd on dd.proj_id=aaa.proj_id
		left join ei.bd_t_fund_info pp on pp.fund_id=aaa.inve_id and pp.status!='2'
		left join
		(SELECT ROW_NUMBER() OVER(PARTITION BY am.ia_id ORDER BY am.CREATE_DT DESC) RN,
		am.ENTE_POST_VALUE,am.INVE_NEW_VALUE,am.OBJECT_ID,am.ia_id,am.HOLD_SHARE
		FROM TZ_T_PROJ_VALUATION  am
		where am.status!='9'
		)nm on nm.ia_id=aaa.proj_id AND nm.rn='1'
		left join
		(SELECT ROW_NUMBER() OVER(PARTITION BY ggm.proj_id ORDER BY ggm.QUIT_DT desc) RM,
        ggm.QUIT_DT,ggm.QUIT_WAY,ggm.proj_id
        FROM TZ_T_FUND_QUIT_APPL ggm
        where  ggm.status!='9'
		)tt on tt.proj_id=aaa.proj_id AND tt.RM='1'
		<where>
		1=1
			<include refid="searchCondition.searchClause" />
			ORDER BY aaa.INVE_ID DESC ,aaa.proj_id desc
		</where>)mmm
		left join EI.GF_T_FUND_ENTE kkk on kkk.ENTE_ID=mmm.proj_object
		and (kkk.YEAR=(to_char(to_date(#{paramMap.year},'yyyy'),'yyyy')) or kkk.YEAR=to_char(to_number(to_CHAR(mmm.OCCUR_DT,'yyyy'))-1) )
		where  1=1  order by mmm.inve_id desc,mmm.proj_id desc,kkk.year asc
	</select>



    <select id="projLedgeExportList" resultMap="ledgeResult"  parameterType="com.founder.ssm.core.common.SearchCondition">
		select fm.*,  mm.OCCUR_AMOUNT,
		mm.OCCUR_DT,
		mm.RMB_INVE_AMOUNT,
		mm.LEDGER_ID,
		tt.FUND_AMOUNT as FUND_AMOUNT_STR,
		tt.FUND_AMOUNT as FUND_AMOUNT,
		tt.DIS_DATA,
		tt.DIS_JC_AMOUNT,
		tt.DIS_JC_AMOUNT AS DIS_JC_AMOUNT_STR,
		tt.PK_ID,
		(select sum(tt.DIS_JC_AMOUNT) from BD_T_FUND_ACCOUNT_DETAIL tt where  tt.FUND_ID=fm.FUND_ID and tt.status='0'
		<if test='paramMap.beginTime != null and paramMap.beginTime != ""' >
			<![CDATA[ and to_date(to_char(tt.DIS_DATA, 'yyyy-MM-dd'),'yyyy-MM-dd')>= to_date(#{paramMap.beginTime}, 'yyyy-MM-dd')]]>
		</if>
		<if test='paramMap.endTime != null and paramMap.endTime != ""' >
			<![CDATA[ and to_date(to_char(tt.DIS_DATA, 'yyyy-MM-dd'),'yyyy-MM-dd')<= to_date(#{paramMap.endTime}, 'yyyy-MM-dd')]]>
		</if>

		) as sum_DIS_JC_AMOUNT_STR

		from
		(select * from (
		SELECT ROWNUM AS rowno,nnn.*,
		greatest((nvl(JC_RMB_RAISE_AMOUNT,0)-nvl(SUM_DIS_JC_AMOUNT,0)),0) as SURPLUS_AMOUNT,
		CASE WHEN nvl(SUM_DIS_JC_AMOUNT,0) != 0 AND nvl(jc_RMB_RAISE_AMOUNT,0) != 0
		THEN  RTrim(to_char(NVL(SUM_DIS_JC_AMOUNT*100 / jc_RMB_RAISE_AMOUNT, 0), 'FM999999999999999999999990.99'), '.')
		ELSE '0' END as PERCENT,
		(NVL(SUM_DIS_JC_AMOUNT,0)-nvl(jc_RMB_RAISE_AMOUNT,0))as PROFIT_AMOUNT
		from (
		select DISTINCT  a.inve_name,a.inve_id,a.updateDt, a.OLD_SUB_PLAT_PROP,a.proj_id,a.FUND_ID,a.REG_NAME,a.CURRENT_AMOUNT,a.RMB_CURRENT_AMOUNT,a.RAISE_AMOUNT,

		(select sum(RMB_INVE_AMOUNT) from RZ_T_FUND_SHARE_INFO aa where aa.INVESTOR_ID='20064' and a.fund_id=aa.fund_id )as jc_RMB_INVE_AMOUNT,
		(select sum(INVE_AMOUNT) from RZ_T_FUND_SHARE_INFO aa where aa.INVESTOR_ID='20064' and a.fund_id=aa.fund_id )as jc_INVE_AMOUNT,

		(select nvl(sum(RMB_INVE_AMOUNT),0) from XJL_T_LEDGER_MAG aa where aa.status!='1' and    aa.OBJECT_ID='20064' and a.proj_id=aa.proj_id GROUP BY OBJECT_ID,proj_id)as JC_RMB_RAISE_AMOUNT,

		(select nvl(sum(DIS_JC_AMOUNT),0)as SUM_DIS_JC_AMOUNT from BD_T_FUND_ACCOUNT_DETAIL ss where  ss.FUND_ID=a.fund_id and ss.status='0' GROUP by  fund_id) as SUM_DIS_JC_AMOUNT,
		(select sum(pp.BACK_AMOUNT) from  TZ_T_FUND_QUIT_APPL pp where pp.proj_id=a.PROJ_ID and pp.status!='9'  )as SUM_BACK_AMOUNT,
		(select sum(decode(uu.RMB_INTENDED_AMOUNT,null,uu.INTENDED_AMOUNT,uu.RMB_INTENDED_AMOUNT)) from tz_t_proj_info cc
		inner join TZ_T_PROJ_APP_INFO uu on uu.proj_id=cc.proj_id
		where status!='2' and cc.INVE_ID=a.fund_id and proj_type in(1,2)
		)as SUM_RAISE_AMOUNT,
		aaa.ACCOUNT_BALANCE as NEW_ACCOUNT_BALANCE ,
		aaa.PK_ID as pk_id1,
		ccc.PLAN_AMOUNT as JC_RMB_INVE_AMOUNT_ONE
		from (
		select a.*,b.INVE_NAME,b.inve_id,b.PROJ_ID,b.update_dt as updateDt from bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and a.status!='2' and b.status!='2'
		and  b.proj_status in(7,8,9,15)
		and b.proj_type='2' and a.OLD_SUB_PLAT_PROP in(2,3,6) where
		b.inve_id =#{paramMap.fundId,jdbcType=VARCHAR}
		union all
		select a.*,b.INVE_NAME,b.inve_id,b.PROJ_ID,b.update_dt from bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and a.status!='2' and b.status!='2'
		and  b.proj_status in(7,8,9,15)
		and b.proj_type='2' and a.OLD_SUB_PLAT_PROP in(4) where b.inve_id=#{paramMap.fundId,jdbcType=VARCHAR}
		union all
		select b.*,a.inve_name,a.inve_id,a.proj_id,a.update_dt from  tz_t_proj_info a
		inner join  bd_t_fund_info b on b.fund_id=a.PROJ_OBJECT
		and a.inve_id=#{paramMap.fundId,jdbcType=VARCHAR}
		and b.OLD_SUB_PLAT_PROP='5' and a.proj_status in(7,8,9,15)
		and a.status!='2' and b.status!='2'
		union all
		select a.*,b.INVE_NAME,b.inve_id,b.PROJ_ID,b.update_dt from
		bd_t_fund_info a inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT
		and b.proj_status in(7,8,9,15) and b.status!='2' and a.status!='2'
		where b.inve_id in(select a.fund_id from bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and a.status!='2'
		and b.proj_type='2' and a.OLD_SUB_PLAT_PROP in(2,3,4) and b.proj_status in(7,8,9,15)
		where b.inve_id =#{paramMap.fundId,jdbcType=VARCHAR}) and a.status!='2' and b.status!='2'
		) a
		left join (SELECT ROW_NUMBER() OVER(PARTITION BY a.FUND_ID ORDER BY a.DIS_DATA DESC) RN,
		a.FUND_ID,a.ACCOUNT_BALANCE,a.CREATE_DT,a.PK_ID
		FROM BD_T_FUND_ACCOUNT_DETAIL a where a.status='0' and a.ACCOUNT_BALANCE is not null)aaa on aaa.fund_id=a.FUND_ID and RN='1'
		left join (
		SELECT ROW_NUMBER() OVER(PARTITION BY a.proj_id ORDER BY a.CREATE_DT DESC) RN,
		bb.PLAN_AMOUNT,a.proj_id,bb.PAID_AMOUNT,INVESTOR_ID,a.CREATE_DT,bb.INVESTOR_NAME
		FROM TZ_T_PROJ_OWNERSHIP_INFO  a
		inner join TZ_T_PROJ_SHARE_INFO bb on a.OS_ID=bb.OS_ID
		where  bb.STATUS='0'
		and bb.INVESTOR_ID='20064'
		)ccc on ccc.proj_id=a.proj_id AND ccc.rn='1' and a.OLD_SUB_PLAT_PROP in(4,6)
		WHERE a.OLD_SUB_PLAT_PROP IN(2,4,5,6)
		order by a.updateDt desc
		)nnn
		<where>
			<![CDATA[ROWNUM < #{paramMap.end}]]>
			<include refid="searchCondition.searchClause" />
		</where>
		)ggg  WHERE ggg.rowno > #{paramMap.begin}
		)fm
		left join XJL_T_LEDGER_MAG mm on mm.proj_id=fm.proj_id and mm.OBJECT_ID='20064' and mm.LEDGER_TYPE='1' and  mm.status!='1'   and mm.proj_id is not null
		left join BD_T_FUND_ACCOUNT_DETAIL tt on tt.FUND_ID=fm.FUND_ID and tt.status='0'
		<if test='paramMap.beginTime != null and paramMap.beginTime != ""' >
			<![CDATA[ and to_date(to_char(tt.DIS_DATA, 'yyyy-MM-dd'),'yyyy-MM-dd')>= to_date(#{paramMap.beginTime}, 'yyyy-MM-dd')]]>
		</if>
		<if test='paramMap.endTime != null and paramMap.endTime != ""' >
			<![CDATA[ and to_date(to_char(tt.DIS_DATA, 'yyyy-MM-dd'),'yyyy-MM-dd')<= to_date(#{paramMap.endTime}, 'yyyy-MM-dd')]]>
		</if>


		where 1=1 order by fm.inve_id desc,fm.fund_id desc, mm.OCCUR_DT asc NULLS LAST,tt.DIS_DATA asc NULLS LAST
	</select>

	<select id="getCountLedgeMage"  resultType="Integer"   parameterType="com.founder.ssm.core.common.SearchCondition">
		SELECT COUNT(1) FROM (select nnn.*,
		(nvl(JC_RMB_RAISE_AMOUNT,0)-nvl(SUM_DIS_JC_AMOUNT,0)) as SURPLUS_AMOUNT,
		CASE WHEN nvl(SUM_DIS_JC_AMOUNT,0) != 0 AND nvl(jc_RMB_RAISE_AMOUNT,0) != 0
		THEN  RTrim(to_char(NVL(SUM_DIS_JC_AMOUNT *100 / jc_RMB_RAISE_AMOUNT, 0), 'FM999999999999999999999990.99'), '.')
		ELSE '0' END as PERCENT,
		(NVL(SUM_DIS_JC_AMOUNT,0)-nvl(jc_RMB_RAISE_AMOUNT,0))as PROFIT_AMOUNT
		from (select DISTINCT  a.inve_name,a.inve_id,a.fund_id,a.proj_id,a.updatedt,a.REG_NAME,a.CURRENT_AMOUNT,a.RMB_CURRENT_AMOUNT,a.RAISE_AMOUNT,

		(select sum(RMB_INVE_AMOUNT) from RZ_T_FUND_SHARE_INFO aa where aa.INVESTOR_ID='20064' and a.fund_id=aa.fund_id )as jc_RMB_INVE_AMOUNT,
		(select sum(INVE_AMOUNT) from RZ_T_FUND_SHARE_INFO aa where aa.INVESTOR_ID='20064' and a.fund_id=aa.fund_id )as jc_INVE_AMOUNT,

		(select nvl(sum(RMB_INVE_AMOUNT),0) from XJL_T_LEDGER_MAG aa where aa.OBJECT_ID='20064' and a.proj_id=aa.proj_id GROUP BY OBJECT_ID,PROJ_ID)as JC_RMB_RAISE_AMOUNT,

		(select nvl(sum(DIS_JC_AMOUNT),0)as SUM_DIS_JC_AMOUNT from BD_T_FUND_ACCOUNT_DETAIL ss where  ss.FUND_ID=a.fund_id and ss.status='0' GROUP by  fund_id) as SUM_DIS_JC_AMOUNT,
		(select sum(pp.BACK_AMOUNT) from  TZ_T_FUND_QUIT_APPL pp where  pp.proj_id=a.PROJ_ID  and pp.STATUS!='9')as SUM_BACK_AMOUNT,
		(select sum(decode(uu.RMB_INTENDED_AMOUNT,null,uu.INTENDED_AMOUNT,uu.RMB_INTENDED_AMOUNT)) from tz_t_proj_info cc
		inner join TZ_T_PROJ_APP_INFO uu on uu.proj_id=cc.proj_id
		where status!='2' and cc.INVE_ID=a.fund_id and proj_type in(1,2)
		)as SUM_RAISE_AMOUNT,
		aaa.ACCOUNT_BALANCE as NEW_ACCOUNT_BALANCE ,
		aaa.PK_ID as pk_id1

		from (select a.*,b.INVE_NAME,b.inve_id,b.proj_id,b.update_dt as updateDt from bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and a.status!='2' and b.status!='2' and b.proj_status in(7,8,9,15)
		and b.proj_type='2' and a.OLD_SUB_PLAT_PROP in(2,3,6) where b.inve_id=#{paramMap.fundId,jdbcType=VARCHAR}
		union all
		select a.*,b.INVE_NAME,b.inve_id,b.proj_id,b.update_dt as updateDt from bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and a.status!='2' and b.status!='2' and  b.proj_status in(7,8,9,15)
		and b.proj_type='2' and a.OLD_SUB_PLAT_PROP in(4) where b.inve_id=#{paramMap.fundId,jdbcType=VARCHAR}
		union all
		select b.*,a.inve_name,a.inve_id,a.proj_id,a.update_dt as updateDt from  tz_t_proj_info a
		inner join  bd_t_fund_info b on b.fund_id=a.PROJ_OBJECT  and a.inve_id= #{paramMap.fundId}
		and b.OLD_SUB_PLAT_PROP='5' and b.status!='2' and a.proj_status in(7,8,9,15)
		union all
		select a.*,b.INVE_NAME,b.inve_id,b.proj_id,b.update_dt as updateDt from   bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and b.status!='2' and  b.proj_status in(7,8,9,15)
		where b.inve_id in(select a.fund_id from bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and a.status!='2'
		and b.proj_type='2' and a.OLD_SUB_PLAT_PROP in(2,3,4)  and b.status!='2'
		where b.inve_id= #{paramMap.fundId,jdbcType=VARCHAR} and b.proj_status in(7,8,9,15)
		)
		and a.status!='2' and b.status!='2'

		) a
		left join (SELECT ROW_NUMBER() OVER(PARTITION BY a.FUND_ID ORDER BY a.CREATE_DT DESC) RN,
		a.FUND_ID,a.ACCOUNT_BALANCE,a.CREATE_DT,a.PK_ID
		FROM BD_T_FUND_ACCOUNT_DETAIL a where status='0')aaa on aaa.fund_id=a.FUND_ID and RN='1'
		WHERE a.OLD_SUB_PLAT_PROP IN(2,4,5,6)
		)nnn
		<where>
			1=1
			<include refid="searchCondition.searchClause" />
		</where>
		order by nnn.inve_id desc,nnn.fund_id desc
		)
	</select>



	<select id="ledgeExportList" resultMap="ledgeResult"  parameterType="com.founder.ssm.core.common.SearchCondition">
		select nnn.*,
		greatest((nvl(JC_RMB_RAISE_AMOUNT,0)-nvl(SUM_DIS_JC_AMOUNT,0)),0) as SURPLUS_AMOUNT,
		CASE WHEN nvl(SUM_DIS_JC_AMOUNT,0) != 0 AND nvl(jc_RMB_RAISE_AMOUNT,0) != 0
		THEN  RTrim(to_char(NVL(SUM_DIS_JC_AMOUNT*100 / jc_RMB_RAISE_AMOUNT, 0), 'FM999999999999999999999990.99'), '.')
		ELSE '0' END as PERCENT,
		(NVL(SUM_DIS_JC_AMOUNT,0)-nvl(jc_RMB_RAISE_AMOUNT,0))as PROFIT_AMOUNT
		from (select DISTINCT  a.fund_id,a.inve_id,a.inve_name,a.OLD_SUB_PLAT_PROP, a.REG_NAME,a.CURRENT_AMOUNT,a.RMB_CURRENT_AMOUNT,a.RAISE_AMOUNT,
		<!--金财认缴总额-->
		(select sum(RMB_INVE_AMOUNT) from RZ_T_FUND_SHARE_INFO aa where aa.INVESTOR_ID='20064' and a.fund_id=aa.fund_id )as jc_RMB_INVE_AMOUNT,
		(select sum(INVE_AMOUNT) from RZ_T_FUND_SHARE_INFO aa where aa.INVESTOR_ID='20064' and a.fund_id=aa.fund_id )as jc_INVE_AMOUNT,
		<!--金财t投资实缴总额 -->
		(select nvl(sum(RMB_INVE_AMOUNT),0) from XJL_T_LEDGER_MAG aa where aa.OBJECT_ID='20064' and a.proj_id=aa.proj_id GROUP BY OBJECT_ID,proj_id)as JC_RMB_RAISE_AMOUNT,
		<!--分配金财投资金额 -->
		(select nvl(sum(DIS_JC_AMOUNT),0)as SUM_DIS_JC_AMOUNT from BD_T_FUND_ACCOUNT_DETAIL ss where  ss.FUND_ID=a.fund_id and ss.status='0' GROUP by  fund_id) as SUM_DIS_JC_AMOUNT,
		(select sum(pp.BACK_AMOUNT) from tz_t_proj_info kk inner join TZ_T_FUND_QUIT_APPL pp on pp.proj_id=kk.PROJ_ID where kk.inve_id=a.fundIds and kk.STATUS!='2')as SUM_BACK_AMOUNT,
		(select sum(decode(uu.RMB_INTENDED_AMOUNT,null,uu.INTENDED_AMOUNT,uu.RMB_INTENDED_AMOUNT))
		from tz_t_proj_info cc
		inner join TZ_T_PROJ_APP_INFO uu on uu.proj_id=cc.proj_id
		where status!='2' and cc.INVE_ID=a.fundIds and proj_type in(1,2)
		)as SUM_RAISE_AMOUNT,
		mm.OCCUR_AMOUNT,
		mm.OCCUR_DT,
		mm.RMB_INVE_AMOUNT,
		mm.LEDGER_ID,
		(select sum(decode(uu.RMB_INTENDED_AMOUNT,null,uu.INTENDED_AMOUNT,uu.RMB_INTENDED_AMOUNT)) from tz_t_proj_info cc
		inner join TZ_T_PROJ_APP_INFO uu on uu.proj_id=cc.proj_id
		where status!='2' and cc.INVE_ID=a.fund_id and proj_type in(1,2)
		)as SUM_JC_RAISE_AMOUNT,
		aaa.ACCOUNT_BALANCE as NEW_ACCOUNT_BALANCE ,
		aaa.PK_ID as pk_id1,
		tt.FUND_AMOUNT AS FUND_AMOUNT_STR,
		tt.DIS_DATA,
		tt.DIS_JC_AMOUNT AS DIS_JC_AMOUNT_STR,
		tt.PK_ID,
		ccc.PLAN_AMOUNT as JC_RMB_INVE_AMOUNT_ONE,
		a.updatedt,
		a.proj_id,
		(	select sum(tt.DIS_JC_AMOUNT) from BD_T_FUND_ACCOUNT_DETAIL tt where  tt.FUND_ID=a.FUND_ID and tt.status='0'
		<if test='paramMap.beginTime != null and paramMap.beginTime != ""' >
			<![CDATA[ and to_date(to_char(tt.DIS_DATA, 'yyyy-MM-dd'),'yyyy-MM-dd')>= to_date(#{paramMap.beginTime}, 'yyyy-MM-dd')]]>
		</if>
		<if test='paramMap.endTime != null and paramMap.endTime != ""' >
			<![CDATA[ and to_date(to_char(tt.DIS_DATA, 'yyyy-MM-dd'),'yyyy-MM-dd')<= to_date(#{paramMap.endTime}, 'yyyy-MM-dd')]]>
		</if>
		) as sum_DIS_JC_AMOUNT_STR

		from (
		select a.*,b.INVE_NAME,b.inve_id,b.proj_id,b.update_dt as updateDt,a.fund_id as fundIds from bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and a.status!='2' and b.status!='2' and  b.proj_status in(7,8,9,15)
		and b.proj_type='2' and a.OLD_SUB_PLAT_PROP in(2,3,6) where b.inve_id in(select fund_id from bd_t_fund_info where OLD_SUB_PLAT_PROP='1'  and fund_id= #{paramMap.fundId})
		union all
		select a.*,b.INVE_NAME,b.inve_id,b.proj_id ,b.update_dt as updateDt,a.fund_id as fundIds from bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and a.status!='2' and b.status!='2' and  b.proj_status in(7,8,9,15)
		and b.proj_type='2' and a.OLD_SUB_PLAT_PROP in(4) where b.inve_id in(select fund_id from bd_t_fund_info where OLD_SUB_PLAT_PROP='1'  and fund_id= #{paramMap.fundId})
		union all
		select b.*,a.inve_name,a.inve_id,a.proj_id,a.update_dt as updateDt,m.fund_id as fundIds from  tz_t_proj_info a
		inner join  bd_t_fund_info b on b.fund_id=a.PROJ_OBJECT  and a.inve_id=#{paramMap.fundId}
		and b.OLD_SUB_PLAT_PROP='5' and a.proj_status in(7,8,9,15)
		left join tz_t_proj_info d on d.inve_id=b.fund_id and d.proj_type='2' and d.status!='2'
		left join bd_t_fund_info m on d.proj_object=m.fund_id and m.status!='2' and m.OLD_SUB_PLAT_PROP in('4','6')
		union all
		select a.*,b.INVE_NAME,b.inve_id,b.proj_id,b.update_dt as updateDt ,a.fund_id as fundIds from   bd_t_fund_info a
		inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and a.status!='2' and b.status!='2' and  b.proj_status in(7,8,9,15)
		where b.inve_id in(select a.fund_id from bd_t_fund_info a inner join tz_t_proj_info b on a.fund_id=b.PROJ_OBJECT and a.status!='2'
		and b.proj_type='2' and a.OLD_SUB_PLAT_PROP in(2) where b.inve_id in(select fund_id from bd_t_fund_info where OLD_SUB_PLAT_PROP='1'  and fund_id= #{paramMap.fundId}))
		and a.status!='2' and b.status!='2') a
		left join (SELECT ROW_NUMBER() OVER(PARTITION BY a.FUND_ID ORDER BY a.DIS_DATA DESC) RN,
		a.FUND_ID,a.ACCOUNT_BALANCE,a.CREATE_DT,a.PK_ID
		FROM BD_T_FUND_ACCOUNT_DETAIL a where a.status='0' and a.ACCOUNT_BALANCE is not null)aaa on aaa.fund_id=a.FUND_ID and RN='1'
		left join XJL_T_LEDGER_MAG mm on mm.proj_id=a.proj_id and mm.OBJECT_ID='20064' and mm.LEDGER_TYPE='1' and mm.proj_id is not null
		left join BD_T_FUND_ACCOUNT_DETAIL tt on tt.FUND_ID=a.FUND_ID and tt.status='0'
		<if test='paramMap.beginTime != null and paramMap.beginTime != ""' >
			<![CDATA[ and to_date(to_char(tt.DIS_DATA, 'yyyy-MM-dd'),'yyyy-MM-dd')>= to_date(#{paramMap.beginTime}, 'yyyy-MM-dd')]]>
		</if>
		<if test='paramMap.endTime != null and paramMap.endTime != ""' >
			<![CDATA[ and to_date(to_char(tt.DIS_DATA, 'yyyy-MM-dd'),'yyyy-MM-dd')<= to_date(#{paramMap.endTime}, 'yyyy-MM-dd')]]>
		</if>

		left join (
		SELECT ROW_NUMBER() OVER(PARTITION BY a.proj_id ORDER BY a.CREATE_DT DESC) RN,
		bb.PLAN_AMOUNT,a.proj_id,bb.PAID_AMOUNT,INVESTOR_ID,a.CREATE_DT,bb.INVESTOR_NAME
		FROM TZ_T_PROJ_OWNERSHIP_INFO  a
		inner join TZ_T_PROJ_SHARE_INFO bb on a.OS_ID=bb.OS_ID
		where  bb.STATUS='0'
		and bb.INVESTOR_ID='20064'
		)ccc on ccc.proj_id=a.proj_id AND ccc.rn='1'
		WHERE a.OLD_SUB_PLAT_PROP IN(2,4,5,6)
		)nnn
		<where>
			<include refid="searchCondition.searchClause" />
		</where>
		order by nnn.inve_id desc,nnn.fund_id desc, nnn.OCCUR_DT asc NULLS LAST,nnn.DIS_DATA asc NULLS LAST
	</select>

	<select id="selectAllFundList"  resultMap="FundInfoResult" parameterType="com.founder.ssm.core.common.SearchCondition">
		select * from (
			select * from ei.bd_t_fund_info where status!='2' and OLD_SUB_PLAT_PROP in(6)
			union all
			select a.* from ei.bd_t_fund_info a
			left join tz_t_proj_info b on b.PROJ_OBJECT=a.fund_id and b.proj_type='2' and b.status!='2'
			where a.status!='2' and a.OLD_SUB_PLAT_PROP in(2,4) and b.proj_status in(7,8,9)
		)

	</select>

    <select id="selectFundInfoList"  parameterType="String" resultMap="DataQuarterResult">
     select  DISTINCT * from (
	 select  DISTINCT c.proj_id as BIZ_KEY_VALUE,a.loginname,a.id as USER_BIZ_VALUE,'1' as DATA_TYPE,'proj_id'as BIZ_KEY,'bd_t_fund_info'as BIZ_TABLE,c.proj_name as TASK_TITLE
	 from base.app_user a
	 left join BD_T_FUND_ADMIN b on a.LOGINNAME=b.ADMIN_NAME
	 left join (
	 select DISTINCT mm.proj_id,mm.proj_name,c.MC_NAME,c.MC_ID,c.fund_name  from bd_t_fund_info c
	 inner join tz_t_proj_info mm on mm.PROJ_OBJECT=c.FUND_ID
	 and  mm.PROJ_STATUS in(7,8,9,15) and c.status!='2'  AND MM.GROUP_ID!='1' AND mm.status!='2'
	 and  c.OLD_SUB_PLAT_PROP IN('4','5','6')
	 ) c on b.ADMIN_ID=c.mc_id
	 left join APP_USERROLE d on a.id=d.USERID and d.ROLEID='10031'
	 where a.USERTYPE='5' and c.proj_id is not null
	 union all
	  select DISTINCT d.proj_id,a.loginname,a.id,'1'as type ,'proj_id'as BIZ_KEY,'tz_t_proj_info'as BIZ_TABLE,d.proj_name as TASK_TITLE from base.app_user a
	  left join BD_T_FUND_ADMIN c on c.ADMIN_NAME=a.LOGINNAME
	  left join bd_t_fund_info b on (b.CREATE_BY=to_char(a.id) or b.MC_id=c.ADMIN_ID)
	  and b.OLD_SUB_PLAT_PROP='6' and b.status!='2'
	  inner join tz_t_proj_info d on d.proj_object=b.fund_id and d.proj_type='2' and d.status!='2'
	  where a.USERTYPE='5' and  b.fund_id is not null   AND d.GROUP_ID!='1'
		 union all
		 <!--查看的企业信息-->
		select DISTINCT d.proj_id,a.loginname,a.id,'2'as type ,'proj_id'as BIZ_KEY,'tz_t_proj_info'as BIZ_TABLE,d.proj_name as TASK_TITLE from base.app_user a
		inner join tz_t_proj_info d  on d.create_by=to_char(a.id) and d.proj_type='1' and d.status!='2'
	    where a.USERTYPE='5'
		union all
		SELECT DISTINCT  m.proj_id,bb.loginname,bb.id,'3' as type,'proj_id'as BIZ_KEY,'TZ_T_PROJ_INFO'as BIZ_TABLE,m.proj_name as TASK_TITLE
		FROM BD_T_FUND_ACCOUNT_MAPING T
		INNER JOIN BD_T_FUND_INFO F ON F.FUND_STS!='8' AND  F.OLD_SUB_PLAT_PROP = '2' AND F.REP_ID = T.ADMIN_ID
		INNER JOIN TZ_T_PROJ_INFO M ON M.PROJ_OBJECT=F.FUND_ID AND M.STATUS!='2' AND M.PROJ_TYPE='2'
		LEFT JOIN BASE.APP_USER bb on bb.LOGINNAME=T.USER_ID
		WHERE 1=1 AND T.IS_REP = 'rep'

 )
    </select>

	<select id="getSendFundList" parameterType="String" resultMap="DataQuarterResult">
     	SELECT bb.id AS USER_BIZ_VALUE,'3' as DATA_TYPE,'proj_id'as BIZ_KEY,'TZ_T_PROJ_INFO'as BIZ_TABLE,M.proj_name as TASK_TITLE,M.PROJ_ID AS BIZ_KEY_VALUE,bb.loginname
		FROM BD_T_FUND_ACCOUNT_MAPING T
		INNER JOIN BD_T_FUND_INFO F ON F.FUND_STS!='8' AND  F.OLD_SUB_PLAT_PROP = '2' AND F.REP_ID = T.ADMIN_ID
		INNER JOIN TZ_T_PROJ_INFO M ON M.PROJ_OBJECT=F.FUND_ID AND M.STATUS!='2' AND M.PROJ_TYPE='2'
		LEFT JOIN BASE.APP_USER bb on bb.LOGINNAME=T.USER_ID
		WHERE 1=1 AND T.IS_REP = 'rep'
	</select>
    <select id="selectSendAdminList"  parameterType="String" resultMap="DataQuarterResult11">
      select  DISTINCT * from (
	 select a.loginname,b.PHONE_NO,a.id as userBizValue
	 from base.app_user a
	 left join BD_T_FUND_ADMIN b on a.LOGINNAME=b.ADMIN_NAME
	 left join (
	 select DISTINCT mm.proj_id,mm.proj_name,c.MC_NAME,c.MC_ID,c.fund_name  from bd_t_fund_info c
	 inner join tz_t_proj_info mm on mm.PROJ_OBJECT=c.FUND_ID
	 and  mm.PROJ_STATUS in(7,8,9,15) and c.status!='2' AND mm.status!='2'  AND mm.GROUP_ID!='1'
	 and  c.OLD_SUB_PLAT_PROP  IN('4','5','6')
	 ) c on b.ADMIN_ID=c.mc_id
	 left join APP_USERROLE d on a.id=d.USERID and d.ROLEID='10031'
	 where a.USERTYPE='5' and c.proj_id is not null
	 union all
	  select DISTINCT  a.loginname,c.PHONE_NO,a.id as userBizValue from base.app_user a
	  left join BD_T_FUND_ADMIN c on c.ADMIN_NAME=a.LOGINNAME
	  left join bd_t_fund_info b on (b.CREATE_BY=to_char(a.id) or b.MC_id=c.ADMIN_ID)
	  and b.OLD_SUB_PLAT_PROP='6' and b.status!='2'
	  inner join tz_t_proj_info d on d.proj_object=b.fund_id and d.proj_type='2' and d.status!='2'
	  where a.USERTYPE='5' and  b.fund_id is not null

	    union all
		SELECT DISTINCT  bb.loginname,c.PHONE_NO,bb.id as userBizValue
		FROM BD_T_FUND_ACCOUNT_MAPING T
		INNER JOIN BD_T_FUND_INFO F ON F.FUND_STS!='8' AND  F.OLD_SUB_PLAT_PROP = '2' AND F.REP_ID = T.ADMIN_ID and F.status!='2'
		INNER JOIN TZ_T_PROJ_INFO M ON M.PROJ_OBJECT=F.FUND_ID AND M.STATUS!='2' AND M.PROJ_TYPE='2' AND m.group_id!='1'
		LEFT JOIN BASE.APP_USER bb on bb.LOGINNAME=T.USER_ID
		left join BD_T_FUND_ADMIN c on c.ADMIN_NAME=bb.LOGINNAME
		WHERE 1=1 AND T.IS_REP = 'rep'
 ) where PHONE_NO is not null


    </select>


	<select id="getFundMcInfo" resultMap="DataQuarterResult" parameterType="String">
	   select DISTINCT a.fund_id as BIZ_KEY_VALUE,c.loginname,c.id as USER_BIZ_VALUE,'6' as DATA_TYPE,'fund_id'as BIZ_KEY,a.reg_name as TASK_TITLE,'bd_t_fund_info'as BIZ_TABLE from bd_t_fund_info a
		left join BD_T_FUND_MC_INFO b on a.mc_id=b.mc_id
		left join base.app_user c on c.id=b.USER_ID
		where  a.fund_src='1' and a.status!='2' and a.group_id='1'
	</select>




	<select id="getBankInfo" resultMap="DataQuarterResult" parameterType="String">
		select a.fund_id as BIZ_KEY_VALUE ,c.loginname,c.id as USER_BIZ_VALUE,'11' as DATA_TYPE,'fund_id'as BIZ_KEY,a.reg_name as TASK_TITLE,'bd_t_fund_info'as BIZ_TABLE from  bd_t_fund_info a
		inner join BD_T_BANK_INFO b on a.CUSTODIAN_BANK=b.BANK_NAME
		left join  base.app_user c on c.id=b.USER_ID
		where a.fund_src='1' and a.group_id='1' and a.status!='2'
	</select>






</mapper>
