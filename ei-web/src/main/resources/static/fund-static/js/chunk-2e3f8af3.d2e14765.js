(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e3f8af3","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4"],{"2c2d":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"upload-box"},[e.hiddenUpload?a("div",{staticClass:"fileView"},e._l(e.fileLists,(function(t){return a("h3",{key:t.uid},[a("a",{attrs:{href:e.contextPath+"attachController/download?fileId="+t.uid,target:"_blank"}},[e._v(e._s(t.name))])])})),0):e._e(),e._v(" "),e.hiddenUpload?e._e():a("div",{staticClass:"el-upload-box"},[a("el-upload",{ref:"upload",attrs:{limit:e.limit,action:e.updatePath,"auto-upload":!0,name:e.upLoadName,data:e.extraData,"file-list":e.fileLists,accept:e.acceptFormat,"on-success":e.handleSuccess,"on-exceed":e.handleExceed,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-error":e.handleError,"on-change":e.handleChange,"before-remove":e.beforeRemove,"before-upload":e.beforeUpload}},[a("el-button",{class:{active:e.hiddenUpload},attrs:{size:e.size,type:"primary"}},[e._v("\n        "+e._s(e.uploadTitle)+"\n      ")]),e._v(" "),e.isShowTip?a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.TipTitle))]):e._e()],1)],1)])},i=[],s=(a("fc02"),a("a450"),a("e680"),a("7f43")),o=a.n(s),l={name:"GuluUpload",model:{prop:"value",event:"update-value"},props:{value:[String],isShowTip:{type:Boolean,default:!0},hiddenUpload:{type:Boolean,default:!1},TipTitle:{type:String,default:"最大可上传50M文件"},uploadTitle:{type:String,default:"点击上传"},limit:{type:Number,default:50},extraData:{type:Object,default:function(){return{bizTableName:"",bizTablePk:"",fieldName:""}}},size:{type:String,default:"small"},upLoadName:{type:String,default:"file"},contextPath:{type:String,default:"/ei-web/"},acceptFormat:{type:String,default:".jpg,.jpeg,.png,.gif,.bmp,.pdf,.JPG,.JPEG,.PBG,.GIF,.BMP,.PDF,.rp,.vsd"}},data:function(){return{fileList:[],fileLists:[]}},watch:{value:function(e){null!==e&&void 0!==e&&""!==e?this.getFileData():(this.fileLists=[],this.fileList=[])},hiddenUpload:function(){},fileLists:function(e){}},computed:{updatePath:function(){var e="".concat(this.contextPath,"attachController/upload?fieldToken=").concat(this.value?this.value:"");return e}},created:function(){null!==this.value&&void 0!==this.value&&""!==this.value?this.getFileData():(this.fileLists=[],this.fileList=[])},methods:{getFileData:function(e){var t=this,a=e||this.value;""!=a&&null!=a||(a="-1");var n=this.contextPath+"attachController/getFileList?fieldToken="+a;o()({url:n,method:"get"}).then((function(e){"0"===e.data.status&&e.data.data.fileList&&t.$nextTick((function(){t.fileLists=e.data.data.fileList,e.data.data.fileList.length>0&&(t.fileList=e.data.data.fileList),0===t.fileLists.length&&(t.$emit("update-value",""),this.fileLists=[],this.fileList=[])}))}))},beforeUpload:function(e){},handleChange:function(e,t){var a=e.name.substring(e.name.lastIndexOf(".")+1),n="rp"===a,i="vsd"===a;(n||i)&&(this.$message({offset:150,message:"上传文件不能是 rp 、vsd 格式!",type:"warning"}),this.$refs.upload.clearFiles())},handleExceed:function(e,t){this.$message.warning("当前限制选择 ".concat(e.length," 个文件，本次选择了 ").concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},handleRemove:function(e,t){var a=this;o()({url:this.contextPath+"attachController/delete?fileId="+e.uid,method:"get"}).then((function(e){"0"===e.data.status&&(0==t.length?(a.$emit("update-value",""),a.fileLists=[],a.fileList=[]):a.fileLists=t)}))},handleError:function(e,t,a){},handleSuccess:function(e,t,a){var n=e.data.fieldToken;void 0==n&&(n=this.value);var i=this.updatePath.split("=");""!=i[1]&&""==n&&(n=i[1]),this.$emit("update-value",n),this.fileLists=a,this.getFileData(n)},beforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},handlePreview:function(e){window.open(this.contextPath+"attachController/download?fileId="+e.uid)}}},c=l,r=(a("e116"),a("4ac2")),d=Object(r["a"])(c,n,i,!1,null,"e22390a6",null);t["a"]=d.exports},"352f":function(e,t,a){"use strict";a("c457")},"91e8":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.instId,expression:"instId"}],attrs:{id:"instId",type:"hidden"},domProps:{value:e.instId},on:{input:function(t){t.target.composing||(e.instId=t.target.value)}}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.taskId,expression:"taskId"}],attrs:{id:"taskId",type:"hidden"},domProps:{value:e.taskId},on:{input:function(t){t.target.composing||(e.taskId=t.target.value)}}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.formUri,expression:"formUri"}],attrs:{id:"formUri",type:"hidden"},domProps:{value:e.formUri},on:{input:function(t){t.target.composing||(e.formUri=t.target.value)}}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.formUriView,expression:"formUriView"}],attrs:{id:"formUriView",type:"hidden"},domProps:{value:e.formUriView},on:{input:function(t){t.target.composing||(e.formUriView=t.target.value)}}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.pshow,expression:"pshow"}],attrs:{id:"pshow",type:"hidden"},domProps:{value:e.pshow},on:{input:function(t){t.target.composing||(e.pshow=t.target.value)}}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.phid,expression:"phid"}],attrs:{id:"phid",type:"hidden"},domProps:{value:e.phid},on:{input:function(t){t.target.composing||(e.phid=t.target.value)}}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.contentPath,expression:"contentPath"}],attrs:{id:"contentPath",type:"hidden"},domProps:{value:e.contentPath},on:{input:function(t){t.target.composing||(e.contentPath=t.target.value)}}}),e._v(" "),a("table",{staticClass:"addtable",staticStyle:{"margin-top":"0px","margin-bottom":"10px"},attrs:{id:"formToolBarTable",width:"100%",border:"0",cellspacing:"0",cellpadding:"0"}},[e._m(0),e._v(" "),a("tr",{staticStyle:{border:"1px solid #D9D9D9"}},[a("td",{staticClass:"td_name",staticStyle:{width:"20%",padding:"0px","font-size":"13px","text-align":"center","vertical-align":"middle",color:"#997528",background:"#eae3d8"}},[e._v("处理意见")]),e._v(" "),a("td",{staticClass:"td_value",staticStyle:{width:"82%",padding:"6px"},attrs:{colspan:"3"}},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.taskProcessDescValue,expression:"taskProcessDescValue"}],staticStyle:{width:"100%",height:"70px","border-radius":"4px"},attrs:{name:"taskProcessDesc",id:"taskProcessDesc"},domProps:{value:e.taskProcessDescValue},on:{input:function(t){t.target.composing||(e.taskProcessDescValue=t.target.value)}}})])]),e._v(" "),a("tr",[a("td",{staticClass:"td_name",staticStyle:{width:"18%"}}),e._v(" "),a("td",{staticClass:"td_value drawablel",staticStyle:{width:"82%"},attrs:{colspan:"3",id:"processToolBar"}},[1===e.allcommshow?e._l(e.commandes,(function(t){return a("button",{staticClass:"el-button el-button--primary el-button--small",attrs:{id:t.id,type:"primary"},on:{click:function(a){return e.btnHandel(t)}}},[e._v(e._s(t.name))])})):e._e(),e._v(" "),0===!e.allcommshow?e._l(e.commandes,(function(t){return t.fixParam_BeforeShowJS?a("button",{staticClass:"el-button el-button--primary el-button--small",attrs:{id:t.id,type:"primary"},on:{click:function(a){return e.btnHandel(t)}}},[e._v(e._s(t.name)+"\n          ")]):e._e()})):e._e()],2)])])])},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tr",[a("td",{attrs:{colspan:"4"}},[a("div",{staticClass:"panel-header panel-title",staticStyle:{"border-left":"0px","border-right":"0px","border-top":"0px","margin-top":"1px","margin-bottom":"1px"}},[e._v("流程审批\n        ")])])])}],s=a("e1da"),o=s["a"],l=(a("ac8e"),a("4ac2")),c=Object(l["a"])(o,n,i,!1,null,"3b8cec4e",null);t["a"]=c.exports},"9e85":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("div",{staticClass:"dialog-item"},[a("div",{staticClass:"dialog-item-title"},[e._v("公开征集")]),e._v(" "),a("el-row",{staticClass:"infoRow",attrs:{align:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:4}},[e._v("\n          母基金名称\n        ")]),e._v(" "),a("el-col",{staticClass:"col-content",attrs:{span:8}},[e._v("\n          "+e._s(e.dialogInfo.fundName)+"\n        ")]),e._v(" "),a("el-col",{staticClass:"col-title",attrs:{span:4}},[e._v("\n          母基金规模(万元)\n        ")]),e._v(" "),a("el-col",{staticClass:"col-content",attrs:{span:8}},[e._v("\n          "+e._s(e.dialogInfo.fundSize)+"\n        ")])],1),e._v(" "),a("el-row",{staticClass:"infoRow",attrs:{align:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:4}},[e._v("\n          拟征集规模(万元)\n        ")]),e._v(" "),a("el-col",{staticClass:"col-content",attrs:{span:8}},[e._v("\n          "+e._s(e.dialogInfo.planSize)+"\n        ")]),e._v(" "),a("el-col",{staticClass:"col-title",attrs:{span:4}},[e._v("\n          拟征集数量(家)\n        ")]),e._v(" "),a("el-col",{staticClass:"col-content",attrs:{span:8}},[e._v("\n          "+e._s(e.dialogInfo.planNum)+"\n        ")])],1),e._v(" "),a("el-row",{staticClass:"infoRow",attrs:{align:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:4}},[e._v("\n          征集开始日期\n        ")]),e._v(" "),a("el-col",{staticClass:"col-content",attrs:{span:8}},[e._v("\n          "+e._s(e.dialogInfo.startDate)+"\n        ")]),e._v(" "),a("el-col",{staticClass:"col-title",attrs:{span:4}},[e._v("\n          征集截止日期\n        ")]),e._v(" "),a("el-col",{staticClass:"col-content",attrs:{span:8}},[e._v("\n          "+e._s(e.dialogInfo.endDate)+"\n        ")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-item"},[a("div",{staticClass:"dialog-item-title"},[e._v("征集信息")]),e._v(" "),a("el-row",{staticClass:"infoRow",attrs:{align:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:4}},[e._v("\n          已征集规模(万元)\n        ")]),e._v(" "),a("el-col",{staticClass:"col-content",attrs:{span:8}},[e.isEdit?a("el-input",{attrs:{size:"small"},model:{value:e.dialogInfo.cooSize,callback:function(t){e.$set(e.dialogInfo,"cooSize",t)},expression:"dialogInfo.cooSize"}}):e._e(),e._v(" "),e.isEdit?e._e():a("div",[e._v("\n            "+e._s(e.dialogInfo.cooSize)+"\n          ")])],1),e._v(" "),a("el-col",{staticClass:"col-title",attrs:{span:4}},[e._v("\n          已征集数量(家)\n          "),a("span",{staticClass:"mustIn"},[e._v("*")])]),e._v(" "),a("el-col",{staticClass:"col-content",attrs:{span:8}},[e.isEdit?a("el-input",{attrs:{size:"small"},model:{value:e.dialogInfo.totalCooNum,callback:function(t){e.$set(e.dialogInfo,"totalCooNum",t)},expression:"dialogInfo.totalCooNum"}}):e._e(),e._v(" "),e.isEdit?e._e():a("div",[e._v("\n            "+e._s(e.dialogInfo.totalCooNum)+"\n          ")])],1)],1),e._v(" "),a("el-row",{staticClass:"infoRow",attrs:{align:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:4}},[e._v("\n          符合征集条件(家)\n          "),a("span",{staticClass:"mustIn"},[e._v("*")])]),e._v(" "),a("el-col",{staticClass:"col-content",attrs:{span:20}},[e.isEdit?a("el-input",{attrs:{size:"small"},model:{value:e.dialogInfo.fitCooNum,callback:function(t){e.$set(e.dialogInfo,"fitCooNum",t)},expression:"dialogInfo.fitCooNum"}}):e._e(),e._v(" "),e.isEdit?e._e():a("div",[e._v("\n            "+e._s(e.dialogInfo.fitCooNum)+"\n          ")])],1)],1),e._v(" "),a("el-row",{staticClass:"infoRow",attrs:{align:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:4}},[e._v("\n          附件说明\n        ")]),e._v(" "),a("el-col",{staticClass:"col-content",attrs:{span:20}},[e.isEdit?a("el-input",{attrs:{size:"small",type:"textarea",rows:4},model:{value:e.dialogInfo.attaDetail,callback:function(t){e.$set(e.dialogInfo,"attaDetail",t)},expression:"dialogInfo.attaDetail"}}):e._e(),e._v(" "),e.isEdit?e._e():a("pre",[e._v("            "+e._s(e.dialogInfo.attaDetail)+"\n          ")])],1)],1),e._v(" "),a("el-row",{staticClass:"infoRow",attrs:{align:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:4}},[e._v("\n          相关附件\n        ")]),e._v(" "),a("el-col",{staticClass:"col-content",attrs:{span:20}},[a("upLoad",{staticStyle:{width:"100%"},attrs:{"context-path":e.url.upApi,"hidden-upload":!e.isEdit},model:{value:e.dialogInfo.attaFile,callback:function(t){e.$set(e.dialogInfo,"attaFile",t)},expression:"dialogInfo.attaFile"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-item"},[a("div",{staticClass:"dialog-item-title"},[e._v("基金管理人")]),e._v(" "),a("div",[e.isEdit?a("div",{staticClass:"btnBox"},[a("button",{on:{click:e.addFundManage}},[a("i",{staticClass:"iconfont iconjiahao"}),e._v(" "),a("div",[e._v("新增")])]),e._v(" "),a("button",{on:{click:e.editFundManage}},[a("i",{staticClass:"iconfont iconbianji"}),e._v(" "),a("div",[e._v("编辑")])])]):a("div",{staticClass:"btnBox"},[a("button",{on:{click:e.lookFundManage}},[a("i",{staticClass:"iconfont iconsousuo"}),e._v(" "),a("div",[e._v("查看")])])]),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.fundManageTableList.data,"header-cell-style":{background:"#EaE3d8",color:"#333",fontSize:"12px",textAlign:"center"},border:""},on:{"selection-change":e.fundManageChange}},[a("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"300",prop:"fundAdminName",label:"基金管理人"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"200",prop:"fundName",label:"子基金"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"100",prop:"isFit",label:"是否符合"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"===t.row.isFit?a("div",[e._v("是")]):e._e(),e._v(" "),"0"===t.row.isFit?a("div",[e._v("否")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"100",prop:"raiseAmount",label:"基金规模(万元)"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"100",prop:"fundAdminApplyMoney",label:"申请金额(万元)"}}),e._v(" "),e.isEdit?a("el-table-column",{attrs:{align:"center","min-width":"100",prop:"",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.delManage(t)}}},[e._v("删除")])]}}],null,!1,3238357728)}):e._e()],1)],1)])]),e._v(" "),"view"!==e.steps?a("div",{attrs:{id:"myDiv"}},[a("div",{staticClass:"processTitle"},[e._v("审批信息")]),e._v(" "),e.iframeShows?a("iframe",{attrs:{id:"contentFrame_sp",src:e.src,width:"100%",frameborder:"0",scrolling:"no"}}):e._e()]):e._e(),e._v(" "),"view"!==e.steps?a("process",{ref:"process",attrs:{"content-path":e.url.urlApi},on:{action:e.action}}):e._e(),e._v(" "),a("el-dialog",{attrs:{title:e.fundManageTitle,visible:e.fundManageVisible,width:"90%"},on:{"update:visible":function(t){e.fundManageVisible=t},close:e.fundManageInfoClose}},[a("div",{staticClass:"dialog-item"},[a("el-row",{staticClass:"infoRow",attrs:{align:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:4}},[e._v("\n          子基金\n          "),a("span",{staticClass:"mustIn"},[e._v("*")])]),e._v(" "),"基金管理人详情"!==e.fundManageTitle?a("el-col",{staticClass:"col-content",attrs:{span:8}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",size:"small",remote:"","reserve-keyword":"",placeholder:"请输入关键词","remote-method":e.searchFundList,loading:e.loading},on:{change:e.getFund},model:{value:e.fundManageInfo.creditCode,callback:function(t){e.$set(e.fundManageInfo,"creditCode",t)},expression:"fundManageInfo.creditCode"}},e._l(e.childFundList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),e._v(" "),"基金管理人详情"===e.fundManageTitle?a("el-col",{staticClass:"col-content",attrs:{span:8}},[e._v("\n          "+e._s(e.fundManageInfo.fundName)+"\n        ")]):e._e(),e._v(" "),a("el-col",{staticClass:"col-title",attrs:{span:4}},[e._v("\n          基金管理人\n          "),a("span",{staticClass:"mustIn"},[e._v("*")])]),e._v(" "),"基金管理人详情"!==e.fundManageTitle?a("el-col",{staticClass:"col-content",attrs:{span:8}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",size:"small",remote:"","reserve-keyword":"",placeholder:"请输入关键词","remote-method":e.searchFundManage,loading:e.loading},on:{change:e.getManage},model:{value:e.fundManageInfo.fundAdminId,callback:function(t){e.$set(e.fundManageInfo,"fundAdminId",t)},expression:"fundManageInfo.fundAdminId"}},e._l(e.fundManageList,(function(e){return a("el-option",{key:e.adminId,attrs:{label:e.adminName,value:e.adminId}})})),1)],1):e._e(),e._v(" "),"基金管理人详情"===e.fundManageTitle?a("el-col",{staticClass:"col-content",attrs:{span:8}},[e._v("\n          "+e._s(e.fundManageInfo.fundAdminName)+"\n        ")]):e._e()],1),e._v(" "),a("el-row",{staticClass:"infoRow",attrs:{align:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:4}},[e._v("\n          是否符合\n          "),a("span",{staticClass:"mustIn"},[e._v("*")])]),e._v(" "),"基金管理人详情"!==e.fundManageTitle?a("el-col",{staticClass:"col-content",attrs:{span:8}},[a("el-radio",{attrs:{label:"1"},model:{value:e.fundManageInfo.isFit,callback:function(t){e.$set(e.fundManageInfo,"isFit",t)},expression:"fundManageInfo.isFit"}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:"0"},model:{value:e.fundManageInfo.isFit,callback:function(t){e.$set(e.fundManageInfo,"isFit",t)},expression:"fundManageInfo.isFit"}},[e._v("否")])],1):e._e(),e._v(" "),"基金管理人详情"===e.fundManageTitle?a("el-col",{staticClass:"col-content",attrs:{span:8}},["1"===e.fundManageInfo.isFit?a("div",[e._v("是")]):e._e(),e._v(" "),"0"===e.fundManageInfo.isFit?a("div",[e._v("否")]):e._e()]):e._e(),e._v(" "),a("el-col",{staticClass:"col-title",attrs:{span:4}},[e._v("\n          基金规模(万元)\n        ")]),e._v(" "),"基金管理人详情"!==e.fundManageTitle?a("el-col",{staticClass:"col-content",attrs:{span:8}},[a("el-input",{attrs:{size:"small"},model:{value:e.fundManageInfo.raiseAmount,callback:function(t){e.$set(e.fundManageInfo,"raiseAmount",t)},expression:"fundManageInfo.raiseAmount"}})],1):e._e(),e._v(" "),"基金管理人详情"===e.fundManageTitle?a("el-col",{staticClass:"col-content",attrs:{span:8}},[e._v("\n          "+e._s(e.fundManageInfo.raiseAmount)+"\n        ")]):e._e()],1),e._v(" "),a("el-row",{staticClass:"infoRow",attrs:{align:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:4}},[e._v("\n          申请金额(万元)\n        ")]),e._v(" "),"基金管理人详情"!==e.fundManageTitle?a("el-col",{staticClass:"col-content",attrs:{span:20}},[a("el-input",{attrs:{size:"small"},model:{value:e.fundManageInfo.fundAdminApplyMoney,callback:function(t){e.$set(e.fundManageInfo,"fundAdminApplyMoney",t)},expression:"fundManageInfo.fundAdminApplyMoney"}})],1):e._e(),e._v(" "),"基金管理人详情"===e.fundManageTitle?a("el-col",{staticClass:"col-content",attrs:{span:20}},[e._v("\n          "+e._s(e.fundManageInfo.fundAdminApplyMoney)+"\n        ")]):e._e()],1)],1),e._v(" "),a("div",{staticClass:"dialog-item"},[a("div",{staticClass:"dialog-item-title"},[e._v("征集材料")]),e._v(" "),"基金管理人详情"!==e.fundManageTitle?a("div",{staticClass:"btnBox"},[a("button",{on:{click:e.addCollectionMaterial}},[a("i",{staticClass:"iconfont iconjiahao"}),e._v(" "),a("div",[e._v("新增")])]),e._v(" "),a("button",{on:{click:e.editCollectionMaterial}},[a("i",{staticClass:"iconfont iconbianji"}),e._v(" "),a("div",[e._v("编辑")])])]):e._e(),e._v(" "),"基金管理人详情"===e.fundManageTitle?a("div",{staticClass:"btnBox"},[a("button",{on:{click:e.lookCollectionMaterial}},[a("i",{staticClass:"iconfont iconsousuo"}),e._v(" "),a("div",[e._v("查看")])])]):e._e(),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.fundManageInfo.conditionFileModels,"header-cell-style":{background:"#FEFAFA",color:"#333",fontSize:"12px",textAlign:"center"},border:""},on:{"selection-change":e.materialChange}},[a("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"300",prop:"fileTypeName",label:"征集材料类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.getFileType(t.row.fileType))+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"160",prop:"fileDate",label:"发生时间"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"300",prop:"fileDetail",label:"附件说明"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"300",prop:"attaFile",label:"附件"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.attaFile?a("upLoad",{attrs:{"hidden-upload":!0,"context-path":e.url.upApi},model:{value:t.row.attaFile,callback:function(a){e.$set(t.row,"attaFile",a)},expression:"scope.row.attaFile"}}):e._e()]}}])}),e._v(" "),e.isEdit?a("el-table-column",{attrs:{align:"center","min-width":"120",prop:"attaFile",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.delCollectionMaterial(t)}}},[e._v("删除")])]}}],null,!1,3283509712)}):e._e()],1)],1),e._v(" "),(e.fundManageTitle,a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelFundMange}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitFundMange}},[e._v("确 认")])],1))]),e._v(" "),a("el-dialog",{attrs:{title:e.materialTitle,visible:e.collectionMaterialVisible,width:"90%"},on:{"update:visible":function(t){e.collectionMaterialVisible=t},close:e.collectionMaterialVisibleClose}},[a("el-row",{staticClass:"infoRow",attrs:{align:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:6}},[e._v("\n        征集材料\n        "),a("span",{staticClass:"mustIn"},[e._v("*")])]),e._v(" "),"征集材料详情"!==e.materialTitle?a("el-col",{staticClass:"col-content",attrs:{span:18}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择",size:"small"},model:{value:e.materialInfo.fileType,callback:function(t){e.$set(e.materialInfo,"fileType",t)},expression:"materialInfo.fileType"}},e._l(e.materialList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),e._v(" "),"征集材料详情"===e.materialTitle?a("el-col",{staticClass:"col-content",attrs:{span:18}},[e._v("\n        "+e._s(e.materialInfo.fileTypeName)+"\n      ")]):e._e()],1),e._v(" "),a("el-row",{staticClass:"infoRow",attrs:{align:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:6}},[e._v("\n        发生日期\n      ")]),e._v(" "),"征集材料详情"!==e.materialTitle?a("el-col",{staticClass:"col-content",attrs:{span:18}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",size:"small",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.materialInfo.fileDate,callback:function(t){e.$set(e.materialInfo,"fileDate",t)},expression:"materialInfo.fileDate"}})],1):e._e(),e._v(" "),"征集材料详情"===e.materialTitle?a("el-col",{staticClass:"col-content",attrs:{span:18}},[e._v("\n        "+e._s(e.materialInfo.fileDate)+"\n      ")]):e._e()],1),e._v(" "),a("el-row",{staticClass:"infoRow",attrs:{align:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:6}},[e._v("\n        附件说明\n      ")]),e._v(" "),"征集材料详情"!==e.materialTitle?a("el-col",{staticClass:"col-content",attrs:{span:18}},[a("el-input",{attrs:{type:"textarea",size:"small",rows:4},model:{value:e.materialInfo.fileDetail,callback:function(t){e.$set(e.materialInfo,"fileDetail",t)},expression:"materialInfo.fileDetail"}})],1):e._e(),e._v(" "),"征集材料详情"===e.materialTitle?a("el-col",{staticClass:"col-content",attrs:{span:18}},[a("pre",[e._v(e._s(e.materialInfo.fileDetail))])]):e._e()],1),e._v(" "),a("el-row",{staticClass:"infoRow",attrs:{align:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:6}},[e._v("\n        附件\n        "),a("span",{staticClass:"mustIn"})]),e._v(" "),a("el-col",{staticClass:"col-content",attrs:{span:18}},[e.collectionMaterialVisible?a("upLoad",{staticStyle:{width:"100%"},attrs:{"context-path":e.url.upApi,"hidden-upload":"征集材料详情"===e.materialTitle},model:{value:e.materialInfo.attaFile,callback:function(t){e.$set(e.materialInfo,"attaFile",t)},expression:"materialInfo.attaFile"}}):e._e()],1)],1),e._v(" "),"征集材料详情"!==e.materialTitle?a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.collectionMaterialVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitMaterialInfo}},[e._v("确 认")])],1):a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.collectionMaterialVisible}},[e._v("关 闭")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"选择公开征集",visible:e.openCollectVisible,width:"90%"},on:{"update:visible":function(t){e.openCollectVisible=t},close:e.fundManageClose}},[a("div",{staticClass:"titleItem-item",staticStyle:{"margin-left":"20px"}},[a("el-input",{staticClass:"searchInput",attrs:{placeholder:"请输入母基金名称",size:"small","prefix-icon":"el-icon-search"},model:{value:e.openCollectListFundName,callback:function(t){e.openCollectListFundName=t},expression:"openCollectListFundName"}}),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.getOpenCollectList(5,1)}}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.removeOpenCollectList}},[e._v("清空")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.openCollectList.data,"header-cell-style":{background:"#eae3d8",color:"#333",fontSize:"12px",textAlign:"center"},border:""},on:{"selection-change":e.openCollectChange}},[a("el-table-column",{attrs:{fixed:"",type:"selection",align:"center",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"",type:"index",label:"序号",align:"center",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"300",prop:"fundName",label:"母基金名称"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"200",prop:"fundSize",label:"母基金规模(万元)"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"200",prop:"planSize",label:"拟征集规模(万元)"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"120",prop:"planNum",label:"拟征集数量(家)"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"120",prop:"startDate",label:"征集开始日期"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"120",prop:"endDate",label:"征集结束日期"}}),e._v(" "),a("el-table-column",{attrs:{align:"center","min-width":"120",prop:"statusName",label:"状态"}})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.openCollectList.currPage,"page-sizes":[5,10,15,20],"page-size":e.openCollectList.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.openCollectList.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.openCollectVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitOpenCollectList}},[e._v("确 认")])],1)],1)],1)},i=[],s=(a("8dee"),a("e680"),a("aa18"),a("982e"),a("1bc7"),a("fc02"),a("2559")),o=a("91e8"),l=a("e19c"),c=a("2c2d"),r=a("7562"),d={name:"SolicitationProcess",components:{upLoad:c["a"],process:o["a"]},data:function(){var e;return e={loading:!1,dialogVisible:!1,modalTitle:"",url:l["a"],dialogInfo:{},fundManageTitle:"",fundManage:[],fundManageVisible:!1,openCollectVisible:!1,openCollectList:{data:[],totalCount:1,currPage:1,pageSize:5},manageIndex:"",openCollectListFundName:"",childFundVisible:!1,fundMcVisible:!1,collectionMaterialVisible:!1,materialList:[{label:"申请书",value:"1"},{label:"承诺函",value:"2"},{label:"基本材料",value:"3"},{label:"其他",value:"4"},{label:"证明材料",value:"5"}],materialInfo:{},materialType:"1",childFundList:[],childFundTotal:5,childFundTable:{page:1,limit:5},fundMcList:[{value:"1",label:"基金管理人1"},{value:"2",label:"基金管理人2"},{value:"3",label:"基金管理人3"}],fundMcTotal:5,fundMcTable:{page:1,limit:5},organizationalForm:"1",organizationalFormList:[{label:"合作企业",value:"1"},{label:"有限责任公司",value:"2"},{label:"股份有限公司",value:"3"},{label:"契约式",value:"4"},{label:"中外合作非法人企业",value:"5"},{label:"行政事业单位",value:"6"},{label:"其他",value:"7"}],choiceChildFundVisible:!1,choiceFundMcVisible:!1,createFundMcInfoVisible:!1,createChildFundInfoVisible:!1,createShareholderInfoVisible:!1,shareholderTable:[],checkList:[],raiseType:[],parentFundList:[{value:"1",label:"母基金名称1"},{value:"1",label:"母基金名称1"}],tableInfo:{data:[],totalCount:1,currPage:1,pageSize:5},fundManageList:[],fundManageTableList:{data:[],totalCount:1,currPage:1,pageSize:5},selectOpenCollect:[],selectCollectList:[],fundMangeKeyword:"",fundManageInfo:{conditionFileModels:[]},selectMaterialList:[],selectFundManage:[],materialTitle:"新增征集材料",status:"",materialIndex:"",submitLoading:!1,src:"",queryInfo:{instId:""},iframeShows:!1,planId:this.$route.query.planId},Object(s["a"])(e,"url",l["a"]),Object(s["a"])(e,"modalTitle","征集信息详情"),Object(s["a"])(e,"dialogInfo",{}),Object(s["a"])(e,"fundManageTableList",{}),Object(s["a"])(e,"steps",""),Object(s["a"])(e,"isEdit",""),e},mounted:function(){var e=this;this.queryInfo=this.$route.query,this.iframeShows=!0,this.src="".concat(l["a"].processUrl,"action/showListview.action?listViewId=fixflowProcessInfosListView&instId=").concat(this.queryInfo.instId,"&listViewFileName=fixflowProcessInfosListViewFirst&frameInd=").concat(this.queryInfo.frameInd),"0"===this.$route.query.edit?this.modalTitle="征集信息详情":this.modalTitle="编辑征集信息",this.steps=this.$route.query.steps,this.isEdit="edit"===this.steps,r["a"].getCollectInformationDetail({conditionId:this.$route.query.bizKey}).then((function(t){e.$forceUpdate(),e.dialogInfo=t.data.data,e.fundManageTableList.data=t.data.data.conditionItemModel,r["a"].getOpenSolicitationDeatil({conditionId:e.dialogInfo.conditionId}).then((function(t){e.dialogInfo.fundName=t.data.data.fundName,e.dialogInfo.fundSize=t.data.data.fundSize,e.dialogInfo.planNum=t.data.data.planNum,e.dialogInfo.planSize=t.data.data.planSize,e.dialogInfo.startDate=t.data.data.startDate,e.dialogInfo.endDate=t.data.data.endDate}))}))},methods:{getParentId:function(e,t){var a=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(sessionStorage.getItem("code".concat(e))){var i=[];if(n){var s=n.split(",");JSON.parse(sessionStorage.getItem("code".concat(e))).forEach((function(e){s.includes(e.value)&&i.push(e)}))}else i=JSON.parse(sessionStorage.getItem("code".concat(e)));this[t]=i}else r["a"].getCodeByParentId({parentId:e}).then((function(i){var s=[];if(n){var o=n.split(",");i.data.data.options.forEach((function(e){o.includes(e.value)&&s.push(e)}))}else s=i.data.data.options;a[t]=s,sessionStorage.setItem("code".concat(e),JSON.stringify(i.data.data.options))}))},getFileType:function(e){var t="";return this.materialList.forEach((function(a){a.value===e&&(t=a.label)})),t},getFundManageList:function(){},handleSelectionChange:function(e){this.selectCollectList=e},fundManageChange:function(e){this.selectFundManage=e},dialogClose:function(){this.dialogInfo={},this.status=""},fundManageClose:function(){},fundManageInfoClose:function(){this.fundManageInfo={},this.fundManageInfo.conditionItemModel=[]},addSolicitation:function(){this.dialogVisible=!0,this.modalTitle="新增征集信息",this.fundManageTableList.data=[]},editSolicitation:function(){var e=this;if(1!==this.selectCollectList.length)this.$message({offset:150,message:"请选择一条数据",type:"warning"});else{if("0"!==this.selectCollectList[0].status)return void this.$message({offset:150,message:"数据已进入审批，不可编辑",type:"warning"});this.dialogVisible=!0,this.modalTitle="编辑征集信息";var t=this.selectCollectList[0].conditionId;this.dialogInfo={},r["a"].getCollectInformationDetail({conditionId:t}).then((function(t){e.$forceUpdate(),e.dialogInfo=t.data.data,e.fundManageTableList.data=t.data.data.conditionItemModel,r["a"].getOpenSolicitationDeatil({conditionId:e.dialogInfo.conditionId}).then((function(t){e.dialogInfo.fundName=t.data.data.fundName,e.dialogInfo.fundSize=t.data.data.fundSize,e.dialogInfo.planNum=t.data.data.planNum,e.dialogInfo.planSize=t.data.data.planSize,e.dialogInfo.startDate=t.data.data.startDate,e.dialogInfo.endDate=t.data.data.endDate}))}))}},lookSolicitation:function(){var e=this;if(1!==this.selectCollectList.length)this.$message({offset:150,message:"请选择一条数据",type:"warning"});else{this.status="look",this.dialogVisible=!0,this.modalTitle="征集信息详情";var t=this.selectCollectList[0].conditionId;this.dialogInfo={},r["a"].getCollectInformationDetail({conditionId:t}).then((function(t){e.$forceUpdate(),e.dialogInfo=t.data.data,e.fundManageTableList.data=t.data.data.conditionItemModel,r["a"].getOpenSolicitationDeatil({conditionId:e.dialogInfo.conditionId}).then((function(t){e.dialogInfo.fundName=t.data.data.fundName,e.dialogInfo.fundSize=t.data.data.fundSize,e.dialogInfo.planNum=t.data.data.planNum,e.dialogInfo.planSize=t.data.data.planSize,e.dialogInfo.startDate=t.data.data.startDate,e.dialogInfo.endDate=t.data.data.endDate}))}))}},getFundList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;r["a"].selectConditionItem({infoId:this.dialogInfo.infoId?this.infoId:"",name:this.fundMangeKeyword,pageSize:t,currPage:a}).then((function(t){e.fundManageTableList=t.data}))},delSolicitation:function(){var e=this;if(0===this.selectCollectList.length)this.$message({offset:150,message:"请至少选择一条数据",type:"warning"});else{var t=[];this.selectCollectList.forEach((function(e){"0"===e.status&&t.push(e.infoId)})),t.length!==this.selectCollectList.length?this.$message({offset:150,message:"进入审核的数据无法删除",type:"warning"}):this.$confirm("确认删除这".concat(t.length,"条数据?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(a){r["a"].delConditionInfoItemAll({infoId:t.join(",")}).then((function(t){"0"===t.data.status&&"成功"===t.data.msg&&e.$message({offset:150,message:"删除成功",type:"success"}),e.$emit("refreshData",e.tableData.pageSize,1)}))})).catch((function(e){}))}},addFundManage:function(){this.fundManageTitle="新建基金管理人",this.fundManageVisible=!0,this.childFundList=[]},editFundManage:function(){var e=this;if(1!==this.selectFundManage.length)this.$message({offset:150,type:"warning",message:"请选择一条数据编辑"});else{this.fundManageTableList.data.forEach((function(t,a){t.fundId===e.selectFundManage[0].fundId&&(e.manageIndex=a)})),this.fundManageTitle="编辑基金管理人",this.fundManageVisible=!0;var t=JSON.parse(JSON.stringify(this.selectFundManage));this.fundManageInfo=t[0],this.$set(this.fundManageInfo,"creditCode",this.fundManageInfo.fundId),this.childFundList=[{value:this.fundManageInfo.fundId,label:this.fundManageInfo.fundName}],this.searchFundManage(this.fundManageInfo.fundAdminName)}},openCollectChange:function(e){this.selectOpenCollect=e},choiceOpenCollect:function(){this.getOpenCollectList(),this.openCollectVisible=!0},getOpenCollectList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;r["a"].getOpenSolicitation({pageSize:t,currPage:a,fundName:this.openCollectListFundName,status:"2"}).then((function(t){"成功"===t.data.msg&&(e.openCollectList=t.data)}))},addCollectionMaterial:function(){this.materialTitle="新增征集材料",this.collectionMaterialVisible=!0},choiceChildFund:function(){this.choiceChildFundVisible=!0},choiceFundMc:function(){this.choiceFundMcVisible=!0},childFundChange:function(){},childFundPageChange:function(){},fundMcChange:function(){},addChildFundInfo:function(){this.createChildFundInfoVisible=!0},addFundMcInfo:function(){this.createFundMcInfoVisible=!0},shareholderChange:function(){},addShareholderInfo:function(){this.createShareholderInfoVisible=!0},openCollectListChange:function(e){this.getOpenCollectList(e.limit,e.page)},fundManageTableListChange:function(){},tableDataChange:function(e){this.$emit("refreshData",e.limit,e.page)},submitOpenCollectList:function(){if(!(this.selectOpenCollect.length>1))return 1===this.selectOpenCollect.length?(this.dialogInfo.conditionId=this.selectOpenCollect[0].conditionId,this.dialogInfo.fundName=this.selectOpenCollect[0].fundName,this.$set(this.dialogInfo,"fundSize",this.selectOpenCollect[0].fundSize),this.dialogInfo.planSize=this.selectOpenCollect[0].planSize,this.dialogInfo.planNum=this.selectOpenCollect[0].planNum,this.dialogInfo.startDate=this.selectOpenCollect[0].startDate,this.dialogInfo.endDate=this.selectOpenCollect[0].endDate,this.dialogInfo.fundId=this.selectOpenCollect[0].fundId,void(this.openCollectVisible=!1)):void(this.openCollectVisible=!1);this.$message({offset:150,type:"warning",message:"请选择一条数据保存"})},submitDialogInfo:function(e){var t=this,a=this.dialogInfo;a.conditionItemModel=this.fundManageTableList.data,a.conditionItemModel.forEach((function(e){e.conditionFileModels&&e.conditionFileModels.length>0&&e.conditionFileModels.forEach((function(e){delete e.createDt,delete e.updateDt})),delete e.createDt,delete e.updateDt})),a.conditionId?void 0!==a.totalCooNum&&null!==a.totalCooNum&&""!==String(a.totalCooNum)?isNaN(Number(String(a.totalCooNum)))?this.$message({offset:150,type:"warning",message:"请填写正确的已征集数量，格式为数字"}):void 0!==a.fitCooNum&&null!==a.fitCooNum&&""!==String(a.fitCooNum)?isNaN(Number(String(a.fitCooNum)))?this.$message({offset:150,type:"warning",message:"请填写正确的符合征集条件，格式为数字"}):(a.tag="save"===e?"1":"0","新增征集信息"===this.modalTitle?(this.submitLoading=!0,r["a"].addConditionInfoItemAll(a).then((function(e){"0"===e.data.status?(t.$message({offset:150,type:"success",message:"新增成功"}),t.submitLoading=!1,t.$emit("refreshData",t.tableData.pageSize,t.tableData.currPage),t.dialogVisible=!1):(t.submitLoading=!1,t.$message({offset:150,type:"warning",message:e.data.msg}))}))):"编辑征集信息"===this.modalTitle?(this.submitLoading=!0,r["a"].upDateCollectInformation(a).then((function(e){"0"===e.data.status?(t.$message({offset:150,type:"success",message:"编辑成功"}),t.dialogVisible=!1,t.submitLoading=!1,t.$emit("refreshData",t.tableData.pageSize,t.tableData.currPage)):(t.submitLoading=!1,t.$message({offset:150,type:"warning",message:e.data.msg}))}))):this.dialogVisible=!1):this.$message({offset:150,type:"warning",message:"请填写符合征集条件，不能为空"}):this.$message({offset:150,type:"warning",message:"请填写已征集数量，不能为空"}):this.$message({offset:150,type:"warning",message:"请关联公开征集信息"})},submitFundMange:function(){this.fundManageInfo.fundId?this.fundManageInfo.fundAdminId?this.fundManageInfo.isFit?(this.fundManageInfo.raiseAmount=this.fundManageInfo.raiseAmount,this.fundManageInfo.fundAdminApplyMoney=this.fundManageInfo.fundAdminApplyMoney,"新建基金管理人"===this.fundManageTitle?this.fundManageTableList.data.push(this.fundManageInfo):this.fundManageTableList.data.splice(this.manageIndex,1,this.fundManageInfo),this.fundManageVisible=!1):this.$message({offset:150,type:"warning",message:"请选择是否符合"}):this.$message({offset:150,type:"warning",message:"请选择基金管理人"}):this.$message({offset:150,type:"warning",message:"请选择子基金"})},submitMaterialInfo:function(){var e=this;this.materialInfo.fileType?(this.materialList.forEach((function(t){t.value===e.materialInfo.fileType&&(e.materialInfo.fileTypeName=t.label)})),"新增征集材料"===this.materialTitle?(this.fundManageInfo.conditionFileModels||(this.fundManageInfo.conditionFileModels=[]),this.fundManageInfo.conditionFileModels.push(this.materialInfo)):this.fundManageInfo.conditionFileModels.splice(this.materialIndex,1,this.materialInfo),this.collectionMaterialVisible=!1):this.$message({offset:150,type:"warning",message:"请选择材料类型"})},collectionMaterialVisibleClose:function(){this.materialInfo={},this.materialInfo.conditionFileModels=[]},editCollectionMaterial:function(){var e=this;if(this.materialTitle="编辑征集材料",1===this.selectMaterialList.length){this.fundManageInfo.conditionFileModels.forEach((function(t,a){t===e.selectMaterialList[0]&&(e.materialIndex=a)})),this.collectionMaterialVisible=!0;var t=JSON.parse(JSON.stringify(this.selectMaterialList)),a=new Array;a=t[0],this.materialInfo=a}else this.$message({offset:150,type:"warning",message:"请选择一条数据编辑"})},delCollectionMaterial:function(e){var t=this;this.$confirm("确认删除这条数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(a){var n=e.$index;t.fundManageInfo.conditionFileModels.splice(n,1)})).catch((function(e){}))},materialChange:function(e){this.selectMaterialList=e},removeOpenCollectList:function(){this.openCollectListFundName="",this.getOpenCollectList()},handleCurrentChange:function(e){this.getOpenCollectList(this.openCollectList.pageSize,e)},handleSizeChange:function(e){this.getOpenCollectList(e,1)},tableDataSizeChange:function(e){this.$emit("refreshData",e,this.tableData.currentPage)},tableDataCurrentChange:function(e){this.$emit("refreshData",this.tableData.pageSize,e)},searchFundList:function(e){var t=this;e?(this.loading=!0,r["a"].QCCSearchData({keyword:e.replace(/\s+/g,"")}).then((function(e){var a=JSON.parse(e.data.data.value);t.loading=!1,null==a.Result||(t.childFundList=a.Result.map((function(e){return{value:e.CreditCode,label:e.Name}})))}))):this.loading=!0},getFund:function(e){var t=this;r["a"].QCCDataGetDetailsByName({keyword:e}).then((function(e){var a=JSON.parse(e.data.data.value).Result;return null===a?(t.$message({offset:150,type:"warning",message:"查询无结果，请重新选择合适数据"}),!1):a})).then((function(e){return t.$set(t.fundManageInfo,"fundName",e.Name?e.Name:"..."),r["a"].saveEntBaseInfo(e)})).then((function(e){"系统异常"!==e.data.msg?t.$set(t.fundManageInfo,"fundId",e.data.msg):(t.$message({offset:150,type:"warning",message:"网络波动，请重新选择"}),t.fundManageInfo.fundId="")})).catch((function(e){console.error(e)}))},searchFundManage:function(e){var t=this;e?(this.loading=!0,r["a"].adminList({keyWord:e.replace(/\s+/g,"")}).then((function(e){t.fundManageList=e.data.data,t.loading=!1}))):this.loading=!0},getManage:function(e){var t=this;this.fundManageList.forEach((function(a){e===a.adminId&&(t.fundManageInfo.fundAdminName=a.adminName)}))},delManage:function(e){var t=this;this.$confirm("确认删除这条数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(a){var n=e.$index;t.fundManageTableList.data.splice(n,1)})).catch((function(e){}))},lookFundManage:function(){var e=this;if(1!==this.selectFundManage.length)this.$message({offset:150,type:"warning",message:"请选择一条数据查看"});else{this.fundManageTableList.data.forEach((function(t,a){t.fundId===e.selectFundManage[0].fundId&&(e.manageIndex=a)})),this.fundManageTitle="基金管理人详情",this.fundManageVisible=!0;var t=JSON.parse(JSON.stringify(this.selectFundManage));this.fundManageInfo=t[0],this.$set(this.fundManageInfo,"creditCode",this.fundManageInfo.fundId),this.childFundList=[{value:this.fundManageInfo.fundId,label:this.fundManageInfo.fundName}],this.searchFundManage(this.fundManageInfo.fundAdminName)}},cancelFundMange:function(){this.fundManageVisible=!1},lookCollectionMaterial:function(){var e=this;if(this.materialTitle="征集材料详情",1===this.selectMaterialList.length){this.fundManageInfo.conditionFileModels.forEach((function(t,a){t===e.selectMaterialList[0]&&(e.materialIndex=a)})),this.collectionMaterialVisible=!0;var t=JSON.parse(JSON.stringify(this.selectMaterialList)),a=new Array;a=t[0],this.materialList.forEach((function(e){e.value===a.fileType&&(a.fileTypeName=e.label)})),this.materialInfo=a}else this.$message({offset:150,type:"warning",message:"请选择一条数据查看"})},action:function(){var e=this,t=this.dialogInfo;t.conditionId?void 0!==t.totalCooNum&&null!==t.totalCooNum&&""!==String(t.totalCooNum)?isNaN(Number(String(t.totalCooNum)))?this.$message({offset:150,type:"warning",message:"请填写正确的已征集数量，格式为数字"}):void 0!==t.fitCooNum&&null!==t.fitCooNum&&""!==String(t.fitCooNum)?isNaN(Number(String(t.fitCooNum)))?this.$message({offset:150,type:"warning",message:"请填写正确的符合征集条件，格式为数字"}):(this.dialogInfo.conditionItemModel.forEach((function(e){e.conditionFileModels&&e.conditionFileModels.length>0&&e.conditionFileModels.forEach((function(e){delete e.createDt,delete e.updateDt})),delete e.createDt,delete e.updateDt})),this.dialogInfo.tag="3",r["a"].upDateCollectInformation(this.dialogInfo).then((function(t){"0"===t.data.status?(e.$refs.process.nextTask(),e.submitLoading=!1):e.submitLoading=!1}))):this.$message({offset:150,type:"warning",message:"请填写符合征集条件，不能为空"}):this.$message({offset:150,type:"warning",message:"请填写已征集数量，不能为空"}):this.$message({offset:150,type:"warning",message:"请关联公开征集信息"})}}},u=d,f=(a("352f"),a("4ac2")),g=Object(f["a"])(u,n,i,!1,null,"247e504a",null);t["default"]=g.exports},ac8e:function(e,t,a){"use strict";a("c73f")},c059:function(e,t,a){},c457:function(e,t,a){},c73f:function(e,t,a){},e116:function(e,t,a){"use strict";a("c059")},e1da:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("a450"),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("fc02"),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es6_number_constructor__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("e680"),core_js_modules_es6_number_constructor__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es6_number_constructor__WEBPACK_IMPORTED_MODULE_2__),axios__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("7f43"),axios__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_3__);__webpack_exports__["a"]={name:"process",props:{allcommshow:{type:Number,default:1},validateFun:Function,contentPath:{type:String,default:"/ei-web/"},contextPath:{type:String,default:"/ei-web/"},extraData:{type:Object,default:function(){return{result:!0,extendParam:""}}}},watch:{taskId:function(e){var t=this;axios__WEBPACK_IMPORTED_MODULE_3___default.a.get(this.contentPath+"workflowProcess/getProcessCommandJSON?taskId="+this.taskId,{taskId:this.taskId}).then((function(e){t.commandes=e.data})).catch((function(e){})),this.showAndHidForm(this.pshow,this.phid)}},data:function(){return{isShowBtn:!1,btnId:"",btnName:"",btnJson:"",taskProcessDescValue:"",submitCount:0,commandes:null,instId:"",taskId:"",formUri:"",formUriView:"",pshow:"",phid:"",theRequest:{},extendParam:"",json:{},websock:""}},mounted:function(){window.location;var e=this.$route.query;this.theRequest=e,this.instId=this.theRequest.instId,this.taskId=this.theRequest.taskId,this.formUri=this.theRequest.formUri,this.formUriView=this.theRequest.formUriView,this.initWebSocket()},destroyed:function(){this.websocketclose()},methods:{initWebSocket:function(){var e="ws://".concat(window.location.host,"/sys-web/websocket/").concat(sessionStorage.getItem("userId"),"000");this.websock=new WebSocket(e),this.websock.onmessage=this.websocketonmessage,this.websock.onopen=this.websocketonopen,this.websock.onerror=this.websocketonerror,this.websock.onclose=this.websocketclose},websocketonopen:function(){},websocketonerror:function(){this.initWebSocket()},websocketonmessage:function(e){console.log("接受到的消息："+e.data)},websocketsend:function(e){this.websock.send(e)},websocketclose:function(e){console.log("断开连接",e),1006===e.code&&this.initWebSocket()},showAndHidForm:function(e,t){if(null!=e&&""!==e)for(var a=e.split(","),n=0;n<a.length;n++)$("#"+a[n]).show();if(null!=t&&""!==t)for(var i=t.split(","),s=0;s<i.length;s++)$("#"+i[s]).attr("style","display:none").hide()},beforeCommandShow:function(){return!0},btnHandel:function(e){var t=e.fixParam_BeforeHandleJS,a=(e.type,"");this.json=e,console.log("undefined"!=typeof t&&null!=t&&""!=t,"fixParam_BeforeHandleJS"===e.id),"退回"===e.name||"不同意"===e.name?this.nextTask():"undefined"!=typeof t&&null!=t&&""!=t||"fixParam_BeforeHandleJS"===e.id?(this.$emit("action"),a="",this.extendParam=""):this.nextTask(),"undefined"!=typeof a&&null!=a&&""!=a||(a="")},nextTask:function(e){var t=this.json;this.doProcessTask("",t.name,t.id,t.type,t,this.extendParam)},doProcessTask:function(e,t,a,n,i,s){document.documentElement.scrollTop=0,this.processTask(t,a,n,i,s)},processTask:function(e,t,a,n,i){var s=this;this.confirmMessage("确认进行"+e+"操作？",(function(e){if(e){document.documentElement.scrollTop=0;var o=s.taskProcessDescValue;if(o.length>2e3)return void s.alertMessage("处理意见超长，最大长度为2000字符！");var l={instId:s.instId,taskId:s.taskId,commandId:t,commandType:a,processDesc:encodeURIComponent(s.taskProcessDescValue),formParam:i},c=!!n.fixParam_taskProcessDescFlag&&n.fixParam_taskProcessDescFlag,r=n.fixParam_taskProcessDescMessage?n.fixParam_taskProcessDescMessage:"";if("true"===c&&""===l.processDesc)return""===r&&(r="请填写处理意见，最大长度为2000字符！"),void s.alertMessage(r);if("rollBackTaskByExpression"===a){if(""===l.processDesc)return void s.alertMessage("请填写意见！")}else try{var d=saveDataMy();if(!d)return}catch(h){}if("modifyForm"===a){var u=n.fixParam_title;u&&""!==u||(u="修改");var f={toobarTitle:u},g=n.fixParam_url;return g&&""!==g||(g=s.formUri),g=appendParams(g,{submitBtnShow:"false"}),void s.getPageWin("layout",window).openWindow(800,600,f.toobarTitle,g,f,(function(){parent.refreshCenterRegion()}))}if("pending"===a){f={toobarTitle:"请选择转办人"},g=n.fixParam_url;if(g){var m=n.fixParam_width,p=n.fixParam_height;m||(m=800),p||(p=600),s.getPageWin("layout",window).openWindow(m,p,f.toobarTitle,g,f,(function(){var e=s.getPageWin("layout",window).invokeResult;e&&e.result&&(e.selectUserId&&(l["pendingUserId"]=e.selectUserId),s.execProcessTask(l))}))}else s.execProcessTask(l);return}if("rollBackTaskByTaskId"===a){f={toobarTitle:"请选择任务"},g="../jsps/process/listRollBackTaskList.jsp?taskId="+s.taskId+"&instId="+s.instId+"&commandId="+t+"&commandType="+a+"&processDesc="+encodeURIComponent(encodeURIComponent($("#taskProcessDesc").val()))+"&bizKey="+$("#keyValues").val();return openWindow(800,600,f.toobarTitle,g,f,(function(){})),!1}if("rollBack"==a){f={toobarTitle:"请选择节点"},g="../jsps/process/listRollBackNodeList.jsp?taskId="+taskId+"&instId="+instId+"&commandId="+t+"&commandType="+a+"&processDesc="+encodeURIComponent(encodeURIComponent($("#taskProcessDesc").val()))+"&bizKey="+$("#keyValues").val();return openWindow(480,320,f.toobarTitle,g,f,(function(){})),!1}if("submit"!=a){u=n.fixParam_title;u&&""!=u||(u="修改");f={toobarTitle:u},g=n.fixParam_url;if(g){m=n.fixParam_width,p=n.fixParam_height;m||(m=800),p||(p=600),s.getPageWin("layout",window).openWindow(m,p,f.toobarTitle,g,f,(function(){var e=getPageWin("layout",window).invokeResult;if(e&&e.result){if(e.taskProcessDesc){var t=$("#taskProcessDesc").val();t=""==t?e.taskProcessDesc:t+","+e.taskProcessDesc,$("#taskProcessDesc").val(t)}s.execProcessTask(l)}}))}else s.execProcessTask(l);return}if(!s.validate())return void alertMessage("表单验证不通过,请重新填写");s.execProcessTask(l)}}))},confirmMessage:function(e,t){$.messager.defaults.ok="确认",$.messager.defaults.cancel="关闭",$.messager.confirm("提示",e,t)},alertMessage:function(e,t){$.messager.defaults.ok="确认",$.messager.alert("提示",e,"info",t)},getPageWin:function(e,t){var a=this.getParentPageWin(e,t);return a},getParentPageWin:function(e,t){var a=t;return("undefined"===typeof a.pageId||a.pageId!=e)&&null!=a.parent?a.location.href!=a.parent.location.href?this.getPageWin(e,a.parent):null:a},closeLayUIOpen:function(){localStorage.setItem("closeKey",1),void 0!=parent.layer?parent.layer.close(parent.layer.getFrameIndex(window.name)):void 0!=parent.parent.layer?parent.parent.layer.close(parent.parent.layer.getFrameIndex(parent.name)):void 0!=parent.parent.parent.layer?parent.parent.parent.layer.close(parent.parent.parent.layer.getFrameIndex(parent.parent.name)):parent.parent.parent.parent.layer.close(parent.parent.parent.parent.layer.getFrameIndex(parent.parent.parent.name))},execProcessTask:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.submitCount;a++;var n=e.instId;1===a&&axios__WEBPACK_IMPORTED_MODULE_3___default.a.get(this.contentPath+"workflowProcess/processTask?"+"instId=".concat(e.instId,"&taskId=").concat(e.taskId,"&commandId=").concat(e.commandId,"&commandType=").concat(e.commandType,"&processDesc=").concat(e.processDesc,"&formParam=").concat(JSON.stringify(e.formParam)),e).then((function(e){var a=e.data;a.result?t.alertMessage(a.successMessage,(function(){t.websocketsend("fixFlow,".concat(n));var e=t.getListviewWin(window);null==e?t.closeLayUIOpen():t.getListviewWin(window).closeWindow()})):(t.submitCount=0,t.alertMessage(a.errorMessage,(function(){var e=t.getListviewWin(window);null==e?t.closeLayUIOpen():t.getListviewWin(window).closeWindow()})))}))},getListviewWin:function(e){var t=e;return"undefined"===typeof t.listviewId&&null!=t.parent?t.location.href!=t.parent.location.href?this.getListviewWin(t.parent):null:t},taskProcessDescCheck:function(){var e="",t=0,a=$("#taskProcessDesc").val();return e=""==a?'{"result":false,"errorMsg":"请填写退回理由！"}':'{"result":true,"extendParam":'+t+"}",e},saveData2:function saveData2(fn,data2){try{var mark=this.saveDataBefore();if(!mark)return}catch(e){}var result=this.validate(),editWin=getEditWin(window),inJCEdit=null!=editWin;"false"==parameterJsonObj.inJCEdit&&(inJCEdit=!1),result&&($.messager.progress({title:"正在处理,请稍等..."}),$("#dataForm").form("submit",{url:"../action/bizObjectBase!save.action",async:!1,onSubmit:function(){return!0},success:function success(data){$.messager.progress("close"),execProcessTask(data2);var dataObj=eval("("+data+")");if(dataObj.result){"new"==dealMark&&(keyValues=dataObj.attribute.keyValues,dealMark="update",document.getElementsByName("keyValues")[0].value=keyValues,document.getElementsByName("dealMark")[0].value=dealMark);try{saveDataAfter()}catch(e){}}if(inJCEdit){if(getEditWin(window).assetExist=!0,getEditWin(window).keyValues=dataObj.attribute.keyValues,null!=fn)return fn(dataObj)}else if($.messager.progress("close"),dataObj.result){var listviewWin=getListviewWin(window);null!=listviewWin&&listviewWin.refresh(),$.messager.defaults.ok="确定",$.messager.alert("提示",dataObj.successMessage,"info",(function(){if(null!=fn)return fn(dataObj)}))}else $.messager.defaults.ok="确定",$.messager.alert("提示",dataObj.errorMessage,"info",(function(){if(null!=fn)return fn(dataObj)}))}}))},getEditWin:function(e){var t=e;return"undefined"===typeof t.integrationEditorId&&null!=t.parent?t.location.href!=t.parent.location.href?this.getEditWin(t.parent):null:t},validate:function(){return!0},saveDataBefore:function(){return!0}}}}}]);