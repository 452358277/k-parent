(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-02d0d58c","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4","chunk-a6d221b4"],{"01a0":function(t,e,i){t.exports={menuText:"#fff",menuActiveText:"#fff",subMenuActiveText:"#fff",menuBg:"#49443e",menuHover:"rgba(178,129,71,0.54902)",menuActive:"#B28147",menuItemH:"45px",subMenuBg:"#1f2d3d",subMenuHover:"rgba(178,129,71,0.54902)",sideBarWidth:"180px",headerH:"0px"}},"2c2d":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"upload-box"},[t.hiddenUpload?i("div",{staticClass:"fileView"},t._l(t.fileLists,(function(e){return i("h3",{key:e.uid},[i("a",{attrs:{href:t.contextPath+"attachController/download?fileId="+e.uid,target:"_blank"}},[t._v(t._s(e.name))])])})),0):t._e(),t._v(" "),t.hiddenUpload?t._e():i("div",{staticClass:"el-upload-box"},[i("el-upload",{ref:"upload",attrs:{limit:t.limit,action:t.updatePath,"auto-upload":!0,name:t.upLoadName,data:t.extraData,"file-list":t.fileLists,accept:t.acceptFormat,"on-success":t.handleSuccess,"on-exceed":t.handleExceed,"on-preview":t.handlePreview,"on-remove":t.handleRemove,"on-error":t.handleError,"on-change":t.handleChange,"before-remove":t.beforeRemove,"before-upload":t.beforeUpload}},[i("el-button",{class:{active:t.hiddenUpload},attrs:{size:t.size,type:"primary"}},[t._v("\n        "+t._s(t.uploadTitle)+"\n      ")]),t._v(" "),t.isShowTip?i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(t._s(t.TipTitle))]):t._e()],1)],1)])},s=[],n=(i("fc02"),i("a450"),i("e680"),i("7f43")),o=i.n(n),l={name:"GuluUpload",model:{prop:"value",event:"update-value"},props:{value:[String],isShowTip:{type:Boolean,default:!0},hiddenUpload:{type:Boolean,default:!1},TipTitle:{type:String,default:"最大可上传50M文件"},uploadTitle:{type:String,default:"点击上传"},limit:{type:Number,default:50},extraData:{type:Object,default:function(){return{bizTableName:"",bizTablePk:"",fieldName:""}}},size:{type:String,default:"small"},upLoadName:{type:String,default:"file"},contextPath:{type:String,default:"/ei-web/"},acceptFormat:{type:String,default:".jpg,.jpeg,.png,.gif,.bmp,.pdf,.JPG,.JPEG,.PBG,.GIF,.BMP,.PDF,.rp,.vsd"}},data:function(){return{fileList:[],fileLists:[]}},watch:{value:function(t){null!==t&&void 0!==t&&""!==t?this.getFileData():(this.fileLists=[],this.fileList=[])},hiddenUpload:function(){},fileLists:function(t){}},computed:{updatePath:function(){var t="".concat(this.contextPath,"attachController/upload?fieldToken=").concat(this.value?this.value:"");return t}},created:function(){null!==this.value&&void 0!==this.value&&""!==this.value?this.getFileData():(this.fileLists=[],this.fileList=[])},methods:{getFileData:function(t){var e=this,i=t||this.value;""!=i&&null!=i||(i="-1");var a=this.contextPath+"attachController/getFileList?fieldToken="+i;o()({url:a,method:"get"}).then((function(t){"0"===t.data.status&&t.data.data.fileList&&e.$nextTick((function(){e.fileLists=t.data.data.fileList,t.data.data.fileList.length>0&&(e.fileList=t.data.data.fileList),0===e.fileLists.length&&(e.$emit("update-value",""),this.fileLists=[],this.fileList=[])}))}))},beforeUpload:function(t){},handleChange:function(t,e){var i=t.name.substring(t.name.lastIndexOf(".")+1),a="rp"===i,s="vsd"===i;(a||s)&&(this.$message({offset:150,message:"上传文件不能是 rp 、vsd 格式!",type:"warning"}),this.$refs.upload.clearFiles())},handleExceed:function(t,e){this.$message.warning("当前限制选择 ".concat(t.length," 个文件，本次选择了 ").concat(t.length," 个文件，共选择了 ").concat(t.length+e.length," 个文件"))},handleRemove:function(t,e){var i=this;o()({url:this.contextPath+"attachController/delete?fileId="+t.uid,method:"get"}).then((function(t){"0"===t.data.status&&(0==e.length?(i.$emit("update-value",""),i.fileLists=[],i.fileList=[]):i.fileLists=e)}))},handleError:function(t,e,i){},handleSuccess:function(t,e,i){var a=t.data.fieldToken;void 0==a&&(a=this.value);var s=this.updatePath.split("=");""!=s[1]&&""==a&&(a=s[1]),this.$emit("update-value",a),this.fileLists=i,this.getFileData(a)},beforeRemove:function(t,e){return this.$confirm("确定移除 ".concat(t.name,"？"))},handlePreview:function(t){window.open(this.contextPath+"attachController/download?fileId="+t.uid)}}},r=l,c=(i("e116"),i("4ac2")),p=Object(c["a"])(r,a,s,!1,null,"e22390a6",null);e["a"]=p.exports},a2c0:function(t,e,i){"use strict";i("01a0")},c059:function(t,e,i){},e116:function(t,e,i){"use strict";i("c059")},f8c9:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"createBox"},[i("div",{staticClass:"btnBox",staticStyle:{"margin-top":"20px"}},[t.buttonList.includes("602020301")||t.buttonList.includes("602030301")?i("button",{on:{click:t.addReport}},[i("i",{staticClass:"iconfont iconjiahao"}),t._v("\n      新建\n    ")]):t._e(),t._v(" "),t.buttonList.includes("602020302")||t.buttonList.includes("602030302")?i("button",{on:{click:t.editReport}},[i("i",{staticClass:"iconfont iconbianji"}),t._v("\n      编辑\n    ")]):t._e(),t._v(" "),t.buttonList.includes("602020303")||t.buttonList.includes("602030303")?i("button",{staticClass:"defalut",on:{click:t.delReport}},[i("i",{staticClass:"iconfont iconqingchu"}),t._v("\n      删除\n    ")]):t._e()]),t._v(" "),i("el-table",{attrs:{data:t.periodicReportList.data,"header-cell-style":{background:"#FEFAFA",color:"#333",fontSize:"12px",fontWeight:"bold",textAlign:"center"},"tooltip-effect":"dark",border:""},on:{"selection-change":t.reportList}},[i("el-table-column",{attrs:{type:"selection",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{"class-name":"cellText",prop:"rptTitle",label:"标题"}}),t._v(" "),i("el-table-column",{attrs:{prop:"rptDt","class-name":"cellText",label:"报告日期"}}),t._v(" "),i("el-table-column",{attrs:{prop:"rptTypeName","class-name":"cellText",label:"分类"}}),t._v(" "),i("el-table-column",{attrs:{prop:"remark","class-name":"cellText",label:"备注"}}),t._v(" "),i("el-table-column",{attrs:{"class-name":"cellText",label:"附件"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("purvarUpload",{attrs:{"hidden-upload":t.hideUp,"context-path":t.url.upApi},model:{value:e.row.rptFile,callback:function(i){t.$set(e.row,"rptFile",i)},expression:"scope.row.rptFile"}})]}}])})],1),t._v(" "),i("el-dialog",{attrs:{title:t.modalTitle,"close-on-click-modal":!1,"close-on-press-escape":!1,visible:t.reportVisible},on:{"update:visible":function(e){t.reportVisible=e},close:t.reportClose}},[i("el-row",{staticClass:"infoRow",attrs:{type:"flex",align:"center",justify:"center"}},[i("el-col",{staticClass:"col-title",attrs:{span:6}},[t._v("\n        标题\n        "),i("span",{staticClass:"mustIn"},[t._v("*")])]),t._v(" "),i("el-col",{staticClass:"col-content",attrs:{span:18}},[i("el-input",{staticStyle:{width:"300px"},attrs:{maxlength:"64",autocomplete:"off",size:"small"},model:{value:t.newReport.rptTitle,callback:function(e){t.$set(t.newReport,"rptTitle",e)},expression:"newReport.rptTitle"}})],1)],1),t._v(" "),i("el-row",{staticClass:"infoRow",attrs:{type:"flex",align:"center",justify:"center"}},[i("el-col",{staticClass:"col-title",attrs:{span:6}},[t._v("\n        报告日期\n        "),i("span",{staticClass:"mustIn"},[t._v("*")])]),t._v(" "),i("el-col",{staticClass:"col-content",attrs:{span:18}},[i("el-date-picker",{staticStyle:{width:"300px"},attrs:{type:"date",size:"small",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.newReport.rptDt,callback:function(e){t.$set(t.newReport,"rptDt",e)},expression:"newReport.rptDt"}})],1)],1),t._v(" "),i("el-row",{staticClass:"infoRow",attrs:{type:"flex",align:"center",justify:"center"}},[i("el-col",{staticClass:"col-title",attrs:{span:6}},[t._v("\n        分类\n        "),i("span",{staticClass:"mustIn"},[t._v("*")])]),t._v(" "),i("el-col",{staticClass:"col-content",attrs:{span:18}},[i("el-select",{staticStyle:{width:"300px"},attrs:{placeholder:"请选择",size:"small"},model:{value:t.newReport.rptType,callback:function(e){t.$set(t.newReport,"rptType",e)},expression:"newReport.rptType"}},t._l(t.typeList,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),t._v(" "),i("el-row",{staticClass:"infoRow",attrs:{type:"flex",align:"center",justify:"center"}},[i("el-col",{staticClass:"col-title",attrs:{span:6}},[t._v("\n        附件\n      ")]),t._v(" "),i("el-col",{staticClass:"col-content",attrs:{span:18}},[t.reportVisible?i("purvarUpload",{staticStyle:{"margin-right":"10px"},attrs:{"context-path":t.url.upApi},model:{value:t.rptFile,callback:function(e){t.rptFile=e},expression:"rptFile"}}):t._e()],1)],1),t._v(" "),i("el-row",{staticClass:"infoRow",attrs:{type:"flex",align:"center",justify:"center"}},[i("el-col",{staticClass:"col-title",attrs:{span:6}},[t._v("\n        备注\n      ")]),t._v(" "),i("el-col",{staticClass:"col-content",attrs:{span:18}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",autosize:{minRows:2,maxRows:4},maxlength:"200"},model:{value:t.newReport.remark,callback:function(e){t.$set(t.newReport,"remark",e)},expression:"newReport.remark"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"reportBtn",on:{click:t.cancelReport}},[t._v("取 消")]),t._v(" "),i("el-button",{staticClass:"reportBtn",attrs:{type:"primary"},on:{click:t.submitReport}},[t._v("保 存")])],1)],1),t._v(" "),i("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":t.periodicReportList.currPage,"page-sizes":[5,10,15,20],"page-size":5,layout:"total, sizes, prev, pager, next, jumper",total:t.periodicReportList.totalCount},on:{"size-change":t.reportSizeChange,"current-change":t.reportCurrentChange}})],1)},s=[],n=(i("a450"),i("aa18"),i("982e"),i("1bc7"),i("fc02"),i("2c2d")),o=i("698e"),l=i("e19c"),r={name:"PeriodicReport",components:{purvarUpload:n["a"]},props:["tableData"],data:function(){return{periodicReportList:"",reportVisible:!1,newReport:{},typeList:[{label:"类别1",value:1},{label:"类别2",value:2},{label:"类别3",value:3},{label:"类别4",value:4}],choiceList:[],url:l["a"],rules:{rptTitle:[{required:!0,message:"请输入报告名称",trigger:"blur"}],tprDate:[{required:!0,message:"请选择日期",trigger:"change"}]},hideUp:!0,rptFile:"",modalTitle:"",buttonList:[]}},mounted:function(){this.getPeriodicReportList(),this.getParentId(221,"typeList")},methods:{getParentId:function(t,e){var i=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(sessionStorage.getItem("code".concat(t))){var s=[];if(a){var n=a.split(",");JSON.parse(sessionStorage.getItem("code".concat(t))).forEach((function(t){n.includes(t.value)&&s.push(t)}))}else s=JSON.parse(sessionStorage.getItem("code".concat(t)));this[e]=s}else o["a"].getCodeByParentId({parentId:t}).then((function(s){var n=[];if(a){var o=a.split(",");s.data.data.options.forEach((function(t){o.includes(t.value)&&n.push(t)}))}else n=s.data.data.options;i[e]=n,sessionStorage.setItem("code".concat(t),JSON.stringify(s.data.data.options))}))},setButtonList:function(){var t=this;this.buttonList=[],this.$route.meta.buttons.forEach((function(e){"定期报告"===e.name&&e.buttons.forEach((function(e){"602020301"===e.code&&t.buttonList.push(e.code),"602020302"===e.code&&t.buttonList.push(e.code),"602020303"===e.code&&t.buttonList.push(e.code),"602030301"===e.code&&t.buttonList.push(e.code),"602030302"===e.code&&t.buttonList.push(e.code),"602030303"===e.code&&t.buttonList.push(e.code)}))}))},getPeriodicReportList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.periodicReportList={};var a={length:e,currPage:i,fundId:this.$route.params.fundId?this.$route.params.fundId:0};o["a"].fundAnalysisReportList(a).then((function(e){t.periodicReportList=e.data}))},reportSizeChange:function(t){this.periodicReportList.pageSize=t,this.getPeriodicReportList(this.periodicReportList.pageSize,1)},reportCurrentChange:function(t){this.periodicReportList.currPage=t,this.getPeriodicReportList(this.periodicReportList.pageSize,this.periodicReportList.currPage)},submitReport:function(){var t=this;return this.newReport.rptFile=this.rptFile,this.newReport.rptTitle?this.newReport.rptDt?this.newReport.rptType?(this.newReport.fundId=this.$route.params.fundId?this.$route.params.fundId:0,void("新建报告"===this.modalTitle?o["a"].fundAnalysisReport(this.newReport).then((function(e){"0"===e.data.status&&(t.$message({offset:150,type:"success",message:"新增成功"}),t.reportVisible=!1)})).then((function(e){t.getPeriodicReportList(t.periodicReportList.pageSize,t.periodicReportList.currPage)})).catch((function(e){t.$message({offset:150,type:"error",message:"操作失败"})})):o["a"].fundAnalysisReportUpdate(this.newReport).then((function(e){"成功"===e.data.msg?(t.$message({offset:150,type:"success",message:"修改成功"}),t.reportVisible=!1,t.getPeriodicReportList(t.periodicReportList.pageSize,t.periodicReportList.currPage)):t.$message({offset:150,type:"warning",message:e.data.msg})})))):(this.$message({offset:150,type:"warning",message:"请填写分类"}),!1):(this.$message({offset:150,type:"warning",message:"请填写报告日期"}),!1):(this.$message({offset:150,type:"warning",message:"请填写标题"}),!1)},reportClose:function(){this.newReport={},this.rptFile=""},addReport:function(){this.reportVisible=!0,this.modalTitle="新建报告",this.rptFile=""},delReport:function(){var t=this;0==this.choiceList.length?this.$message({offset:150,message:"请至少选择一条数据",type:"warning"}):this.$confirm("确定要删除这".concat(this.choiceList.length,"条数据?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.choiceList.forEach((function(e,i){o["a"].fundAnalysisReportDelete({fieldValue:e.rptId,fundId:e.fundId}).then((function(e){t.getPeriodicReportList(t.periodicReportList.pageSize,1)}))})),t.$message({offset:150,type:"success",message:"删除成功!"})}))},editReport:function(){0==this.choiceList.length?this.$message({offset:150,message:"请选择一条数据",type:"warning"}):(this.newReport=this.choiceList[0],this.reportVisible=!0,this.rptFile=this.choiceList[0].rptFile,this.modalTitle="编辑报告")},reportList:function(t){this.choiceList=t},cancelReport:function(){this.reportVisible=!1,this.getPeriodicReportList(this.periodicReportList.pageSize,1)}}},c=r,p=(i("a2c0"),i("4ac2")),u=Object(p["a"])(c,a,s,!1,null,null,null);e["default"]=u.exports}}]);