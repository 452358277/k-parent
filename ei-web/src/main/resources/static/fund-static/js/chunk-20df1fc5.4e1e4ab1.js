(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20df1fc5","chunk-2fb98bbb","chunk-76eb0f72","chunk-76eb0f72","chunk-76eb0f72"],{"1f97":function(t,e,a){},"22db":function(t,e,a){"use strict";a("1f97")},"2daf":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tableReview"},[a("div",{staticClass:"btnBox"},[a("button",{ref:"reviewAdd",staticStyle:{display:"none"},attrs:{"data-code":"50010801"},on:{click:t.addComment}},[a("i",{staticClass:"iconfont iconjiahao"}),t._v("\n      新增\n    ")]),t._v(" "),a("button",{ref:"reviewEdit",staticStyle:{display:"none"},attrs:{"data-code":"50010802"},on:{click:t.editComment}},[a("i",{staticClass:"iconfont iconbianji"}),t._v("\n      编辑\n    ")]),t._v(" "),a("button",{ref:"reviewBack",staticStyle:{display:"none"},attrs:{"data-code":"50010803"},on:{click:t.checkResult}},[a("i",{staticClass:"iconfont iconaffirm_icon"}),t._v("\n      核查结果反馈\n    ")]),t._v(" "),a("button",{ref:"reviewOut",staticClass:"defalut",staticStyle:{display:"none"},attrs:{"data-code":"50010804"},on:{click:t.outExcelList}},[a("i",{staticClass:"iconfont icondaochu"}),t._v("\n      导出\n    ")]),t._v(" "),a("button",{ref:"reviewDel",staticClass:"defalut",staticStyle:{display:"none"},attrs:{"data-code":"50010805"},on:{click:t.delComment}},[a("i",{staticClass:"iconfont iconqingchu"}),t._v("\n      删除\n    ")])]),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:!1,expression:"false",modifiers:{fullscreen:!0,lock:!0}}],staticStyle:{width:"100%"},attrs:{"header-cell-style":{background:"#FEFAFA",color:"#333",fontWeight:"bold",fontSize:"12px",textAlign:"center"},data:t.complianceCommentList.data,border:""},on:{"selection-change":t.selectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"projOrFundName",align:"left","header-align":"center","min-width":"150",label:"基金名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"createBy","header-align":"center",align:"left",width:"100",label:"点评单位"}}),t._v(" "),a("el-table-column",{attrs:{prop:"createDt",align:"left","header-align":"center","min-width":"126",label:"录入时间"}}),t._v(" "),a("el-table-column",{attrs:{prop:"problemDesc",align:"left","header-align":"center","min-width":"130",label:"问题描述"}}),t._v(" "),a("el-table-column",{attrs:{align:"left","header-align":"center","min-width":"200",label:"附件"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("purvar-upload",{attrs:{"context-path":t.Url.upApi,"hidden-upload":!0},model:{value:e.row.attaFile,callback:function(a){t.$set(e.row,"attaFile",a)},expression:"scope.row.attaFile"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"checkResult",align:"left","header-align":"center",label:"核查结果反馈"}})],1),t._v(" "),a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":t.complianceCommentList.currPage,"page-sizes":[5,10,15,20],"page-size":5,layout:"total, sizes, prev, pager, next, jumper",total:t.complianceCommentList.totalCount},on:{"size-change":t.reviewSizeChange,"current-change":t.reviewCurrentChange}}),t._v(" "),a("el-dialog",{attrs:{title:1==t.commentType?"编辑点评":"新增点评",visible:t.commentShow,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"60%"},on:{"update:visible":function(e){t.commentShow=e},close:t.commentClose}},[a("el-row",{staticClass:"infoRow",attrs:{type:"flex",align:"center",justify:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:6}},[t._v("\n        问题描述\n        "),a("span",{staticClass:"mustIn"},[t._v("*")])]),t._v(" "),a("el-col",{staticClass:"col-content",attrs:{span:18}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容"},model:{value:t.commentInfo.problemDesc,callback:function(e){t.$set(t.commentInfo,"problemDesc",e)},expression:"commentInfo.problemDesc"}})],1)],1),t._v(" "),a("el-row",{staticClass:"infoRow",attrs:{type:"flex",align:"center",justify:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:6}},[t._v("附件")]),t._v(" "),a("el-col",{staticClass:"col-content",attrs:{span:18}},[t.commentShow?a("purvar-upload",{attrs:{"context-path":t.Url.upApi},model:{value:t.tokenId,callback:function(e){t.tokenId=e},expression:"tokenId"}}):t._e()],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.commentShow=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.commentTrue}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"核查结果反馈","close-on-click-modal":!1,"close-on-press-escape":!1,visible:t.checkResultShow,width:"60%"},on:{"update:visible":function(e){t.checkResultShow=e}}},[a("el-row",{staticClass:"infoRow",attrs:{type:"flex",align:"center",justify:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:6}},[t._v("问题描述")]),t._v(" "),a("el-col",{staticClass:"col-content",attrs:{span:18}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容",readonly:""},model:{value:t.checkResultInfo.problemDesc,callback:function(e){t.$set(t.checkResultInfo,"problemDesc",e)},expression:"checkResultInfo.problemDesc"}})],1)],1),t._v(" "),a("el-row",{staticClass:"infoRow",attrs:{type:"flex",align:"center",justify:"center"}},[a("el-col",{staticClass:"col-title",attrs:{span:6}},[t._v("核查结果")]),t._v(" "),a("el-col",{staticClass:"col-content",attrs:{span:18}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入内容"},model:{value:t.checkResultInfo.checkResult,callback:function(e){t.$set(t.checkResultInfo,"checkResult",e)},expression:"checkResultInfo.checkResult"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.checkResultShow=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.checkResultSure}},[t._v("确 定")])],1)],1)],1)},i=[],o=(a("a450"),a("aa18"),a("982e"),a("1bc7"),a("58b9")),s=a("e19c"),l=a("698e"),c={name:"TableReview",components:{"purvar-upload":o["default"]},props:["tableDataContent","fundName","buttons"],data:function(){return{value11:"/ei-web",multipleSelection:[],commentShow:!1,commentInfo:{},checkResultShow:!1,checkResultInfo:{},commentType:0,tokenId:"",detail:{certificateAtta:""},Url:s["a"],complianceCommentList:{},projOrFundId:this.$route.query.fundId}},watch:{buttons:function(t,e){var a=this,n=t.buttons,i=this.$refs.reviewAdd.getAttribute("data-code"),o=this.$refs.reviewEdit.getAttribute("data-code"),s=this.$refs.reviewOut.getAttribute("data-code"),l=this.$refs.reviewBack.getAttribute("data-code"),c=this.$refs.reviewDel.getAttribute("data-code"),r=[i,o,s,c,l];n.forEach((function(t){r.includes(t.code)&&("新增"===t.name?a.$refs.reviewAdd.style.display="flex":"编辑"===t.name?a.$refs.reviewEdit.style.display="flex":"导出"===t.name?a.$refs.reviewOut.style.display="flex":"删除"===t.name?a.$refs.reviewDel.style.display="flex":"核查结果反馈"===t.name&&(a.$refs.reviewBack.style.display="flex"))}))},fundName:function(t,e){this.getcomplianceCommentList()}},mounted:function(){this.getcomplianceCommentList()},methods:{commentClose:function(){this.tokenId=""},getcomplianceCommentList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.complianceCommentList.data=[];var n={length:e,currPage:a,projOrFundId:this.$route.query.fundId};l["a"].getFitList(n).then((function(e){var a="";a=e.data,a.data.forEach((function(e,a){e.projOrFundName=t.fundName})),t.complianceCommentList=a})).catch((function(t){}))},reviewSizeChange:function(t){this.complianceCommentList.pageSize=t,this.getcomplianceCommentList(this.complianceCommentList.pageSize,1)},reviewCurrentChange:function(t){this.complianceCommentList.currPage=t,this.getcomplianceCommentList(this.complianceCommentList.pageSize,this.complianceCommentList.currPage)},addComment:function(){this.commentType=0,this.commentShow=!0,this.commentInfo={},this.tokenId=""},getFileList:function(){var t=this,e=this.tokenId;""!=e&&null!=e||(e="-1"),this.$axios({url:this.Url.urlApi+"attachController/getFileList?fieldToken="+e,method:"get"}).then((function(e){"0"===e.data.status?e.data.data.fileList&&t.$nextTick((function(){t.fileList=e.data.data.fileList,0==t.fileList.length&&t.updateValue("")})):t.$message({type:"info",duration:1e3,message:e.data.msg})}))},checkResult:function(){var t=this;if(1!=this.multipleSelection.length)this.$message("请选择一条数据核查");else{this.checkResultShow=!0;var e=this.multipleSelection[0].fitId;this.$axios({url:"".concat(this.Url.urlApi,"FitInfo/").concat(e),method:"get"}).then((function(e){200==e.status&&(t.checkResultInfo=e.data.data,t.tokenId=e.data.data.attaFile)}))}},export2Excel:function(){var t=this;Promise.all([a.e("chunk-3a822854"),a.e("chunk-91140928")]).then(function(){var e=a("39a0"),n=e.export_json_to_excel,i=["基金名称","点评单位","录入时间","问题描述","核查结果"],o=["regName","createBy","createDt","problemDesc","checkResult"];l["a"].getFitList({length:2e3,currPage:1,projOrFundId:t.$route.query.fundId}).then((function(e){var a=e.data.data;a.forEach((function(e){e.regName=t.fundName}));var s=t.formatJson(o,a);n(i,s,"合规点评表")}))}.bind(null,a)).catch(a.oe)},formatJson:function(t,e){return e.map((function(e){return t.map((function(t){return e[t]}))}))},outExcelList:function(){var t=this;0!==this.complianceCommentList.data.length?this.$confirm("确定导出所有项？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.export2Excel()})).catch((function(){t.$message({offset:150,type:"info",message:"已取消导出"})})):this.$message({offset:150,type:"warning",message:"目前没有更多合规点评数据"})},selectionChange:function(t){this.multipleSelection=t},editComment:function(){var t=this;if(this.commentType=1,1!=this.multipleSelection.length)this.$message("请选择一条数据编辑");else{var e=this.multipleSelection[0].fitId;this.$axios({url:"".concat(this.Url.urlApi,"FitInfo/").concat(e),method:"get"}).then((function(e){"0"===e.data.status&&(t.commentInfo=e.data.data,t.tokenId=e.data.data.attaFile,t.commentShow=!0)}))}},delComment:function(){var t=this;this.multipleSelection.length>0?this.$confirm("确定删除这".concat(this.multipleSelection.length,"项？"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){for(var e=0;e<t.multipleSelection.length;e++)t.$axios({url:"".concat(t.Url.urlApi,"deleteTableDataById?tableName=BD_T_FIT_REGULATION_YELP&keyName=FIT_ID&keyValue=").concat(t.multipleSelection[e].fitId,"&fieldName=STATUS&fieldValue=1"),method:"put"}).then((function(t){}));t.$message({offset:150,type:"success",message:"删除成功!"}),t.commentShow=!1})).then((function(){t.getcomplianceCommentList(t.complianceCommentList.pageSize,t.complianceCommentList.currPage)})).catch((function(){t.$message({offset:150,type:"info",message:"已取消删除"})})):this.$message("请至少选择一条数据")},commentTrue:function(){var t,e=this;this.commentInfo.problemDesc&&""!==this.commentInfo.problemDesc?0==this.commentType?(t={fitId:"",fitType:"",projOrFundId:this.projOrFundId,mcId:"",indexId:"",indexName:"",problemDesc:this.commentInfo.problemDesc,checkResult:this.commentInfo.checkResult,attaFile:this.tokenId,projOrFundName:this.commentInfo.projOrFundName,isDelete:""},this.$axios({url:"".concat(this.Url.urlApi,"saveFitInfo"),method:"post",data:t}).then((function(t){e.commentShow=!1,e.$message({offset:150,type:"success",message:"添加成功!"}),e.getcomplianceCommentList(e.complianceCommentList.pageSize,e.complianceCommentList.currPage)}))):(t={fitId:this.commentInfo.fitId,fitType:this.commentInfo.fitType,projOrFundId:this.projOrFundId,mcId:"",indexId:this.commentInfo.indexId,indexName:this.commentInfo.indexName,problemDesc:this.commentInfo.problemDesc,checkResult:this.commentInfo.checkResult,attaFile:this.tokenId,projOrFundName:this.commentInfo.projOrFundName,isDelete:""},this.$axios({url:"".concat(this.Url.urlApi,"saveFitInfo"),method:"post",data:t}).then((function(t){e.commentShow=!1})).then((function(){e.$message({offset:150,type:"success",message:"操作成功!"}),e.getcomplianceCommentList(e.complianceCommentList.pageSize,e.complianceCommentList.currPage)}))):this.$message({offset:150,type:"warning",message:"请填写问题描述"})},checkResultSure:function(){var t=this;if(this.checkResultInfo.checkResult&&""!==this.checkResultInfo.checkResult){var e={fitId:this.checkResultInfo.fitId,fitType:this.checkResultInfo.fitType,projOrFundId:this.projOrFundId,mcId:"",indexId:this.checkResultInfo.indexId,indexName:this.checkResultInfo.indexName,problemDesc:this.checkResultInfo.problemDesc,checkResult:this.checkResultInfo.checkResult,attaFile:this.tokenId,projOrFundName:this.checkResultInfo.projOrFundName,isDelete:""};this.$axios({url:"".concat(this.Url.urlApi,"saveFitInfo"),method:"post",data:e}).then((function(e){t.checkResultShow=!1})).then((function(){t.getcomplianceCommentList(t.complianceCommentList.pageSize,t.complianceCommentList.currPage)}))}else this.$message({offset:150,type:"warning",message:"请填写核查结果"})},downLoadFile:function(t){window.open(this.Url.urlApi+"attachController/download?fileId="+t)}}},r=c,u=(a("22db"),a("4ac2")),d=Object(u["a"])(r,n,i,!1,null,null,null);e["default"]=d.exports},"3ad7":function(t,e,a){},"58b9":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"upload-box"},[t.hiddenUpload?a("div",{staticClass:"fileView"},t._l(t.fileLists,(function(e){return a("h3",{key:e.uid},[a("a",{attrs:{href:t.contextPath+"attachController/download?fileId="+e.uid,target:"_blank"}},[t._v(t._s(e.name))])])})),0):t._e(),t._v(" "),t.hiddenUpload?t._e():a("div",{staticClass:"el-upload-box"},[a("el-upload",{ref:"upload",attrs:{limit:t.limit,action:t.updatePath,"auto-upload":!0,name:t.upLoadName,data:t.extraData,"file-list":t.fileLists,accept:t.acceptFormat,"on-success":t.handleSuccess,"on-exceed":t.handleExceed,"on-preview":t.handlePreview,"on-remove":t.handleRemove,"on-error":t.handleError,"on-change":t.handleChange,"before-remove":t.beforeRemove,"before-upload":t.beforeUpload}},[a("el-button",{class:{active:t.hiddenUpload},attrs:{size:t.size,type:"primary"}},[t._v("\n        "+t._s(t.uploadTitle)+"\n      ")]),t._v(" "),t.isShowTip?a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(t._s(t.TipTitle))]):t._e()],1)],1)])},i=[],o=(a("fc02"),a("a450"),a("e680"),a("7f43")),s=a.n(o),l={name:"GuluUpload",model:{prop:"value",event:"update-value"},props:{value:[String],isShowTip:{type:Boolean,default:!0},hiddenUpload:{type:Boolean,default:!1},TipTitle:{type:String,default:"最大可上传50M文件"},uploadTitle:{type:String,default:"点击上传"},limit:{type:Number,default:50},extraData:{type:Object,default:function(){return{bizTableName:"",bizTablePk:"",fieldName:""}}},size:{type:String,default:"small"},upLoadName:{type:String,default:"file"},contextPath:{type:String,default:"/ei-web/"},acceptFormat:{type:String,default:".jpg,.jpeg,.png,.gif,.bmp,.pdf,.JPG,.JPEG,.PBG,.GIF,.BMP,.PDF,.rp,.vsd"}},data:function(){return{fileList:[],fileLists:[]}},watch:{value:function(t){null!==t&&void 0!==t&&""!==t&&this.getFileData()},hiddenUpload:function(){this.getFileData()}},computed:{updatePath:function(){var t="".concat(this.contextPath,"attachController/upload?fieldToken=").concat(this.value?this.value:"");return t}},created:function(){null!==this.value&&void 0!==this.value&&""!==this.value?this.getFileData():(this.fileLists=[],this.fileList=[])},methods:{getFileData:function(){var t=this,e=this.value;""!=e&&null!=e||(e="-1");var a=this.contextPath+"attachController/getFileList?fieldToken="+e;s()({url:a,method:"get"}).then((function(e){"0"===e.data.status&&e.data.data.fileList&&t.$nextTick((function(){t.fileLists=e.data.data.fileList,e.data.data.fileList.length>0&&(t.fileList=e.data.data.fileList),0==t.fileLists.length&&(t.$emit("update-value",""),this.fileLists=[],this.fileList=[])}))}))},beforeUpload:function(t){},handleChange:function(t,e){var a=t.name.substring(t.name.lastIndexOf(".")+1),n="rp"===a,i="vsd"===a;(n||i)&&(this.$message({offset:150,message:"上传文件不能是 rp 、vsd 格式!",type:"warning"}),this.$refs.upload.clearFiles())},handleExceed:function(t,e){this.$message.warning("当前限制选择 ".concat(t.length," 个文件，本次选择了 ").concat(t.length," 个文件，共选择了 ").concat(t.length+e.length," 个文件"))},handleRemove:function(t,e){var a=this;s()({url:this.contextPath+"attachController/delete?fileId="+t.uid,method:"get"}).then((function(t){"0"===t.data.status&&0==e.length&&(a.$emit("update-value",""),this.fileLists=[],this.fileList=[])}))},handleError:function(t,e,a){},handleSuccess:function(t,e,a){var n=t.data.fieldToken;void 0==n&&(n=this.value);var i=this.updatePath.split("=");""!=i[1]&&""==n&&(n=i[1]),this.$emit("update-value",n)},beforeRemove:function(t,e){return this.$confirm("确定移除 ".concat(t.name,"？"))},handlePreview:function(t){window.open(this.contextPath+"attachController/download?fileId="+t.uid)}}},c=l,r=(a("abf3"),a("4ac2")),u=Object(r["a"])(c,n,i,!1,null,"36d367e4",null);e["default"]=u.exports},9639:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("table-review",{attrs:{tableDataContent:t.tableData,projOrFundId:t.projId},on:{"delete-check":t.deleteHandle,"edit-check":t.editHandle}}),t._v(" "),a("div",{staticClass:"paginationNav paginationCommon"})],1)},i=[],o=a("2daf"),s={props:["projId","tableData","currentPage","recordsTotal","pageSize"],data:function(){return{tableData:[],currentPage:1,pageSize:5,totalPage:0,shouYePage:1,recordsTotal:0,projIdA:"",keyValuesType:6,api_url:"/ei-web"}},components:{"table-review":o["default"]},created:function(){this.projIdA=this.projId,this.getEnteInfos(this.projIdA,this.pageSize,this.currentPage)},methods:{getFileList:function(t,e){var a,n=this,i=t;""!=i&&null!=i||(i="-1"),this.$axios({url:"/ei-web/attachController/getFileList?fieldToken="+i,method:"get"}).then((function(t){"0"===t.data.status?(a=t.data.data.fileList,n.tableData[e].attaFile=a):n.$message({type:"info",duration:1e3,message:t.data.msg})}))},getEnteInfos:function(t,e,a){var n=this;(new Date).getTime();this.$axios({url:"".concat(this.api_url,"/FitList?length=").concat(e,"&currPage=").concat(a,"&projOrFundId=").concat(t),method:"get"}).then((function(t){n.tableData=t.data.data;for(var e=0;e<t.data.data.length;e++)n.getFileList(t.data.data[e].attaFile,e);n.tableData=n.tableData,n.recordsTotal=t.data.totalCount,n.totalPage=t.data.totalPage})).catch((function(t){}))},indexBtn:function(){this.currentPage=this.shouYePage,this.getEnteInfos(this.projId,this.pageSize,this.currentPage)},backBtn:function(){this.currentPage=this.totalPage,this.getEnteInfos(this.projId,this.pageSize,this.currentPage)},prevClick:function(t){this.currentPage=t,this.getEnteInfos(this.projId,this.pageSize,t)},nextClick:function(t){this.currentPage=t,this.getEnteInfos(this.projId,this.pageSize,t)},handleSizeChange:function(t){var e=this;e.pageSize=t},handleCurrentChange:function(t){this.getEnteInfos(this.projId,this.pageSize,t),this.currentPage=t},deleteHandle:function(t){this.getEnteInfos(this.projId,this.pageSize,this.currentPage)},editHandle:function(t){this.getEnteInfos(this.projId,this.pageSize,this.currentPage),this.$message("修改成功")}}},l=s,c=(a("fc23"),a("4ac2")),r=Object(c["a"])(l,n,i,!1,null,"0177ef16",null);e["default"]=r.exports},abf3:function(t,e,a){"use strict";a("eec34")},eec34:function(t,e,a){},fc23:function(t,e,a){"use strict";a("3ad7")}}]);